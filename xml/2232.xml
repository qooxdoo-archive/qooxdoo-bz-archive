<bug>
          <bug_id>2232</bug_id>
          
          <creation_ts>2009-04-13 16:46:00 +0200</creation_ts>
          <short_desc>Abandon &quot;getBoxObjectFor&quot; in favor of &quot;getBoundingClientRect&quot;</short_desc>
          <delta_ts>2014-03-03 15:23:24 +0100</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>framework</product>
          <component>desktop</component>
          <version>unspecified</version>
          <rep_platform>Firefox 3.5</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc>https://bugzilla.mozilla.org/show_bug.cgi?id=340571</bug_file_loc>
          
          
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>0.8.3</target_milestone>
          <dependson>2231</dependson>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Helder Magalhães">helder.magalhaes</reporter>
          <assigned_to name="Christian Hagendorn">christian.hagendorn</assigned_to>
          
          <qa_contact name="qooxdoo bugs mailing list">qooxdoo-bugs</qa_contact>
          <cf_browser>Firefox</cf_browser>
          <cf_browser_version>3.5</cf_browser_version>

      

      

      

          <long_desc isprivate="0">
            <commentid>9254</commentid>
            <who name="Helder Magalhães">helder.magalhaes</who>
            <bug_when>2009-04-13 16:46:36 +0200</bug_when>
            <thetext>Recent trunk builds [1] of Firefox have dropped support for &quot;getBoxObjectFor&quot; (see bug&#39;s URL [2]). This means that both &quot;qx.html.Location&quot; (legacy) and &quot;qx.legacy.html.Location&quot; (trunk) will now break for Firefox 3.6.

Although this does not seem very important in a short-term basis (and to be honest, I&#39;m not quite sure what&#39;s affected so I left severity set as &quot;normal&quot;), it&#39;s probably only a matter of time until someone playing with nightly builds notices something is broken... :-|

Note that platform is currently set for &quot;Firefox&quot; whereas &quot;Firefox 3.6&quot; was the correct one for this. I&#39;ve created bug 2231 to deal with that and set this one as dependent so one may set the proper platform once it is available. ;-)

[1] http://www.mozilla.org/developer/#builds
[2] https://bugzilla.mozilla.org/show_bug.cgi?id=340571</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>9266</commentid>
            <who name="Helder Magalhães">helder.magalhaes</who>
            <bug_when>2009-04-14 17:11:06 +0200</bug_when>
            <thetext>(In reply to comment #0)
&gt; Note that platform is currently set for &quot;Firefox&quot; whereas &quot;Firefox 3.6&quot; was the
&gt; correct one for this. I&#39;ve created bug 2231 to deal with that and set this one
&gt; as dependent so one may set the proper platform once it is available. ;-)

Great, platform was updated to match the proper Firefox version. :-)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>9267</commentid>
            <who name="Andreas Ecker">qooxdoo</who>
            <bug_when>2009-04-14 17:15:53 +0200</bug_when>
            <thetext>While FF3.6 (a.k.a. &quot;Firefox.next&quot;) won&#39;t be released before 2010, we should certainly accomodate for such removed API rather sooner than later. @Daniel, please have a look, you might also find other valid changes that are not only due to the alpha stage of FF3.6.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>9366</commentid>
            <who name="Daniel Wagner">daniel.wagner</who>
            <bug_when>2009-04-17 16:35:25 +0200</bug_when>
            <thetext>Unfortunately, we can&#39;t simply replace getBoxObjectFor with getBoundingClientRect since the latter doesn&#39;t provide the element&#39;s screen coordinates which are needed in qx.legacy.html.Location. There&#39;s a seperate bug [1] requesting an API to compute the coordinates. A patch was submitted a while ago but hasn&#39;t made it into the nightlies yet.

[1] https://bugzilla.mozilla.org/show_bug.cgi?id=486200</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>10071</commentid>
            <who name="Helder Magalhães">helder.magalhaes</who>
            <bug_when>2009-05-21 01:26:53 +0200</bug_when>
            <thetext>(In reply to comment #3)
&gt; Unfortunately, we can&#39;t simply replace getBoxObjectFor with
&gt; getBoundingClientRect since the latter doesn&#39;t provide the element&#39;s screen
&gt; coordinates which are needed in qx.legacy.html.Location.

This makes all sense but, in the meantime, I&#39;ve noticed that this will be widely noticed a lot sooner then expected: in Firefox 3.5 [1]. (Firefox version updated in bug properties in order to reflect this.)

[1] https://developer.mozilla.org/En/Firefox_3.5_for_developers#Other_improvements</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>10735</commentid>
            <who name="Andreas Ecker">qooxdoo</who>
            <bug_when>2009-07-02 11:07:54 +0200</bug_when>
            <thetext>to Alex (we talked about that recently)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>11264</commentid>
            <who name="Helder Magalhães">helder.magalhaes</who>
            <bug_when>2009-08-10 16:54:14 +0200</bug_when>
            <thetext>(In reply to comment #3)
&gt; Unfortunately, we can&#39;t simply replace getBoxObjectFor with
&gt; getBoundingClientRect since the latter doesn&#39;t provide the element&#39;s screen
&gt; coordinates which are needed in qx.legacy.html.Location. There&#39;s a seperate bug
&gt; [1] requesting an API to compute the coordinates. A patch was submitted a while
&gt; ago but hasn&#39;t made it into the nightlies yet.
&gt; 
&gt; [1] https://bugzilla.mozilla.org/show_bug.cgi?id=486200

Reminder: that issue was fixed. I&#39;d propose that this was fixed backwards compatible:

1. Check if &quot;mozScreenPixelsPerCSSPixel&quot; is available;
1.1. If not, use &quot;getBoxObjectFor()&quot;, to avoid breaking legacy Firefox builds.
1.2. If so, combine with &quot;mozInnerScreenX&quot; and &quot;mozInnerScreenY&quot; in order to compute coordinates.

This was slightly adapted from the proposal [1] to do things using the new builds (just adding up the legacy fallback behavior). I don&#39;t have a clue if/how other JS frameworks are currently handling this.


[1] https://developer.mozilla.org/en/Firefox_3.6_for_developers#DOM</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>11930</commentid>
            <who name="Alexander Steitz">alexander.steitz</who>
            <bug_when>2009-09-07 18:08:10 +0200</bug_when>
            <thetext>I&#39;ll take a look.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>11931</commentid>
            <who name="Alexander Steitz">alexander.steitz</who>
            <bug_when>2009-09-07 18:36:43 +0200</bug_when>
            <thetext>I&#39;ll committed a fix in both 0.7.x and current trunk. Since it is legacy code in both branches it should not bother any user, but it&#39;s better if we fix this one.

Concerning your proposal at 1. It is not possible to use &quot;mozScreenPixelsPerCSSPixel&quot; since it is only accessible from chrome.

@Helder: Can you take a look at the fixes?

Fixed with Revision #20013</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>11992</commentid>
            <who name="Helder Magalhães">helder.magalhaes</who>
            <bug_when>2009-09-08 12:16:40 +0200</bug_when>
            <thetext>(In reply to comment #8)
&gt; I&#39;ll committed a fix in both 0.7.x and current trunk.

Great. :-)


&gt; Since it is legacy code
&gt; in both branches it should not bother any user, but it&#39;s better if we fix this
&gt; one.

Agreed, I&#39;m also convinced it was mostly a cosmetic issue, but fixing it before things go wrong is a good practice. :-)


&gt; Concerning your proposal at 1. It is not possible to use
&gt; &quot;mozScreenPixelsPerCSSPixel&quot; since it is only accessible from chrome.

True [1]. This isn&#39;t serious IMO as page zooming doesn&#39;t work very well anyway in other contexts.


&gt; @Helder: Can you take a look at the fixes?

Looks good. :-)


Note that the legacy branch has a typo: &quot;@deprecated Use {@link qx.bom.element.Locataion}&quot; --&gt; &quot;@deprecated Use {@link qx.bom.element.Location}&quot; ;-)


[1] https://developer.mozilla.org/en/DOM/window.mozScreenPixelsPerCSSPixel</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>11994</commentid>
            <who name="Alexander Steitz">alexander.steitz</who>
            <bug_when>2009-09-08 14:01:17 +0200</bug_when>
            <thetext>Fixed documentation typo.

Closing this one.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>16559</commentid>
            <who name="Christian Hagendorn">christian.hagendorn</who>
            <bug_when>2010-01-28 10:18:17 +0100</bug_when>
            <thetext>There are two methods in qx.html.Location (qx 0.7.x) which are effected from 
the deprecation.

* getPageAreaLeft()
* getPageAreaTop()</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>16560</commentid>
            <who name="Christian Hagendorn">christian.hagendorn</who>
            <bug_when>2010-01-28 10:18:44 +0100</bug_when>
            <thetext>To me.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>16561</commentid>
            <who name="Christian Hagendorn">christian.hagendorn</who>
            <bug_when>2010-01-28 10:29:21 +0100</bug_when>
            <thetext>Accepted</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>16562</commentid>
            <who name="Christian Hagendorn">christian.hagendorn</who>
            <bug_when>2010-01-28 11:09:16 +0100</bug_when>
            <thetext>Fixed getPageAreaLeft() and getPageAreaTop(), which now works with FF 3.6. Also fixed the wrong calculation from getScreenBoxLeft() and getScreenBoxTop(). Both fixed on legacy 0.7.x with rev. 21447. 
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>16568</commentid>
              <attachid>704</attachid>
            <who name="Christian Hagendorn">christian.hagendorn</who>
            <bug_when>2010-01-28 16:37:05 +0100</bug_when>
            <thetext>Created attachment 704
SVN patch file for qx.html.Location</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>16569</commentid>
              <attachid>705</attachid>
            <who name="Christian Hagendorn">christian.hagendorn</who>
            <bug_when>2010-01-28 16:37:53 +0100</bug_when>
            <thetext>Created attachment 705
Fixed qx.html.Location class file</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>38002</commentid>
            <who name="Martin Wittemann">martin.wittemann</who>
            <bug_when>2014-03-03 15:23:24 +0100</bug_when>
            <thetext>Closed all bugs already shipped with a release.</thetext>
          </long_desc>
      
          <attachment isobsolete="0" ispatch="0" isprivate="0" isurl="0">
            <attachid>704</attachid>
            <date>2010-01-28 16:37:00 +0100</date>
            <delta_ts>2010-01-28 16:37:05 +0100</delta_ts>
            <desc>SVN patch file for qx.html.Location</desc>
            <filename>Location.patch</filename>
            <type>text/x-diff</type>
            <size>2760</size>
            <attacher>christian.hagendorn</attacher>
            
              <data encoding="base64">SW5kZXg6IHFvb3hkb28vZnJvbnRlbmQvZnJhbWV3b3JrL3NvdXJjZS9jbGFzcy9xeC9odG1sL0xv
Y2F0aW9uLmpzDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09DQotLS0gcW9veGRvby9mcm9udGVuZC9mcmFtZXdvcmsvc291
cmNlL2NsYXNzL3F4L2h0bWwvTG9jYXRpb24uanMJKHJldmlzaW9uIDE2OTAyKQ0KKysrIHFvb3hk
b28vZnJvbnRlbmQvZnJhbWV3b3JrL3NvdXJjZS9jbGFzcy9xeC9odG1sL0xvY2F0aW9uLmpzCSh3
b3JraW5nIGNvcHkpDQpAQCAtNDE5LDcgKzQxOSwxMyBAQA0KICAgICBnZXRQYWdlQXJlYUxlZnQg
OiBxeC5jb3JlLlZhcmlhbnQuc2VsZWN0KCJxeC5jbGllbnQiLAogICAgIHsKICAgICAgICJnZWNr
byIgOiBmdW5jdGlvbihlbCkgewotICAgICAgICByZXR1cm4gZWwub3duZXJEb2N1bWVudC5nZXRC
b3hPYmplY3RGb3IoZWwpLng7CisgICAgICAgIC8vIGZvciBGaXJlZm94IDMuNisKKyAgICAgICAg
Ly8gU2VlIEJ1ZyAjMjIzMiAgCisgICAgICAgIGlmICh3aW5kb3cubW96SW5uZXJTY3JlZW5YICE9
IHVuZGVmaW5lZCkgeworICAgICAgICAgIHJldHVybiBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3Qo
KS5sZWZ0OworICAgICAgICB9IGVsc2UgeworICAgICAgICAgIHJldHVybiBlbC5vd25lckRvY3Vt
ZW50LmdldEJveE9iamVjdEZvcihlbCkueDsKKyAgICAgICAgfQogICAgICAgfSwKIAogICAgICAg
ImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHsKQEAgLTQzOSw3ICs0NDUsMTMgQEANCiAgICAgZ2V0
UGFnZUFyZWFUb3AgOiBxeC5jb3JlLlZhcmlhbnQuc2VsZWN0KCJxeC5jbGllbnQiLAogICAgIHsK
ICAgICAgICJnZWNrbyIgOiBmdW5jdGlvbihlbCkgewotICAgICAgICByZXR1cm4gZWwub3duZXJE
b2N1bWVudC5nZXRCb3hPYmplY3RGb3IoZWwpLnk7CisgICAgICAgIC8vIGZvciBGaXJlZm94IDMu
NisKKyAgICAgICAgLy8gU2VlIEJ1ZyAjMjIzMgorICAgICAgICBpZiAod2luZG93Lm1veklubmVy
U2NyZWVuWSAhPSB1bmRlZmluZWQpIHsKKyAgICAgICAgICByZXR1cm4gZWwuZ2V0Qm91bmRpbmdD
bGllbnRSZWN0KCkudG9wOworICAgICAgICB9IGVsc2UgeworICAgICAgICAgIHJldHVybiBlbC5v
d25lckRvY3VtZW50LmdldEJveE9iamVjdEZvcihlbCkueTsKKyAgICAgICAgfQogICAgICAgfSwK
IAogICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHsKQEAgLTU4Niw2ICs1OTgsNyBAQA0K
IAogICAgICAgICAvLyBXZSBuZWVkIHRvIHN1YnRyYWN0IHRoZSBzY3JvbGwgcG9zaXRpb24gb2Yg
YWxsCiAgICAgICAgIC8vIHBhcmVudCBjb250YWluZXJzIChidWcgIzE4NjIyOSkuCisgICAgICAg
IHZhciBzY3JlZW5YOwogICAgICAgICB2YXIgc3VtID0gMDsKICAgICAgICAgdmFyIHAgPSBlbC5w
YXJlbnROb2RlOwogCkBAIC01OTUsNyArNjA4LDE1IEBADQogICAgICAgICAgIHAgPSBwLnBhcmVu
dE5vZGU7CiAgICAgICAgIH0KIAotICAgICAgICByZXR1cm4gZWwub3duZXJEb2N1bWVudC5nZXRC
b3hPYmplY3RGb3IoZWwpLnNjcmVlblggLSBzdW07CisgICAgICAgIC8vIGZvciBGaXJlZm94IDMu
NisKKyAgICAgICAgLy8gU2VlIEJ1ZyAjMjIzMgorICAgICAgICBpZiAod2luZG93Lm1veklubmVy
U2NyZWVuWCAhPSB1bmRlZmluZWQpIHsKKyAgICAgICAgICBzY3JlZW5YID0gZWwuZ2V0Qm91bmRp
bmdDbGllbnRSZWN0KCkubGVmdCArIHdpbmRvdy5tb3pJbm5lclNjcmVlblg7CisgICAgICAgIH0g
ZWxzZSB7CisgICAgICAgICAgc2NyZWVuWCA9IGVsLm93bmVyRG9jdW1lbnQuZ2V0Qm94T2JqZWN0
Rm9yKGVsKS5zY3JlZW5YOworICAgICAgICB9CisgICAgICAgIAorICAgICAgICByZXR1cm4gc2Ny
ZWVuWCAtIHN1bTsKICAgICAgIH0sCiAKICAgICAgICJkZWZhdWx0IiA6IGZ1bmN0aW9uKGVsKSB7
CkBAIC02MTksNiArNjQwLDcgQEANCiAgICAgICB7CiAgICAgICAgIC8vIFdlIG5lZWQgdG8gc3Vi
dHJhY3QgdGhlIHNjcm9sbCBwb3NpdGlvbiBvZiBhbGwKICAgICAgICAgLy8gcGFyZW50IGNvbnRh
aW5lcnMgKGJ1ZyAjMTg2MjI5KS4KKyAgICAgICAgdmFyIHNjcmVlblk7CiAgICAgICAgIHZhciBz
dW0gPSAwOwogICAgICAgICB2YXIgcCA9IGVsLnBhcmVudE5vZGU7CiAKQEAgLTYyOCw3ICs2NTAs
MTUgQEANCiAgICAgICAgICAgcCA9IHAucGFyZW50Tm9kZTsKICAgICAgICAgfQogCi0gICAgICAg
IHJldHVybiBlbC5vd25lckRvY3VtZW50LmdldEJveE9iamVjdEZvcihlbCkuc2NyZWVuWSAtIHN1
bTsKKyAgICAgICAgLy8gZm9yIEZpcmVmb3ggMy42KworICAgICAgICAvLyBTZWUgQnVnICMyMjMy
CisgICAgICAgIGlmICh3aW5kb3cubW96SW5uZXJTY3JlZW5ZICE9IHVuZGVmaW5lZCkgeworICAg
ICAgICAgIHNjcmVlblkgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyB3aW5kb3cu
bW96SW5uZXJTY3JlZW5ZOworICAgICAgICB9IGVsc2UgeworICAgICAgICAgIHNjcmVlblkgPSBl
bC5vd25lckRvY3VtZW50LmdldEJveE9iamVjdEZvcihlbCkuc2NyZWVuWTsKKyAgICAgICAgfQor
ICAgICAgICAKKyAgICAgICAgcmV0dXJuIHNjcmVlblkgLSBzdW07CiAgICAgICB9LAogCiAgICAg
ICAiZGVmYXVsdCIgOiBmdW5jdGlvbihlbCkgewpAQCAtODg3LDQgKzkxNyw0IEBADQogICAgICAg
ImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHt9CiAgICAgfSkKICAgfQotfSk7Cit9KTsNClwgTm8g
bmV3bGluZSBhdCBlbmQgb2YgZmlsZQ0K
</data>

          </attachment>
          <attachment isobsolete="0" ispatch="0" isprivate="0" isurl="0">
            <attachid>705</attachid>
            <date>2010-01-28 16:37:00 +0100</date>
            <delta_ts>2010-01-28 16:37:53 +0100</delta_ts>
            <desc>Fixed qx.html.Location class file</desc>
            <filename>Location.js</filename>
            <type>application/x-javascript</type>
            <size>21645</size>
            <attacher>christian.hagendorn</attacher>
            
              <data encoding="base64">LyogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqDQoNCiAgIHFvb3hkb28gLSB0aGUgbmV3IGVyYSBvZiB3ZWIgZGV2
ZWxvcG1lbnQNCg0KICAgaHR0cDovL3Fvb3hkb28ub3JnDQoNCiAgIENvcHlyaWdodDoNCiAgICAg
MjAwNC0yMDA4IDEmMSBJbnRlcm5ldCBBRywgR2VybWFueSwgaHR0cDovL3d3dy4xdW5kMS5kZQ0K
DQogICBMaWNlbnNlOg0KICAgICBMR1BMOiBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvbGdw
bC5odG1sDQogICAgIEVQTDogaHR0cDovL3d3dy5lY2xpcHNlLm9yZy9vcmcvZG9jdW1lbnRzL2Vw
bC12MTAucGhwDQogICAgIFNlZSB0aGUgTElDRU5TRSBmaWxlIGluIHRoZSBwcm9qZWN0J3MgdG9w
LWxldmVsIGRpcmVjdG9yeSBmb3IgZGV0YWlscy4NCg0KICAgQXV0aG9yczoNCiAgICAgKiBTZWJh
c3RpYW4gV2VybmVyICh3cGJhc3RpKQ0KICAgICAqIEFuZHJlYXMgRWNrZXIgKGVja2VyKQ0KDQoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKiogKi8NCg0KLyogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQoNCiNtb2R1bGUodWlfY29y
ZSkNCg0KKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqICovDQoNCnF4LkNsYXNzLmRlZmluZSgicXguaHRtbC5Mb2Nh
dGlvbiIsDQp7DQogIC8qDQogICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQogICAgIFNUQVRJQ1MNCiAg
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioNCiAgKi8NCg0KICBzdGF0aWNzIDoNCiAgew0KICAgIC8qKg0K
ICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFyYW0g
ZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dmFyfSBUT0RPQw0KICAgICAqLw0K
ICAgIGdldFBhZ2VPdXRlckxlZnQgOiBmdW5jdGlvbihlbCkgew0KICAgICAgcmV0dXJuIHF4Lmh0
bWwuTG9jYXRpb24uZ2V0UGFnZUJveExlZnQoZWwpIC0gcXguaHRtbC5TdHlsZS5nZXRNYXJnaW5M
ZWZ0KGVsKTsNCiAgICB9LA0KDQoNCiAgICAvKioNCiAgICAgKiBUT0RPQw0KICAgICAqDQogICAg
ICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVsIHtFbGVtZW50fSBUT0RPQw0KICAgICAq
IEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAgICAgKi8NCiAgICBnZXRQYWdlT3V0ZXJUb3AgOiBmdW5j
dGlvbihlbCkgew0KICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0UGFnZUJveFRvcChl
bCkgLSBxeC5odG1sLlN0eWxlLmdldE1hcmdpblRvcChlbCk7DQogICAgfSwNCg0KDQogICAgLyoq
DQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJh
bSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2YXJ9IFRPRE9DDQogICAgICov
DQogICAgZ2V0UGFnZU91dGVyUmlnaHQgOiBmdW5jdGlvbihlbCkgew0KICAgICAgcmV0dXJuIHF4
Lmh0bWwuTG9jYXRpb24uZ2V0UGFnZUJveFJpZ2h0KGVsKSArIHF4Lmh0bWwuU3R5bGUuZ2V0TWFy
Z2luUmlnaHQoZWwpOw0KICAgIH0sDQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoN
CiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQog
ICAgICogQHJldHVybiB7dmFyfSBUT0RPQw0KICAgICAqLw0KICAgIGdldFBhZ2VPdXRlckJvdHRv
bSA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRQYWdl
Qm94Qm90dG9tKGVsKSArIHF4Lmh0bWwuU3R5bGUuZ2V0TWFyZ2luQm90dG9tKGVsKTsNCiAgICB9
LA0KDQoNCiAgICAvKioNCiAgICAgKiBUT0RPQw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGlj
DQogICAgICogQHBhcmFtIGVsIHtFbGVtZW50fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3Zhcn0g
VE9ET0MNCiAgICAgKi8NCiAgICBnZXRDbGllbnRPdXRlckxlZnQgOiBmdW5jdGlvbihlbCkgew0K
ICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0Q2xpZW50Qm94TGVmdChlbCkgLSBxeC5o
dG1sLlN0eWxlLmdldE1hcmdpbkxlZnQoZWwpOw0KICAgIH0sDQoNCg0KICAgIC8qKg0KICAgICAq
IFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFyYW0gZWwge0Vs
ZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dmFyfSBUT0RPQw0KICAgICAqLw0KICAgIGdl
dENsaWVudE91dGVyVG9wIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgIHJldHVybiBxeC5odG1sLkxv
Y2F0aW9uLmdldENsaWVudEJveFRvcChlbCkgLSBxeC5odG1sLlN0eWxlLmdldE1hcmdpblRvcChl
bCk7DQogICAgfSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0
eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0
dXJuIHt2YXJ9IFRPRE9DDQogICAgICovDQogICAgZ2V0Q2xpZW50T3V0ZXJSaWdodCA6IGZ1bmN0
aW9uKGVsKSB7DQogICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRDbGllbnRCb3hSaWdo
dChlbCkgKyBxeC5odG1sLlN0eWxlLmdldE1hcmdpblJpZ2h0KGVsKTsNCiAgICB9LA0KDQoNCiAg
ICAvKioNCiAgICAgKiBUT0RPQw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICog
QHBhcmFtIGVsIHtFbGVtZW50fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAg
ICAgKi8NCiAgICBnZXRDbGllbnRPdXRlckJvdHRvbSA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICBy
ZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRDbGllbnRCb3hCb3R0b20oZWwpICsgcXguaHRtbC5T
dHlsZS5nZXRNYXJnaW5Cb3R0b20oZWwpOw0KICAgIH0sDQoNCg0KICAgIC8qKg0KICAgICAqIFRP
RE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFyYW0gZWwge0VsZW1l
bnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dm9pZH0NCiAgICAgKiBAc2lnbmF0dXJlIGZ1bmN0
aW9uKGVsKQ0KICAgICAqLw0KICAgIGdldENsaWVudEJveExlZnQgOiBxeC5jb3JlLlZhcmlhbnQu
c2VsZWN0KCJxeC5jbGllbnQiLA0KICAgIHsNCiAgICAgICJtc2h0bWwiIDogZnVuY3Rpb24oZWwp
IHsNCiAgICAgICAgcmV0dXJuIGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7DQogICAg
ICB9LA0KDQogICAgICAiZ2Vja28iIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJuIHF4
Lmh0bWwuTG9jYXRpb24uZ2V0Q2xpZW50QXJlYUxlZnQoZWwpIC0gcXguaHRtbC5TdHlsZS5nZXRC
b3JkZXJMZWZ0KGVsKTsNCiAgICAgIH0sDQoNCiAgICAgICJkZWZhdWx0IiA6IGZ1bmN0aW9uKGVs
KQ0KICAgICAgew0KICAgICAgICB2YXIgc3VtID0gZWwub2Zmc2V0TGVmdDsNCg0KICAgICAgICB3
aGlsZSAoZWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9ICJib2R5IikNCiAgICAgICAgew0KICAg
ICAgICAgIGVsID0gZWwub2Zmc2V0UGFyZW50Ow0KICAgICAgICAgIHN1bSArPSBlbC5vZmZzZXRM
ZWZ0IC0gZWwuc2Nyb2xsTGVmdDsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBzdW07DQog
ICAgICB9DQogICAgfSksDQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAg
KiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICog
QHJldHVybiB7dm9pZH0NCiAgICAgKiBAc2lnbmF0dXJlIGZ1bmN0aW9uKGVsKQ0KICAgICAqLw0K
ICAgIGdldENsaWVudEJveFRvcCA6IHF4LmNvcmUuVmFyaWFudC5zZWxlY3QoInF4LmNsaWVudCIs
DQogICAgew0KICAgICAgIm1zaHRtbCIgOiBmdW5jdGlvbihlbCkgew0KICAgICAgICByZXR1cm4g
ZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wOw0KICAgICAgfSwNCg0KICAgICAgImdlY2tv
IiA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9uLmdldENs
aWVudEFyZWFUb3AoZWwpIC0gcXguaHRtbC5TdHlsZS5nZXRCb3JkZXJUb3AoZWwpOw0KICAgICAg
fSwNCg0KICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpDQogICAgICB7DQogICAgICAgIHZh
ciBzdW0gPSBlbC5vZmZzZXRUb3A7DQoNCiAgICAgICAgd2hpbGUgKGVsLnRhZ05hbWUudG9Mb3dl
ckNhc2UoKSAhPSAiYm9keSIpDQogICAgICAgIHsNCiAgICAgICAgICBlbCA9IGVsLm9mZnNldFBh
cmVudDsNCiAgICAgICAgICBzdW0gKz0gZWwub2Zmc2V0VG9wIC0gZWwuc2Nyb2xsVG9wOw0KICAg
ICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHN1bTsNCiAgICAgIH0NCiAgICB9KSwNCg0KDQogICAg
LyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBw
YXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2b2lkfQ0KICAgICAqIEBz
aWduYXR1cmUgZnVuY3Rpb24oZWwpDQogICAgICovDQogICAgZ2V0Q2xpZW50Qm94UmlnaHQgOiBx
eC5jb3JlLlZhcmlhbnQuc2VsZWN0KCJxeC5jbGllbnQiLA0KICAgIHsNCiAgICAgICJtc2h0bWwi
IDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJuIGVsLmdldEJvdW5kaW5nQ2xpZW50UmVj
dCgpLnJpZ2h0Ow0KICAgICAgfSwNCg0KICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHsN
CiAgICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0Q2xpZW50Qm94TGVmdChlbCkgKyBx
eC5odG1sLkRpbWVuc2lvbi5nZXRCb3hXaWR0aChlbCk7DQogICAgICB9DQogICAgfSksDQoNCg0K
ICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAg
KiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dm9pZH0NCiAgICAg
KiBAc2lnbmF0dXJlIGZ1bmN0aW9uKGVsKQ0KICAgICAqLw0KICAgIGdldENsaWVudEJveEJvdHRv
bSA6IHF4LmNvcmUuVmFyaWFudC5zZWxlY3QoInF4LmNsaWVudCIsDQogICAgew0KICAgICAgIm1z
aHRtbCIgOiBmdW5jdGlvbihlbCkgew0KICAgICAgICByZXR1cm4gZWwuZ2V0Qm91bmRpbmdDbGll
bnRSZWN0KCkuYm90dG9tOw0KICAgICAgfSwNCg0KICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24o
ZWwpIHsNCiAgICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0Q2xpZW50Qm94VG9wKGVs
KSArIHF4Lmh0bWwuRGltZW5zaW9uLmdldEJveEhlaWdodChlbCk7DQogICAgICB9DQogICAgfSks
DQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMN
CiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dm9pZH0N
CiAgICAgKiBAc2lnbmF0dXJlIGZ1bmN0aW9uKGVsKQ0KICAgICAqLw0KICAgIGdldFBhZ2VCb3hM
ZWZ0IDogcXguY29yZS5WYXJpYW50LnNlbGVjdCgicXguY2xpZW50IiwNCiAgICB7DQogICAgICAi
bXNodG1sIiA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9u
LmdldENsaWVudEJveExlZnQoZWwpICsgcXguaHRtbC5TY3JvbGwuZ2V0TGVmdFN1bShlbCk7DQog
ICAgICB9LA0KDQogICAgICAiZ2Vja28iIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJu
IHF4Lmh0bWwuTG9jYXRpb24uZ2V0UGFnZUFyZWFMZWZ0KGVsKSAtIHF4Lmh0bWwuU3R5bGUuZ2V0
Qm9yZGVyTGVmdChlbCk7DQogICAgICB9LA0KDQogICAgICAiZGVmYXVsdCIgOiBmdW5jdGlvbihl
bCkNCiAgICAgIHsNCiAgICAgICAgdmFyIHN1bSA9IGVsLm9mZnNldExlZnQ7DQoNCiAgICAgICAg
d2hpbGUgKGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPSAiYm9keSIpDQogICAgICAgIHsNCiAg
ICAgICAgICBlbCA9IGVsLm9mZnNldFBhcmVudDsNCiAgICAgICAgICBzdW0gKz0gZWwub2Zmc2V0
TGVmdDsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBzdW07DQogICAgICB9DQogICAgfSks
DQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMN
CiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dm9pZH0N
CiAgICAgKiBAc2lnbmF0dXJlIGZ1bmN0aW9uKGVsKQ0KICAgICAqLw0KICAgIGdldFBhZ2VCb3hU
b3AgOiBxeC5jb3JlLlZhcmlhbnQuc2VsZWN0KCJxeC5jbGllbnQiLA0KICAgIHsNCiAgICAgICJt
c2h0bWwiIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24u
Z2V0Q2xpZW50Qm94VG9wKGVsKSArIHF4Lmh0bWwuU2Nyb2xsLmdldFRvcFN1bShlbCk7DQogICAg
ICB9LA0KDQogICAgICAiZ2Vja28iIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJuIHF4
Lmh0bWwuTG9jYXRpb24uZ2V0UGFnZUFyZWFUb3AoZWwpIC0gcXguaHRtbC5TdHlsZS5nZXRCb3Jk
ZXJUb3AoZWwpOw0KICAgICAgfSwNCg0KICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpDQog
ICAgICB7DQogICAgICAgIHZhciBzdW0gPSBlbC5vZmZzZXRUb3A7DQoNCiAgICAgICAgd2hpbGUg
KGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPSAiYm9keSIpDQogICAgICAgIHsNCiAgICAgICAg
ICBlbCA9IGVsLm9mZnNldFBhcmVudDsNCiAgICAgICAgICBzdW0gKz0gZWwub2Zmc2V0VG9wOw0K
ICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHN1bTsNCiAgICAgIH0NCiAgICB9KSwNCg0KDQog
ICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAq
IEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2b2lkfQ0KICAgICAq
IEBzaWduYXR1cmUgZnVuY3Rpb24oZWwpDQogICAgICovDQogICAgZ2V0UGFnZUJveFJpZ2h0IDog
cXguY29yZS5WYXJpYW50LnNlbGVjdCgicXguY2xpZW50IiwNCiAgICB7DQogICAgICAibXNodG1s
IiA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9uLmdldENs
aWVudEJveFJpZ2h0KGVsKSArIHF4Lmh0bWwuU2Nyb2xsLmdldExlZnRTdW0oZWwpOw0KICAgICAg
fSwNCg0KICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJuIHF4
Lmh0bWwuTG9jYXRpb24uZ2V0UGFnZUJveExlZnQoZWwpICsgcXguaHRtbC5EaW1lbnNpb24uZ2V0
Qm94V2lkdGgoZWwpOw0KICAgICAgfQ0KICAgIH0pLA0KDQoNCiAgICAvKioNCiAgICAgKiBUT0RP
Qw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVsIHtFbGVtZW50
fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3ZvaWR9DQogICAgICogQHNpZ25hdHVyZSBmdW5jdGlv
bihlbCkNCiAgICAgKi8NCiAgICBnZXRQYWdlQm94Qm90dG9tIDogcXguY29yZS5WYXJpYW50LnNl
bGVjdCgicXguY2xpZW50IiwNCiAgICB7DQogICAgICAibXNodG1sIiA6IGZ1bmN0aW9uKGVsKSB7
DQogICAgICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9uLmdldENsaWVudEJveEJvdHRvbShlbCkg
KyBxeC5odG1sLlNjcm9sbC5nZXRUb3BTdW0oZWwpOw0KICAgICAgfSwNCg0KICAgICAgImRlZmF1
bHQiIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0
UGFnZUJveFRvcChlbCkgKyBxeC5odG1sLkRpbWVuc2lvbi5nZXRCb3hIZWlnaHQoZWwpOw0KICAg
ICAgfQ0KICAgIH0pLA0KDQoNCiAgICAvKioNCiAgICAgKiBUT0RPQw0KICAgICAqDQogICAgICog
QHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVsIHtFbGVtZW50fSBUT0RPQw0KICAgICAqIEBy
ZXR1cm4ge3ZvaWR9DQogICAgICogQHNpZ25hdHVyZSBmdW5jdGlvbihlbCkNCiAgICAgKi8NCiAg
ICBnZXRDbGllbnRBcmVhTGVmdCA6IHF4LmNvcmUuVmFyaWFudC5zZWxlY3QoInF4LmNsaWVudCIs
DQogICAgew0KICAgICAgImdlY2tvIiA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICAgIC8vIFdlIG5l
ZWQgdG8gc3VidHJhY3QgdGhlIHNjcm9sbCBwb3NpdGlvbiBvZiBhbGwgcGFyZW50IGNvbnRhaW5l
cnMgKGJ1ZyAjMTg2MjI5KS4NCiAgICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0UGFn
ZUFyZWFMZWZ0KGVsKSAtIHF4Lmh0bWwuU2Nyb2xsLmdldExlZnRTdW0oZWwpOw0KICAgICAgfSwN
Cg0KICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJuIHF4Lmh0
bWwuTG9jYXRpb24uZ2V0Q2xpZW50Qm94TGVmdChlbCkgKyBxeC5odG1sLlN0eWxlLmdldEJvcmRl
ckxlZnQoZWwpOw0KICAgICAgfQ0KICAgIH0pLA0KDQoNCiAgICAvKioNCiAgICAgKiBUT0RPQw0K
ICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVsIHtFbGVtZW50fSBU
T0RPQw0KICAgICAqIEByZXR1cm4ge3ZvaWR9DQogICAgICogQHNpZ25hdHVyZSBmdW5jdGlvbihl
bCkNCiAgICAgKi8NCiAgICBnZXRDbGllbnRBcmVhVG9wIDogcXguY29yZS5WYXJpYW50LnNlbGVj
dCgicXguY2xpZW50IiwNCiAgICB7DQogICAgICAiZ2Vja28iIDogZnVuY3Rpb24oZWwpIHsNCiAg
ICAgICAgLy8gV2UgbmVlZCB0byBzdWJ0cmFjdCB0aGUgc2Nyb2xsIHBvc2l0aW9uIG9mIGFsbCBw
YXJlbnQgY29udGFpbmVycyAoYnVnICMxODYyMjkpLg0KICAgICAgICByZXR1cm4gcXguaHRtbC5M
b2NhdGlvbi5nZXRQYWdlQXJlYVRvcChlbCkgLSBxeC5odG1sLlNjcm9sbC5nZXRUb3BTdW0oZWwp
Ow0KICAgICAgfSwNCg0KICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAg
cmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0Q2xpZW50Qm94VG9wKGVsKSArIHF4Lmh0bWwuU3R5
bGUuZ2V0Qm9yZGVyVG9wKGVsKTsNCiAgICAgIH0NCiAgICB9KSwNCg0KDQogICAgLyoqDQogICAg
ICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7
RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2YXJ9IFRPRE9DDQogICAgICovDQogICAg
Z2V0Q2xpZW50QXJlYVJpZ2h0IDogZnVuY3Rpb24oZWwpIHsNCiAgICAgIHJldHVybiBxeC5odG1s
LkxvY2F0aW9uLmdldENsaWVudEFyZWFMZWZ0KGVsKSArIHF4Lmh0bWwuRGltZW5zaW9uLmdldEFy
ZWFXaWR0aChlbCk7DQogICAgfSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0K
ICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAg
ICAgKiBAcmV0dXJuIHt2YXJ9IFRPRE9DDQogICAgICovDQogICAgZ2V0Q2xpZW50QXJlYUJvdHRv
bSA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRDbGll
bnRBcmVhVG9wKGVsKSArIHF4Lmh0bWwuRGltZW5zaW9uLmdldEFyZWFIZWlnaHQoZWwpOw0KICAg
IH0sDQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0
aWMNCiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dm9p
ZH0NCiAgICAgKiBAc2lnbmF0dXJlIGZ1bmN0aW9uKGVsKQ0KICAgICAqLw0KICAgIGdldFBhZ2VB
cmVhTGVmdCA6IHF4LmNvcmUuVmFyaWFudC5zZWxlY3QoInF4LmNsaWVudCIsDQogICAgew0KICAg
ICAgImdlY2tvIiA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICAgIC8vIGZvciBGaXJlZm94IDMuNisN
CiAgICAgICAgLy8gU2VlIEJ1ZyAjMjIzMiAgDQogICAgICAgIGlmICh3aW5kb3cubW96SW5uZXJT
Y3JlZW5YICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgIHJldHVybiBlbC5nZXRCb3VuZGluZ0Ns
aWVudFJlY3QoKS5sZWZ0Ow0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHJldHVybiBlbC5v
d25lckRvY3VtZW50LmdldEJveE9iamVjdEZvcihlbCkueDsNCiAgICAgICAgfQ0KICAgICAgfSwN
Cg0KICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJuIHF4Lmh0
bWwuTG9jYXRpb24uZ2V0UGFnZUJveExlZnQoZWwpICsgcXguaHRtbC5TdHlsZS5nZXRCb3JkZXJM
ZWZ0KGVsKTsNCiAgICAgIH0NCiAgICB9KSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAg
ICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9E
T0MNCiAgICAgKiBAcmV0dXJuIHt2b2lkfQ0KICAgICAqIEBzaWduYXR1cmUgZnVuY3Rpb24oZWwp
DQogICAgICovDQogICAgZ2V0UGFnZUFyZWFUb3AgOiBxeC5jb3JlLlZhcmlhbnQuc2VsZWN0KCJx
eC5jbGllbnQiLA0KICAgIHsNCiAgICAgICJnZWNrbyIgOiBmdW5jdGlvbihlbCkgew0KICAgICAg
ICAvLyBmb3IgRmlyZWZveCAzLjYrDQogICAgICAgIC8vIFNlZSBCdWcgIzIyMzINCiAgICAgICAg
aWYgKHdpbmRvdy5tb3pJbm5lclNjcmVlblkgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgcmV0
dXJuIGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDsNCiAgICAgICAgfSBlbHNlIHsNCiAg
ICAgICAgICByZXR1cm4gZWwub3duZXJEb2N1bWVudC5nZXRCb3hPYmplY3RGb3IoZWwpLnk7DQog
ICAgICAgIH0NCiAgICAgIH0sDQoNCiAgICAgICJkZWZhdWx0IiA6IGZ1bmN0aW9uKGVsKSB7DQog
ICAgICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9uLmdldFBhZ2VCb3hUb3AoZWwpICsgcXguaHRt
bC5TdHlsZS5nZXRCb3JkZXJUb3AoZWwpOw0KICAgICAgfQ0KICAgIH0pLA0KDQoNCiAgICAvKioN
CiAgICAgKiBUT0RPQw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFt
IGVsIHtFbGVtZW50fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAgICAgKi8N
CiAgICBnZXRQYWdlQXJlYVJpZ2h0IDogZnVuY3Rpb24oZWwpIHsNCiAgICAgIHJldHVybiBxeC5o
dG1sLkxvY2F0aW9uLmdldFBhZ2VBcmVhTGVmdChlbCkgKyBxeC5odG1sLkRpbWVuc2lvbi5nZXRB
cmVhV2lkdGgoZWwpOw0KICAgIH0sDQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoN
CiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQog
ICAgICogQHJldHVybiB7dmFyfSBUT0RPQw0KICAgICAqLw0KICAgIGdldFBhZ2VBcmVhQm90dG9t
IDogZnVuY3Rpb24oZWwpIHsNCiAgICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9uLmdldFBhZ2VB
cmVhVG9wKGVsKSArIHF4Lmh0bWwuRGltZW5zaW9uLmdldEFyZWFIZWlnaHQoZWwpOw0KICAgIH0s
DQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMN
CiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dmFyfSBU
T0RPQw0KICAgICAqLw0KICAgIGdldENsaWVudElubmVyTGVmdCA6IGZ1bmN0aW9uKGVsKSB7DQog
ICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRDbGllbnRBcmVhTGVmdChlbCkgKyBxeC5o
dG1sLlN0eWxlLmdldFBhZGRpbmdMZWZ0KGVsKTsNCiAgICB9LA0KDQoNCiAgICAvKioNCiAgICAg
KiBUT0RPQw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVsIHtF
bGVtZW50fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAgICAgKi8NCiAgICBn
ZXRDbGllbnRJbm5lclRvcCA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICByZXR1cm4gcXguaHRtbC5M
b2NhdGlvbi5nZXRDbGllbnRBcmVhVG9wKGVsKSArIHF4Lmh0bWwuU3R5bGUuZ2V0UGFkZGluZ1Rv
cChlbCk7DQogICAgfSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAq
IEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBA
cmV0dXJuIHt2YXJ9IFRPRE9DDQogICAgICovDQogICAgZ2V0Q2xpZW50SW5uZXJSaWdodCA6IGZ1
bmN0aW9uKGVsKSB7DQogICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRDbGllbnRJbm5l
ckxlZnQoZWwpICsgcXguaHRtbC5EaW1lbnNpb24uZ2V0SW5uZXJXaWR0aChlbCk7DQogICAgfSwN
Cg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0K
ICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2YXJ9IFRP
RE9DDQogICAgICovDQogICAgZ2V0Q2xpZW50SW5uZXJCb3R0b20gOiBmdW5jdGlvbihlbCkgew0K
ICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0Q2xpZW50SW5uZXJUb3AoZWwpICsgcXgu
aHRtbC5EaW1lbnNpb24uZ2V0SW5uZXJIZWlnaHQoZWwpOw0KICAgIH0sDQoNCg0KICAgIC8qKg0K
ICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFyYW0g
ZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dmFyfSBUT0RPQw0KICAgICAqLw0K
ICAgIGdldFBhZ2VJbm5lckxlZnQgOiBmdW5jdGlvbihlbCkgew0KICAgICAgcmV0dXJuIHF4Lmh0
bWwuTG9jYXRpb24uZ2V0UGFnZUFyZWFMZWZ0KGVsKSArIHF4Lmh0bWwuU3R5bGUuZ2V0UGFkZGlu
Z0xlZnQoZWwpOw0KICAgIH0sDQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAg
ICAgKiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAg
ICogQHJldHVybiB7dmFyfSBUT0RPQw0KICAgICAqLw0KICAgIGdldFBhZ2VJbm5lclRvcCA6IGZ1
bmN0aW9uKGVsKSB7DQogICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRQYWdlQXJlYVRv
cChlbCkgKyBxeC5odG1sLlN0eWxlLmdldFBhZGRpbmdUb3AoZWwpOw0KICAgIH0sDQoNCg0KICAg
IC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAgKiBA
cGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dmFyfSBUT0RPQw0KICAg
ICAqLw0KICAgIGdldFBhZ2VJbm5lclJpZ2h0IDogZnVuY3Rpb24oZWwpIHsNCiAgICAgIHJldHVy
biBxeC5odG1sLkxvY2F0aW9uLmdldFBhZ2VJbm5lckxlZnQoZWwpICsgcXguaHRtbC5EaW1lbnNp
b24uZ2V0SW5uZXJXaWR0aChlbCk7DQogICAgfSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MN
CiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0g
VE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2YXJ9IFRPRE9DDQogICAgICovDQogICAgZ2V0UGFnZUlu
bmVyQm90dG9tIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9u
LmdldFBhZ2VJbm5lclRvcChlbCkgKyBxeC5odG1sLkRpbWVuc2lvbi5nZXRJbm5lckhlaWdodChl
bCk7DQogICAgfSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0
eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0
dXJuIHt2b2lkfQ0KICAgICAqIEBzaWduYXR1cmUgZnVuY3Rpb24oZWwpDQogICAgICovDQogICAg
Z2V0U2NyZWVuQm94TGVmdCA6IHF4LmNvcmUuVmFyaWFudC5zZWxlY3QoInF4LmNsaWVudCIsDQog
ICAgew0KICAgICAgImdlY2tvIiA6IGZ1bmN0aW9uKGVsKQ0KICAgICAgew0KICAgICAgICAvLyBz
Y3JlZW5YIGFuZCBzY3JlZW5ZIHNlZW0gdG8gcmV0dXJuIHRoZSBkaXN0YW5jZSB0byB0aGUgYm94
DQogICAgICAgIC8vIGFuZCBub3QgdG8gdGhlIGFyZWEuIENvbmZ1c2luZywgZXNwZWNpYWxseSBh
cyB0aGUgeCBhbmQgeSBwcm9wZXJ0aWVzDQogICAgICAgIC8vIG9mIHRoZSBCb3hPYmplY3QgcmV0
dXJuIHRoZSBkaXN0YW5jZSB0byB0aGUgYXJlYS4NCg0KICAgICAgICAvLyBXZSBuZWVkIHRvIHN1
YnRyYWN0IHRoZSBzY3JvbGwgcG9zaXRpb24gb2YgYWxsDQogICAgICAgIC8vIHBhcmVudCBjb250
YWluZXJzIChidWcgIzE4NjIyOSkuDQogICAgICAgIHZhciBzY3JlZW5YOw0KICAgICAgICB2YXIg
c3VtID0gMDsNCiAgICAgICAgdmFyIHAgPSBlbC5wYXJlbnROb2RlOw0KDQogICAgICAgIHdoaWxl
IChwLm5vZGVUeXBlID09IDEpDQogICAgICAgIHsNCiAgICAgICAgICBzdW0gKz0gcC5zY3JvbGxM
ZWZ0Ow0KICAgICAgICAgIHAgPSBwLnBhcmVudE5vZGU7DQogICAgICAgIH0NCg0KICAgICAgICAv
LyBmb3IgRmlyZWZveCAzLjYrDQogICAgICAgIC8vIFNlZSBCdWcgIzIyMzINCiAgICAgICAgaWYg
KHdpbmRvdy5tb3pJbm5lclNjcmVlblggIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgc2NyZWVu
WCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgKyB3aW5kb3cubW96SW5uZXJTY3Jl
ZW5YOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHNjcmVlblggPSBlbC5vd25lckRvY3Vt
ZW50LmdldEJveE9iamVjdEZvcihlbCkuc2NyZWVuWDsNCiAgICAgICAgfQ0KICAgICAgICANCiAg
ICAgICAgcmV0dXJuIHNjcmVlblggLSBzdW07DQogICAgICB9LA0KDQogICAgICAiZGVmYXVsdCIg
OiBmdW5jdGlvbihlbCkgew0KICAgICAgICAvLyBIb3BlIHRoaXMgd29ya3MgaW4ga2h0bWwsIHRv
byAob3BlcmEgNy42cDMgc2VlbXMgdG8gYmUgb2spDQogICAgICAgIHJldHVybiBxeC5odG1sLkxv
Y2F0aW9uLmdldFNjcmVlbkRvY3VtZW50TGVmdChlbCkgKyBxeC5odG1sLkxvY2F0aW9uLmdldFBh
Z2VCb3hMZWZ0KGVsKTsNCiAgICAgIH0NCiAgICB9KSwNCg0KDQogICAgLyoqDQogICAgICogVE9E
T0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVu
dH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2b2lkfQ0KICAgICAqIEBzaWduYXR1cmUgZnVuY3Rp
b24oZWwpDQogICAgICovDQogICAgZ2V0U2NyZWVuQm94VG9wIDogcXguY29yZS5WYXJpYW50LnNl
bGVjdCgicXguY2xpZW50IiwNCiAgICB7DQogICAgICAiZ2Vja28iIDogZnVuY3Rpb24oZWwpDQog
ICAgICB7DQogICAgICAgIC8vIFdlIG5lZWQgdG8gc3VidHJhY3QgdGhlIHNjcm9sbCBwb3NpdGlv
biBvZiBhbGwNCiAgICAgICAgLy8gcGFyZW50IGNvbnRhaW5lcnMgKGJ1ZyAjMTg2MjI5KS4NCiAg
ICAgICAgdmFyIHNjcmVlblk7DQogICAgICAgIHZhciBzdW0gPSAwOw0KICAgICAgICB2YXIgcCA9
IGVsLnBhcmVudE5vZGU7DQoNCiAgICAgICAgd2hpbGUgKHAubm9kZVR5cGUgPT0gMSkNCiAgICAg
ICAgew0KICAgICAgICAgIHN1bSArPSBwLnNjcm9sbFRvcDsNCiAgICAgICAgICBwID0gcC5wYXJl
bnROb2RlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gZm9yIEZpcmVmb3ggMy42Kw0KICAgICAg
ICAvLyBTZWUgQnVnICMyMjMyDQogICAgICAgIGlmICh3aW5kb3cubW96SW5uZXJTY3JlZW5ZICE9
IHVuZGVmaW5lZCkgew0KICAgICAgICAgIHNjcmVlblkgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJl
Y3QoKS50b3AgKyB3aW5kb3cubW96SW5uZXJTY3JlZW5ZOw0KICAgICAgICB9IGVsc2Ugew0KICAg
ICAgICAgIHNjcmVlblkgPSBlbC5vd25lckRvY3VtZW50LmdldEJveE9iamVjdEZvcihlbCkuc2Ny
ZWVuWTsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHNjcmVlblkgLSBzdW07
DQogICAgICB9LA0KDQogICAgICAiZGVmYXVsdCIgOiBmdW5jdGlvbihlbCkgew0KICAgICAgICBy
ZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRTY3JlZW5Eb2N1bWVudFRvcChlbCkgKyBxeC5odG1s
LkxvY2F0aW9uLmdldFBhZ2VCb3hUb3AoZWwpOw0KICAgICAgfQ0KICAgIH0pLA0KDQoNCiAgICAv
KioNCiAgICAgKiBUT0RPQw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBh
cmFtIGVsIHtFbGVtZW50fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAgICAg
Ki8NCiAgICBnZXRTY3JlZW5Cb3hSaWdodCA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICByZXR1cm4g
cXguaHRtbC5Mb2NhdGlvbi5nZXRTY3JlZW5Cb3hMZWZ0KGVsKSArIHF4Lmh0bWwuRGltZW5zaW9u
LmdldEJveFdpZHRoKGVsKTsNCiAgICB9LA0KDQoNCiAgICAvKioNCiAgICAgKiBUT0RPQw0KICAg
ICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVsIHtFbGVtZW50fSBUT0RP
Qw0KICAgICAqIEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAgICAgKi8NCiAgICBnZXRTY3JlZW5Cb3hC
b3R0b20gOiBmdW5jdGlvbihlbCkgew0KICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0
U2NyZWVuQm94VG9wKGVsKSArIHF4Lmh0bWwuRGltZW5zaW9uLmdldEJveEhlaWdodChlbCk7DQog
ICAgfSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0
YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2
YXJ9IFRPRE9DDQogICAgICovDQogICAgZ2V0U2NyZWVuT3V0ZXJMZWZ0IDogZnVuY3Rpb24oZWwp
IHsNCiAgICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9uLmdldFNjcmVlbkJveExlZnQoZWwpIC0g
cXguaHRtbC5TdHlsZS5nZXRNYXJnaW5MZWZ0KGVsKTsNCiAgICB9LA0KDQoNCiAgICAvKioNCiAg
ICAgKiBUT0RPQw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVs
IHtFbGVtZW50fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAgICAgKi8NCiAg
ICBnZXRTY3JlZW5PdXRlclRvcCA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICByZXR1cm4gcXguaHRt
bC5Mb2NhdGlvbi5nZXRTY3JlZW5Cb3hUb3AoZWwpIC0gcXguaHRtbC5TdHlsZS5nZXRNYXJnaW5U
b3AoZWwpOw0KICAgIH0sDQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAg
KiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICog
QHJldHVybiB7dmFyfSBUT0RPQw0KICAgICAqLw0KICAgIGdldFNjcmVlbk91dGVyUmlnaHQgOiBm
dW5jdGlvbihlbCkgew0KICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0U2NyZWVuQm94
UmlnaHQoZWwpICsgcXguaHRtbC5TdHlsZS5nZXRNYXJnaW5SaWdodChlbCk7DQogICAgfSwNCg0K
DQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAg
ICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2YXJ9IFRPRE9D
DQogICAgICovDQogICAgZ2V0U2NyZWVuT3V0ZXJCb3R0b20gOiBmdW5jdGlvbihlbCkgew0KICAg
ICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0U2NyZWVuQm94Qm90dG9tKGVsKSArIHF4Lmh0
bWwuU3R5bGUuZ2V0TWFyZ2luQm90dG9tKGVsKTsNCiAgICB9LA0KDQoNCiAgICAvKioNCiAgICAg
KiBUT0RPQw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVsIHtF
bGVtZW50fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAgICAgKi8NCiAgICBn
ZXRTY3JlZW5BcmVhTGVmdCA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICByZXR1cm4gcXguaHRtbC5M
b2NhdGlvbi5nZXRTY3JlZW5Cb3hMZWZ0KGVsKSArIHF4Lmh0bWwuRGltZW5zaW9uLmdldEluc2V0
TGVmdChlbCk7DQogICAgfSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAg
ICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAg
KiBAcmV0dXJuIHt2YXJ9IFRPRE9DDQogICAgICovDQogICAgZ2V0U2NyZWVuQXJlYVRvcCA6IGZ1
bmN0aW9uKGVsKSB7DQogICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRTY3JlZW5Cb3hU
b3AoZWwpICsgcXguaHRtbC5EaW1lbnNpb24uZ2V0SW5zZXRUb3AoZWwpOw0KICAgIH0sDQoNCg0K
ICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAg
KiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dmFyfSBUT0RPQw0K
ICAgICAqLw0KICAgIGdldFNjcmVlbkFyZWFSaWdodCA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICBy
ZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRTY3JlZW5Cb3hSaWdodChlbCkgLSBxeC5odG1sLkRp
bWVuc2lvbi5nZXRJbnNldFJpZ2h0KGVsKTsNCiAgICB9LA0KDQoNCiAgICAvKioNCiAgICAgKiBU
T0RPQw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVsIHtFbGVt
ZW50fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAgICAgKi8NCiAgICBnZXRT
Y3JlZW5BcmVhQm90dG9tIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgIHJldHVybiBxeC5odG1sLkxv
Y2F0aW9uLmdldFNjcmVlbkJveEJvdHRvbShlbCkgLSBxeC5odG1sLkRpbWVuc2lvbi5nZXRJbnNl
dEJvdHRvbShlbCk7DQogICAgfSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0K
ICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAg
ICAgKiBAcmV0dXJuIHt2YXJ9IFRPRE9DDQogICAgICovDQogICAgZ2V0U2NyZWVuSW5uZXJMZWZ0
IDogZnVuY3Rpb24oZWwpIHsNCiAgICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9uLmdldFNjcmVl
bkFyZWFMZWZ0KGVsKSArIHF4Lmh0bWwuU3R5bGUuZ2V0UGFkZGluZ0xlZnQoZWwpOw0KICAgIH0s
DQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMN
CiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dmFyfSBU
T0RPQw0KICAgICAqLw0KICAgIGdldFNjcmVlbklubmVyVG9wIDogZnVuY3Rpb24oZWwpIHsNCiAg
ICAgIHJldHVybiBxeC5odG1sLkxvY2F0aW9uLmdldFNjcmVlbkFyZWFUb3AoZWwpICsgcXguaHRt
bC5TdHlsZS5nZXRQYWRkaW5nVG9wKGVsKTsNCiAgICB9LA0KDQoNCiAgICAvKioNCiAgICAgKiBU
T0RPQw0KICAgICAqDQogICAgICogQHR5cGUgc3RhdGljDQogICAgICogQHBhcmFtIGVsIHtFbGVt
ZW50fSBUT0RPQw0KICAgICAqIEByZXR1cm4ge3Zhcn0gVE9ET0MNCiAgICAgKi8NCiAgICBnZXRT
Y3JlZW5Jbm5lclJpZ2h0IDogZnVuY3Rpb24oZWwpIHsNCiAgICAgIHJldHVybiBxeC5odG1sLkxv
Y2F0aW9uLmdldFNjcmVlbkFyZWFSaWdodChlbCkgLSBxeC5odG1sLlN0eWxlLmdldFBhZGRpbmdS
aWdodChlbCk7DQogICAgfSwNCg0KDQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAg
ICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAg
KiBAcmV0dXJuIHt2YXJ9IFRPRE9DDQogICAgICovDQogICAgZ2V0U2NyZWVuSW5uZXJCb3R0b20g
OiBmdW5jdGlvbihlbCkgew0KICAgICAgcmV0dXJuIHF4Lmh0bWwuTG9jYXRpb24uZ2V0U2NyZWVu
QXJlYUJvdHRvbShlbCkgLSBxeC5odG1sLlN0eWxlLmdldFBhZGRpbmdCb3R0b20oZWwpOw0KICAg
IH0sDQoNCg0KICAgIC8qKg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0
aWMNCiAgICAgKiBAcGFyYW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dm9p
ZH0NCiAgICAgKiBAc2lnbmF0dXJlIGZ1bmN0aW9uKGVsKQ0KICAgICAqLw0KICAgIGdldFNjcmVl
bkRvY3VtZW50TGVmdCA6IHF4LmNvcmUuVmFyaWFudC5zZWxlY3QoInF4LmNsaWVudCIsDQogICAg
ew0KICAgICAgImdlY2tvIiA6IGZ1bmN0aW9uKGVsKSB7DQogICAgICAgIC8vIFRlc3RlZCBpbiBH
ZWNrbyAxLjcuNQ0KICAgICAgICAvLw0KICAgICAgICAvLyAgTm90aWNlOg0KICAgICAgICAvLyAg
ICBUaGlzIGRvZXNuJ3Qgd29yayBsaWtlIHRoZSBtc2h0bWwgbWV0aG9kOg0KICAgICAgICAvLyAg
ICBlbC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LnNjcmVlblg7DQogICAgICAgIHJldHVybiBx
eC5odG1sLkxvY2F0aW9uLmdldFNjcmVlbk91dGVyTGVmdChlbC5vd25lckRvY3VtZW50LmJvZHkp
Ow0KICAgICAgfSwNCg0KICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAg
Ly8gVGVzdGVkIGluIE9wZXJhIDcuNmIzIGFuZCBNc2h0bWwgNi4wIChYUC1TUDIpDQogICAgICAg
IC8vIFdoYXQncyB1cCB3aXRoIGtodG1sIChTYWZhcmkvS29ucSk/DQogICAgICAgIHJldHVybiBl
bC5kb2N1bWVudC5wYXJlbnRXaW5kb3cuc2NyZWVuTGVmdDsNCiAgICAgIH0NCiAgICB9KSwNCg0K
DQogICAgLyoqDQogICAgICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAg
ICAqIEBwYXJhbSBlbCB7RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2b2lkfQ0KICAg
ICAqIEBzaWduYXR1cmUgZnVuY3Rpb24oZWwpDQogICAgICovDQogICAgZ2V0U2NyZWVuRG9jdW1l
bnRUb3AgOiBxeC5jb3JlLlZhcmlhbnQuc2VsZWN0KCJxeC5jbGllbnQiLA0KICAgIHsNCiAgICAg
ICJnZWNrbyIgOiBmdW5jdGlvbihlbCkgew0KICAgICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlv
bi5nZXRTY3JlZW5PdXRlclRvcChlbC5vd25lckRvY3VtZW50LmJvZHkpOw0KICAgICAgfSwNCg0K
ICAgICAgImRlZmF1bHQiIDogZnVuY3Rpb24oZWwpIHsNCiAgICAgICAgcmV0dXJuIGVsLmRvY3Vt
ZW50LnBhcmVudFdpbmRvdy5zY3JlZW5Ub3A7DQogICAgICB9DQogICAgfSksDQoNCg0KICAgIC8q
Kg0KICAgICAqIFRPRE9DDQogICAgICoNCiAgICAgKiBAdHlwZSBzdGF0aWMNCiAgICAgKiBAcGFy
YW0gZWwge0VsZW1lbnR9IFRPRE9DDQogICAgICogQHJldHVybiB7dm9pZH0NCiAgICAgKiBAc2ln
bmF0dXJlIGZ1bmN0aW9uKGVsKQ0KICAgICAqLw0KICAgIGdldFNjcmVlbkRvY3VtZW50UmlnaHQg
OiBxeC5jb3JlLlZhcmlhbnQuc2VsZWN0KCJxeC5jbGllbnQiLA0KICAgIHsNCiAgICAgICJnZWNr
byIgOiBmdW5jdGlvbihlbCkgew0KICAgICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRT
Y3JlZW5PdXRlclJpZ2h0KGVsLm93bmVyRG9jdW1lbnQuYm9keSk7DQogICAgICB9LA0KDQogICAg
ICAiZGVmYXVsdCIgOiBmdW5jdGlvbihlbCkge30NCiAgICB9KSwNCg0KDQogICAgLyoqDQogICAg
ICogVE9ET0MNCiAgICAgKg0KICAgICAqIEB0eXBlIHN0YXRpYw0KICAgICAqIEBwYXJhbSBlbCB7
RWxlbWVudH0gVE9ET0MNCiAgICAgKiBAcmV0dXJuIHt2b2lkfQ0KICAgICAqIEBzaWduYXR1cmUg
ZnVuY3Rpb24oZWwpDQogICAgICovDQogICAgZ2V0U2NyZWVuRG9jdW1lbnRCb3R0b20gOiBxeC5j
b3JlLlZhcmlhbnQuc2VsZWN0KCJxeC5jbGllbnQiLA0KICAgIHsNCiAgICAgICJnZWNrbyIgOiBm
dW5jdGlvbihlbCkgew0KICAgICAgICByZXR1cm4gcXguaHRtbC5Mb2NhdGlvbi5nZXRTY3JlZW5P
dXRlckJvdHRvbShlbC5vd25lckRvY3VtZW50LmJvZHkpOw0KICAgICAgfSwNCg0KICAgICAgImRl
ZmF1bHQiIDogZnVuY3Rpb24oZWwpIHt9DQogICAgfSkNCiAgfQ0KfSk7
</data>

          </attachment>
      

    </bug>