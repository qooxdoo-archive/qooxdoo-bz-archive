<bug>
          <bug_id>760</bug_id>
          
          <creation_ts>2008-01-16 16:01:00 +0100</creation_ts>
          <short_desc>table creates corrupted style setting for outer div</short_desc>
          <delta_ts>2014-03-03 15:23:38 +0100</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>framework</product>
          <component>desktop.table</component>
          <version>0.7.3</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          <bug_file_loc>http://demo.qooxdoo.org/current/feedreader/</bug_file_loc>
          
          
          <priority>P3</priority>
          <bug_severity>normal</bug_severity>
          <target_milestone>0.8.1</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Hugh Gibson">hgibson</reporter>
          <assigned_to name="Unassigned">none</assigned_to>
          <cc>helder.magalhaes</cc>
          <qa_contact name="qooxdoo bugs mailing list">qooxdoo-bugs</qa_contact>
          <cf_browser>---</cf_browser>
          

      

      

      

          <long_desc isprivate="0">
            <commentid>2775</commentid>
            <who name="Hugh Gibson">hgibson</who>
            <bug_when>2008-01-16 16:01:55 +0100</bug_when>
            <thetext>The table creates lots of divs. The immediate parent div of all the rows of the table appears to be corrupted. In Firebug it shows up as:

&lt;div sans-serif;=&quot;&quot; ,=&quot;&quot; unicode=&quot;&quot; sans=&quot;&quot; lucida=&quot;&quot; tahoma,=&quot;&quot; calibri,=&quot;&quot; corbel,=&quot;&quot; ui=&quot;&quot; segoe=&quot;&quot; style=&quot;overflow: hidden; width: 1048px; line-height: 20px; font-size: 11px;&quot;&gt;

This doesn&#39;t appear to affect the layout but is obviously wrong. You can see it in the feedreader if you inspect the generated HTML.

Possibly a style string is being split and joined incorrectly.

Hugh</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>2776</commentid>
              <attachid>281</attachid>
            <who name="Hugh Gibson">hgibson</who>
            <bug_when>2008-01-16 16:14:56 +0100</bug_when>
            <thetext>Created attachment 281
Corrects bad format style string for table pane

The attached patch fixes the problem. There was a poor choice of quotes in a style string.

Hugh</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>2897</commentid>
            <who name="Helder Magalhães">helder.magalhaes</who>
            <bug_when>2008-03-12 19:08:00 +0100</bug_when>
            <thetext>Created a new thread in the mailing list [1] before noticing this error report - missed during initial search for related bugs...

Some patches which may (also) help fixing the issue and additional comments are in the mailing list, although I&#39;ll be pleased to attach them here also if it sounds useful.

Regards,

  Helder Magalhães

[1] http://www.nabble.com/Generated-CSS-fixes%2C-mostly-table-oriented-td15950710.html#a16010772</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>4974</commentid>
            <who name="Fabian Jakobs">fabian.jakobs</who>
            <bug_when>2008-09-02 14:02:05 +0200</bug_when>
            <thetext>needs to be checked for 0.8.1</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>5298</commentid>
            <who name="Sebastian Werner">info</who>
            <bug_when>2008-09-05 19:50:13 +0200</bug_when>
            <thetext>Should be fixed in 0.8</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>38085</commentid>
            <who name="Martin Wittemann">martin.wittemann</who>
            <bug_when>2014-03-03 15:23:38 +0100</bug_when>
            <thetext>Closed all bugs already shipped with a release.</thetext>
          </long_desc>
      
          <attachment isobsolete="0" ispatch="1" isprivate="0" isurl="0">
            <attachid>281</attachid>
            <date>2008-01-16 16:14:00 +0100</date>
            <delta_ts>2008-01-16 16:14:56 +0100</delta_ts>
            <desc>Corrects bad format style string for table pane</desc>
            <filename>qxBug760.patch</filename>
            <type>text/plain</type>
            <size>41495</size>
            <attacher>hgibson</attacher>
            
              <data encoding="base64">SW5kZXg6IHFvb3hkb28vZnJvbnRlbmQvZnJhbWV3b3JrL3NvdXJjZS9jbGFzcy9xeC91aS90YWJs
ZS9wYW5lL1BhbmUuanMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBxb294ZG9vL2Zyb250ZW5kL2ZyYW1ld29y
ay9zb3VyY2UvY2xhc3MvcXgvdWkvdGFibGUvcGFuZS9QYW5lLmpzCShyZXZpc2lvbiAxMTE5NSkN
CisrKyBxb294ZG9vL2Zyb250ZW5kL2ZyYW1ld29yay9zb3VyY2UvY2xhc3MvcXgvdWkvdGFibGUv
cGFuZS9QYW5lLmpzCSh3b3JraW5nIGNvcHkpDQpAQCAtMSw3MjggKzEsNzI4IEBADQotLyogKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqCi0KLSAgIHFvb3hkb28gLSB0aGUgbmV3IGVyYSBvZiB3ZWIgZGV2ZWxvcG1l
bnQKLQotICAgaHR0cDovL3Fvb3hkb28ub3JnCi0KLSAgIENvcHlyaWdodDoKLSAgICAgMjAwNiBT
VFotSURBLCBHZXJtYW55LCBodHRwOi8vd3d3LnN0ei1pZGEuZGUKLQotICAgTGljZW5zZToKLSAg
ICAgTEdQTDogaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2xncGwuaHRtbAotICAgICBFUEw6
IGh0dHA6Ly93d3cuZWNsaXBzZS5vcmcvb3JnL2RvY3VtZW50cy9lcGwtdjEwLnBocAotICAgICBT
ZWUgdGhlIExJQ0VOU0UgZmlsZSBpbiB0aGUgcHJvamVjdCdzIHRvcC1sZXZlbCBkaXJlY3Rvcnkg
Zm9yIGRldGFpbHMuCi0KLSAgIEF1dGhvcnM6Ci0gICAgICogVGlsIFNjaG5laWRlciAodGlsMTMy
KQotICAgICAqIEZhYmlhbiBKYWtvYnMgKGZqYWtvYnMpCi0KLSoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLwot
Ci0vKiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioKLQotI21vZHVsZSh1aV90YWJsZSkKLQotKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqICovCi0KLS8qKgotICogVGhlIHRhYmxlIHBhbmUgdGhhdCBzaG93cyBhIGNlcnRhaW4gc2Vj
dGlvbiBmcm9tIGEgdGFibGUuIFRoaXMgY2xhc3MgaGFuZGxlcwotICogdGhlIGRpc3BsYXkgb2Yg
dGhlIGRhdGEgcGFydCBvZiBhIHRhYmxlIGFuZCBpcyB0aGVyZWZvcmUgdGhlIGJhc2UgZm9yIHZp
cnR1YWwKLSAqIHNjcm9sbGluZy4KLSAqLwotcXguQ2xhc3MuZGVmaW5lKCJxeC51aS50YWJsZS5w
YW5lLlBhbmUiLAotewotICBleHRlbmQgOiBxeC51aS5iYXNpYy5UZXJtaW5hdG9yLAotCi0KLQot
Ci0gIC8qCi0gICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gICAgIENPTlNUUlVDVE9SCi0gICoqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqCi0gICovCi0KLSAgLyoqCi0gICAqIEBwYXJhbSBwYW5lU2Nyb2xsZXIg
e3F4LnVpLnRhYmxlLnBhbmUuU2Nyb2xsZXJ9IHRoZSBUYWJsZVBhbmVTY3JvbGxlciB0aGUgaGVh
ZGVyIGJlbG9uZ3MgdG8uCi0gICAqLwotICBjb25zdHJ1Y3QgOiBmdW5jdGlvbihwYW5lU2Nyb2xs
ZXIpCi0gIHsKLSAgICB0aGlzLmJhc2UoYXJndW1lbnRzKTsKLQotICAgIHRoaXMuX3BhbmVTY3Jv
bGxlciA9IHBhbmVTY3JvbGxlcjsKLQotICAgIHRoaXMuX2xhc3RDb2xDb3VudCA9IDA7Ci0gICAg
dGhpcy5fbGFzdFJvd0NvdW50ID0gMDsKLSAgfSwKLQotCi0KLQotICAvKgotICAqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKgotICAgICBQUk9QRVJUSUVTCi0gICoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCi0gICov
Ci0KLSAgcHJvcGVydGllcyA6Ci0gIHsKLSAgICBhcHBlYXJhbmNlIDoKLSAgICB7Ci0gICAgICBy
ZWZpbmUgOiB0cnVlLAotICAgICAgaW5pdCA6ICJ0YWJsZS1wYW5lIgotICAgIH0sCi0KLSAgICAv
KiogVGhlIGluZGV4IG9mIHRoZSBmaXJzdCByb3cgdG8gc2hvdy4gKi8KLSAgICBmaXJzdFZpc2li
bGVSb3cgOgotICAgIHsKLSAgICAgIGNoZWNrIDogIk51bWJlciIsCi0gICAgICBpbml0IDogMCwK
LSAgICAgIGFwcGx5IDogIl9hcHBseUZpcnN0VmlzaWJsZVJvdyIKLSAgICB9LAotCi0gICAgLyoq
IFRoZSBudW1iZXIgb2Ygcm93cyB0byBzaG93LiAqLwotICAgIHZpc2libGVSb3dDb3VudCA6Ci0g
ICAgewotICAgICAgY2hlY2sgOiAiTnVtYmVyIiwKLSAgICAgIGluaXQgOiAwLAotICAgICAgYXBw
bHkgOiAiX2FwcGx5VmlzaWJsZVJvd0NvdW50IgotICAgIH0sCi0KLQotICAgIC8qKgotICAgICAq
IE1heGltdW0gbnVtYmVyIG9mIGNhY2hlZCByb3dzLiBJZiB0aGUgdmFsdWUgaXMgPGNvZGU+LTE8
L2NvZGU+IHRoZSBjYWNoZQotICAgICAqIHNpemUgaXMgdW5saW1pdGVkCi0gICAgICovCi0gICAg
bWF4Q2FjaGVMaW5lcyA6Ci0gICAgewotICAgICAgY2hlY2sgOiAiTnVtYmVyIiwKLSAgICAgIGlu
aXQgOiAxMDAwLAotICAgICAgYXBwbHkgOiAiX2FwcGx5TWF4Q2FjaGVMaW5lcyIKLSAgICB9Ci0K
LSAgfSwKLQotCi0KLQotICAvKgotICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgotICAgICBNRU1CRVJT
Ci0gICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqCi0gICovCi0KLSAgbWVtYmVycyA6Ci0gIHsKLSAgICAv
LyBwcm9wZXJ0eSBtb2RpZmllcgotICAgIF9hcHBseUZpcnN0VmlzaWJsZVJvdyA6IGZ1bmN0aW9u
KHZhbHVlLCBvbGQpIHsKLSAgICAgIHRoaXMuX3VwZGF0ZUNvbnRlbnQoZmFsc2UsIHZhbHVlLW9s
ZCk7Ci0gICAgfSwKLQotICAgIC8vIHByb3BlcnR5IG1vZGlmaWVyCi0gICAgX2FwcGx5VmlzaWJs
ZVJvd0NvdW50IDogZnVuY3Rpb24odmFsdWUsIG9sZCkgewotICAgICAgdGhpcy5fdXBkYXRlQ29u
dGVudCgpOwotICAgIH0sCi0KLQotICAgIC8vIG92ZXJyaWRkZW4KLSAgICBfYWZ0ZXJBcHBlYXIg
OiBmdW5jdGlvbigpCi0gICAgewotICAgICAgdGhpcy5iYXNlKGFyZ3VtZW50cyk7Ci0KLSAgICAg
IGlmICh0aGlzLl91cGRhdGVXYW50ZWRXaGlsZUludmlzaWJsZSkKLSAgICAgIHsKLSAgICAgICAg
Ly8gV2UgYXJlIHZpc2libGUgbm93IGFuZCBhbiB1cGRhdGUgd2FzIHdhbnRlZCB3aGlsZSB3ZSB3
ZXJlIGludmlzaWJsZQotICAgICAgICAvLyAtPiBEbyB0aGUgdXBkYXRlIG5vdwotICAgICAgICB0
aGlzLl91cGRhdGVDb250ZW50KCk7Ci0gICAgICAgIHRoaXMuX3VwZGF0ZVdhbnRlZFdoaWxlSW52
aXNpYmxlID0gZmFsc2U7Ci0gICAgICB9Ci0gICAgfSwKLQotCi0gICAgLyoqCi0gICAgICogUmV0
dXJucyB0aGUgVGFibGVQYW5lU2Nyb2xsZXIgdGhpcyBwYW5lIGJlbG9uZ3MgdG8uCi0gICAgICoK
LSAgICAgKiBAdHlwZSBtZW1iZXIKLSAgICAgKiBAcmV0dXJuIHtxeC51aS50YWJsZS5wYW5lLlNj
cm9sbGVyfSB0aGUgVGFibGVQYW5lU2Nyb2xsZXIuCi0gICAgICovCi0gICAgZ2V0UGFuZVNjcm9s
bGVyIDogZnVuY3Rpb24oKSB7Ci0gICAgICByZXR1cm4gdGhpcy5fcGFuZVNjcm9sbGVyOwotICAg
IH0sCi0KLQotICAgIC8qKgotICAgICAqIFJldHVybnMgdGhlIHRhYmxlIHRoaXMgcGFuZSBiZWxv
bmdzIHRvLgotICAgICAqCi0gICAgICogQHR5cGUgbWVtYmVyCi0gICAgICogQHJldHVybiB7cXgu
dWkudGFibGUuVGFibGV9IHRoZSB0YWJsZS4KLSAgICAgKi8KLSAgICBnZXRUYWJsZSA6IGZ1bmN0
aW9uKCkgewotICAgICAgcmV0dXJuIHRoaXMuX3BhbmVTY3JvbGxlci5nZXRUYWJsZSgpOwotICAg
IH0sCi0KLQotICAgIC8qKgotICAgICAqIFNldHMgdGhlIGN1cnJlbnRseSBmb2N1c2VkIGNlbGwu
Ci0gICAgICoKLSAgICAgKiBAdHlwZSBtZW1iZXIKLSAgICAgKiBAcGFyYW0gY29sIHtJbnRlZ2Vy
fSB0aGUgbW9kZWwgaW5kZXggb2YgdGhlIGZvY3VzZWQgY2VsbCdzIGNvbHVtbi4KLSAgICAgKiBA
cGFyYW0gcm93IHtJbnRlZ2VyfSB0aGUgbW9kZWwgaW5kZXggb2YgdGhlIGZvY3VzZWQgY2VsbCdz
IHJvdy4KLSAgICAgKiBAcGFyYW0gbWFzc1VwZGF0ZSB7Qm9vbGVhbiA/IGZhbHNlfSBXaGV0aGVy
IG90aGVyIHVwZGF0ZXMgYXJlIHBsYW5uZWQgYXMgd2VsbC4KLSAgICAgKiAgICAgICAgICBJZiB0
cnVlLCBubyByZXBhaW50IHdpbGwgYmUgZG9uZS4KLSAgICAgKiBAcmV0dXJuIHt2b2lkfQotICAg
ICAqLwotICAgIHNldEZvY3VzZWRDZWxsIDogZnVuY3Rpb24oY29sLCByb3csIG1hc3NVcGRhdGUp
Ci0gICAgewotICAgICAgaWYgKGNvbCAhPSB0aGlzLl9mb2N1c2VkQ29sIHx8IHJvdyAhPSB0aGlz
Ll9mb2N1c2VkUm93KQotICAgICAgewotICAgICAgICB2YXIgb2xkUm93ID0gdGhpcy5fZm9jdXNl
ZFJvdzsKLSAgICAgICAgdGhpcy5fZm9jdXNlZENvbCA9IGNvbDsKLSAgICAgICAgdGhpcy5fZm9j
dXNlZFJvdyA9IHJvdzsKLQotICAgICAgICAvLyBVcGRhdGUgdGhlIGZvY3VzZWQgcm93IGJhY2tn
cm91bmQKLSAgICAgICAgaWYgKHJvdyAhPSBvbGRSb3cgJiYgIW1hc3NVcGRhdGUpCi0gICAgICAg
IHsKLSAgICAgICAgICAvLyBOT1RFOiBPbmx5IHRoZSBvbGQgYW5kIHRoZSBuZXcgcm93IG5lZWQg
dXBkYXRlCi0gICAgICAgICAgdGhpcy5fdXBkYXRlQ29udGVudChmYWxzZSwgbnVsbCwgb2xkUm93
LCB0cnVlKTsKLSAgICAgICAgICB0aGlzLl91cGRhdGVDb250ZW50KGZhbHNlLCBudWxsLCByb3cs
IHRydWUpOwotICAgICAgICB9Ci0gICAgICB9Ci0gICAgfSwKLQotCi0gICAgLyoqCi0gICAgICog
RXZlbnQgaGFuZGxlci4gQ2FsbGVkIHdoZW4gdGhlIHNlbGVjdGlvbiBoYXMgY2hhbmdlZC4KLSAg
ICAgKgotICAgICAqIEB0eXBlIG1lbWJlcgotICAgICAqIEBwYXJhbSBldnQge01hcH0gdGhlIGV2
ZW50LgotICAgICAqIEByZXR1cm4ge3ZvaWR9Ci0gICAgICovCi0gICAgX29uU2VsZWN0aW9uQ2hh
bmdlZCA6IGZ1bmN0aW9uKGV2dCkgewotICAgICAgdGhpcy5fdXBkYXRlQ29udGVudChmYWxzZSwg
bnVsbCwgbnVsbCwgdHJ1ZSk7Ci0gICAgfSwKLQotCi0gICAgLyoqCi0gICAgICogRXZlbnQgaGFu
ZGxlci4gQ2FsbGVkIHdoZW4gdGhlIHRhYmxlIGdldHMgb3IgbG9vc2VzIHRoZSBmb2N1cy4KLSAg
ICAgKgotICAgICAqIEB0eXBlIG1lbWJlcgotICAgICAqIEBwYXJhbSBldnQge01hcH0gdGhlIGV2
ZW50LgotICAgICAqIEByZXR1cm4ge3ZvaWR9Ci0gICAgICovCi0gICAgX29uRm9jdXNDaGFuZ2Vk
IDogZnVuY3Rpb24oZXZ0KSB7Ci0gICAgICB0aGlzLl91cGRhdGVDb250ZW50KGZhbHNlLCBudWxs
LCBudWxsLCB0cnVlKTsKLSAgICB9LAotCi0KLSAgICAvKioKLSAgICAgKiBFdmVudCBoYW5kbGVy
LiBDYWxsZWQgd2hlbiB0aGUgd2lkdGggb2YgYSBjb2x1bW4gaGFzIGNoYW5nZWQuCi0gICAgICoK
LSAgICAgKiBAdHlwZSBtZW1iZXIKLSAgICAgKiBAcGFyYW0gZXZ0IHtNYXB9IHRoZSBldmVudC4K
LSAgICAgKiBAcmV0dXJuIHt2b2lkfQotICAgICAqLwotICAgIF9vbkNvbFdpZHRoQ2hhbmdlZCA6
IGZ1bmN0aW9uKGV2dCkgewotICAgICAgdGhpcy5fdXBkYXRlQ29udGVudCh0cnVlKTsKLSAgICB9
LAotCi0KLSAgICAvKioKLSAgICAgKiBFdmVudCBoYW5kbGVyLiBDYWxsZWQgdGhlIGNvbHVtbiBv
cmRlciBoYXMgY2hhbmdlZC4KLSAgICAgKgotICAgICAqIEB0eXBlIG1lbWJlcgotICAgICAqIEBw
YXJhbSBldnQge01hcH0gdGhlIGV2ZW50LgotICAgICAqIEByZXR1cm4ge3ZvaWR9Ci0gICAgICov
Ci0gICAgX29uQ29sT3JkZXJDaGFuZ2VkIDogZnVuY3Rpb24oZXZ0KSB7Ci0gICAgICB0aGlzLl91
cGRhdGVDb250ZW50KHRydWUpOwotICAgIH0sCi0KLQotICAgIC8qKgotICAgICAqIEV2ZW50IGhh
bmRsZXIuIENhbGxlZCB3aGVuIHRoZSBwYW5lIG1vZGVsIGhhcyBjaGFuZ2VkLgotICAgICAqCi0g
ICAgICogQHR5cGUgbWVtYmVyCi0gICAgICogQHBhcmFtIGV2dCB7TWFwfSB0aGUgZXZlbnQuCi0g
ICAgICogQHJldHVybiB7dm9pZH0KLSAgICAgKi8KLSAgICBfb25QYW5lTW9kZWxDaGFuZ2VkIDog
ZnVuY3Rpb24oZXZ0KSB7Ci0gICAgICB0aGlzLl91cGRhdGVDb250ZW50KHRydWUpOwotICAgIH0s
Ci0KLQotICAgIC8qKgotICAgICAqIEV2ZW50IGhhbmRsZXIuIENhbGxlZCB3aGVuIHRoZSB0YWJs
ZSBtb2RlbCBkYXRhIGhhcyBjaGFuZ2VkLgotICAgICAqCi0gICAgICogQHR5cGUgbWVtYmVyCi0g
ICAgICogQHBhcmFtIGV2dCB7TWFwfSB0aGUgZXZlbnQuCi0gICAgICogQHJldHVybiB7dm9pZH0K
LSAgICAgKi8KLSAgICBfb25UYWJsZU1vZGVsRGF0YUNoYW5nZWQgOiBmdW5jdGlvbihldnQpCi0g
ICAgewotICAgICAgdmFyIGRhdGEgPSBldnQuZ2V0RGF0YSA/IGV2dC5nZXREYXRhKCkgOiBudWxs
OwotICAgICAgdGhpcy5fX3Jvd0NhY2hlQ2xlYXIoKTsKLQotICAgICAgdmFyIGZpcnN0Um93ID0g
dGhpcy5nZXRGaXJzdFZpc2libGVSb3coKTsKLSAgICAgIHZhciByb3dDb3VudCA9IHRoaXMuZ2V0
VmlzaWJsZVJvd0NvdW50KCk7Ci0KLSAgICAgIGlmIChkYXRhID09IG51bGwgfHwgZGF0YS5sYXN0
Um93ID09IC0xIHx8IGRhdGEubGFzdFJvdyA+PSBmaXJzdFJvdyAmJiBkYXRhLmZpcnN0Um93IDwg
Zmlyc3RSb3cgKyByb3dDb3VudCkKLSAgICAgIHsKLSAgICAgICAgLy8gVGhlIGNoYW5nZSBpbnRl
cnNlY3RzIHRoaXMgcGFuZQotICAgICAgICB0aGlzLl91cGRhdGVDb250ZW50KCk7Ci0gICAgICB9
Ci0gICAgfSwKLQotCi0gICAgLyoqCi0gICAgICogRXZlbnQgaGFuZGxlci4gQ2FsbGVkIHdoZW4g
dGhlIHRhYmxlIG1vZGVsIG1ldGEgZGF0YSBoYXMgY2hhbmdlZC4KLSAgICAgKgotICAgICAqIEB0
eXBlIG1lbWJlcgotICAgICAqIEBwYXJhbSBldnQge01hcH0gdGhlIGV2ZW50LgotICAgICAqIEBy
ZXR1cm4ge3ZvaWR9Ci0gICAgICovCi0gICAgX29uVGFibGVNb2RlbE1ldGFEYXRhQ2hhbmdlZCA6
IGZ1bmN0aW9uKGV2dCkgewotICAgICAgdGhpcy5fdXBkYXRlQ29udGVudCh0cnVlKTsKLSAgICB9
LAotCi0KLSAgICAvLyBzcGFyc2UgYXJyYXkgdG8gY2FjaGUgcmVuZGVyZWQgcm93cwotICAgIF9f
cm93Q2FjaGUgOiBbXSwKLSAgICBfX3Jvd0NhY2hlQ291bnQgOiAwLAotCi0KLSAgICAvLyBwcm9w
ZXJ0eSBhcHBseSBtZXRob2QKLSAgICBfYXBwbHlNYXhDYWNoZUxpbmVzIDogZnVuY3Rpb24odmFs
dWUsIG9sZCkKLSAgICB7Ci0gICAgICBpZiAodGhpcy5fX3Jvd0NhY2hlQ291bnQgPj0gdmFsdWUg
JiYgdmFsdWUgIT09IC0xKSB7Ci0gICAgICAgIHRoaXMuX19yb3dDYWNoZUNsZWFyKCk7Ci0gICAg
ICB9Ci0gICAgfSwKLQotCi0gICAgLyoqCi0gICAgICogQ2xlYXIgdGhlIHJvdyBjYWNoZQotICAg
ICAqLwotICAgIF9fcm93Q2FjaGVDbGVhciA6IGZ1bmN0aW9uKCkgewotICAgICAgdGhpcy5fX3Jv
d0NhY2hlID0gW107Ci0gICAgICB0aGlzLl9fcm93Q2FjaGVDb3VudCA9IDA7Ci0gICAgfSwKLQot
Ci0gICAgLyoqCi0gICAgICogR2V0IGEgbGluZSBmcm9tIHRoZSByb3cgY2FjaGUuCi0gICAgICoK
LSAgICAgKiBAcGFyYW0gcm93IHtJbnRlZ2VyfSBSb3cgaW5kZXggdG8gZ2V0Ci0gICAgICogQHBh
cmFtIHNlbGVjdGVkIHtCb29sZWFufSBXaGV0aGVyIHRoZSByb3cgaXMgY3VycmVudGx5IHNlbGVj
dGVkCi0gICAgICogQHBhcmFtIGZvY3VzZWQge0Jvb2xlYW59IFdoZXRoZXIgdGhlIHJvdyBpcyBj
dXJyZW50bHkgZm9jdXNlZAotICAgICAqIEByZXR1cm4ge1N0cmluZ3xudWxsfSBUaGUgY2FjaGVk
IHJvdyBvciBudWxsIGlmIGEgcm93IHdpdGggdGhlIGdpdmVuCi0gICAgICogICAgIGluZGV4IGlz
IG5vdCBjYWNoZWQuCi0gICAgICovCi0gICAgX19yb3dDYWNoZUdldCA6IGZ1bmN0aW9uKHJvdywg
c2VsZWN0ZWQsIGZvY3VzZWQpCi0gICAgewotICAgICAgaWYgKCFzZWxlY3RlZCAmJiAhZm9jdXNl
ZCAmJiB0aGlzLl9fcm93Q2FjaGVbcm93XSkgewotICAgICAgICByZXR1cm4gdGhpcy5fX3Jvd0Nh
Y2hlW3Jvd107Ci0gICAgICB9IGVsc2UgewotICAgICAgICByZXR1cm4gbnVsbDsKLSAgICAgIH0K
LSAgICB9LAotCi0KLSAgICAvKioKLSAgICAgKiBBZGQgYSBsaW5lIHRvIHRoZSByb3cgY2FjaGUu
Ci0gICAgICoKLSAgICAgKiBAcGFyYW0gcm93IHtJbnRlZ2VyfSBSb3cgaW5kZXggdG8gc2V0Ci0g
ICAgICogQHBhcmFtIHJvd1N0cmluZyB7U3RyaW5nfSBjb21wdXRlZCByb3cgc3RyaW5nIHRvIGNh
Y2hlCi0gICAgICogQHBhcmFtIHNlbGVjdGVkIHtCb29sZWFufSBXaGV0aGVyIHRoZSByb3cgaXMg
Y3VycmVudGx5IHNlbGVjdGVkCi0gICAgICogQHBhcmFtIGZvY3VzZWQge0Jvb2xlYW59IFdoZXRo
ZXIgdGhlIHJvdyBpcyBjdXJyZW50bHkgZm9jdXNlZAotICAgICAqLwotICAgIF9fcm93Q2FjaGVT
ZXQgOiBmdW5jdGlvbihyb3csIHJvd1N0cmluZywgc2VsZWN0ZWQsIGZvY3VzZWQpCi0gICAgewot
ICAgICAgaWYgKCFzZWxlY3RlZCAmJiAhZm9jdXNlZCAmJiAhdGhpcy5fX3Jvd0NhY2hlW3Jvd10p
IHsKLSAgICAgICAgdGhpcy5fYXBwbHlNYXhDYWNoZUxpbmVzKHRoaXMuZ2V0TWF4Q2FjaGVMaW5l
cygpKTsKLSAgICAgICAgdGhpcy5fX3Jvd0NhY2hlW3Jvd10gPSByb3dTdHJpbmc7Ci0gICAgICAg
IHRoaXMuX19yb3dDYWNoZUNvdW50ICs9IDE7Ci0gICAgICB9Ci0gICAgfSwKLQotCi0gICAgLyoq
Ci0gICAgICogVXBkYXRlcyB0aGUgY29udGVudCBvZiB0aGUgcGFuZS4KLSAgICAgKgotICAgICAq
IEB0eXBlIG1lbWJlcgotICAgICAqIEBwYXJhbSBjb21wbGV0ZVVwZGF0ZSB7Qm9vbGVhbiA/IGZh
bHNlfSBpZiB0cnVlIGEgY29tcGxldGUgdXBkYXRlIGlzIHBlcmZvcm1lZC4KLSAgICAgKiAgICAg
IE9uIGEgY29tcGxldGUgdXBkYXRlIGFsbCBjZWxsIHdpZGdldHMgYXJlIHJlY3JlYXRlZC4KLSAg
ICAgKiBAcGFyYW0gc2Nyb2xsT2Zmc2V0IHtJbnRlZ2VyID8gbnVsbH0gSWYgc2V0IHNwZWNpZmll
cyBob3cgbWFueSByb3dzIHRvIHNjcm9sbC4KLSAgICAgKiBAcGFyYW0gb25seVJvdyB7SW50ZWdl
ciA/IG51bGx9IGlmIHNldCBvbmx5IHRoZSBzcGVjaWZpZWQgcm93IHdpbGwgYmUgdXBkYXRlZC4K
LSAgICAgKiBAcGFyYW0gb25seVNlbGVjdGlvbk9yRm9jdXNDaGFuZ2VkIHtCb29sZWFuID8gZmFs
c2V9IGlmIHRydWUsIGNlbGwgdmFsdWVzIHdvbid0Ci0gICAgICogICAgICAgICAgYmUgdXBkYXRl
ZC4gT25seSB0aGUgcm93IGJhY2tncm91bmQgd2lsbC4KLSAgICAgKiBAcmV0dXJuIHt2b2lkfQot
ICAgICAqLwotICAgIF91cGRhdGVDb250ZW50IDogZnVuY3Rpb24oY29tcGxldGVVcGRhdGUsIHNj
cm9sbE9mZnNldCwgb25seVJvdywgb25seVNlbGVjdGlvbk9yRm9jdXNDaGFuZ2VkKQotICAgIHsK
LSAgICAgIGlmIChjb21wbGV0ZVVwZGF0ZSkgewotICAgICAgICB0aGlzLl9fcm93Q2FjaGVDbGVh
cigpOwotICAgICAgfQotCi0gICAgICBpZiAoIXRoaXMuaXNTZWVhYmxlKCkpCi0gICAgICB7Ci0g
ICAgICAgIHRoaXMuX3VwZGF0ZVdhbnRlZFdoaWxlSW52aXNpYmxlID0gdHJ1ZTsKLSAgICAgICAg
cmV0dXJuOwotICAgICAgfQotCi0gICAgICBpZiAodGhpcy5fbGF5b3V0UGVuZGluZykKLSAgICAg
IHsKLSAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLl9sYXlvdXRQZW5kaW5nKTsKLSAg
ICAgICAgdGhpcy5fdXBkYXRlQWxsUm93cygpOwotICAgICAgICByZXR1cm47Ci0gICAgICB9Ci0K
LSAgICAgIC8vdmFyIHN0YXJ0ID0gbmV3IERhdGUoKTsKLQotICAgICAgaWYgKHNjcm9sbE9mZnNl
dCAmJiBNYXRoLmFicyhzY3JvbGxPZmZzZXQpIDw9IE1hdGgubWluKDEwLCB0aGlzLmdldFZpc2li
bGVSb3dDb3VudCgpKSkKLSAgICAgIHsKLSAgICAgICAgLy90aGlzLmRlYnVnKCJzY3JvbGwiLCBz
Y3JvbGxPZmZzZXQpOwotICAgICAgICB0aGlzLl9zY3JvbGxDb250ZW50KHNjcm9sbE9mZnNldCk7
Ci0gICAgICB9Ci0gICAgICBlbHNlIGlmIChvbmx5U2VsZWN0aW9uT3JGb2N1c0NoYW5nZWQgJiYg
IXRoaXMuZ2V0VGFibGUoKS5nZXRBbHdheXNVcGRhdGVDZWxscygpKQotICAgICAgewotICAgICAg
ICAvL3RoaXMuZGVidWcoInVwZGF0ZSByb3cgc3R5bGVzIik7Ci0gICAgICAgIHRoaXMuX3VwZGF0
ZVJvd1N0eWxlcyhvbmx5Um93KTsKLSAgICAgIH0KLSAgICAgIGVsc2UKLSAgICAgIHsKLSAgICAg
ICAgLy90aGlzLmRlYnVnKCJmdWxsIHVwZGF0ZSIpOwotICAgICAgICB0aGlzLl91cGRhdGVBbGxS
b3dzKCk7Ci0gICAgICB9Ci0KLSAgICAgIC8vdGhpcy5kZWJ1ZygicmVuZGVyIHRpbWU6ICIgKyAo
bmV3IERhdGUoKSAtIHN0YXJ0KSArICJtcyIpOwotICAgIH0sCi0KLQotICAgIC8qKgotICAgICAq
IElmIG9ubHkgZm9jdXMgb3Igc2VsZWN0aW9uIGNoYW5nZXMgaXQgaXMgc3VmZmljaWVudCB0byBv
bmx5IHVwZGF0ZSB0aGUKLSAgICAgKiByb3cgc3R5bGVzLiBUaGlzIG1ldGhvZCB1cGRhdGVzIHRo
ZSByb3cgc3R5bGVzIG9mIGFsbCB2aXNpYmxlIHJvd3Mgb3IKLSAgICAgKiBvZiBqdXN0IG9uZSBy
b3cuCi0gICAgICoKLSAgICAgKiBAcGFyYW0gb25seVJvdyB7SW50ZWdlcnxudWxsID8gbnVsbH0g
SWYgdGhpcyBwYXJhbWV0ZXIgaXMgc2V0IG9ubHkgdGhlIHJvdwotICAgICAqICAgICB3aXRoIHRo
aXMgaW5kZXggaXMgdXBkYXRlZC4KLSAgICAgKi8KLSAgICBfdXBkYXRlUm93U3R5bGVzIDogZnVu
Y3Rpb24ob25seVJvdykKLSAgICB7Ci0gICAgICB2YXIgZWxlbSA9IHRoaXMuZ2V0RWxlbWVudCgp
OwotICAgICAgaWYgKCFlbGVtLmZpcnN0Q2hpbGQpIHsKLSAgICAgICAgdGhpcy5fdXBkYXRlQWxs
Um93cygpOwotICAgICAgICByZXR1cm47Ci0gICAgICB9Ci0KLSAgICAgIHZhciB0YWJsZSA9IHRo
aXMuZ2V0VGFibGUoKTsKLSAgICAgIHZhciBzZWxlY3Rpb25Nb2RlbCA9IHRhYmxlLmdldFNlbGVj
dGlvbk1vZGVsKCk7Ci0gICAgICB2YXIgdGFibGVNb2RlbCA9IHRhYmxlLmdldFRhYmxlTW9kZWwo
KTsKLSAgICAgIHZhciByb3dSZW5kZXJlciA9IHRhYmxlLmdldERhdGFSb3dSZW5kZXJlcigpOwot
ICAgICAgdmFyIHJvd05vZGVzID0gZWxlbS5maXJzdENoaWxkLmNoaWxkTm9kZXM7Ci0gICAgICB2
YXIgY2VsbEluZm8gPSB7IHRhYmxlIDogdGFibGUgfTsKLQotICAgICAgLy8gV2UgZG9uJ3Qgd2Fu
dCB0byBleGVjdXRlIHRoZSByb3cgbG9vcCBiZWxvdyBtb3JlIHRoYW4gbmVjZXNzYXJ5LiBJZgot
ICAgICAgLy8gb25seXJvdyBpcyBub3QgbnVsbCwgd2Ugd2FudCB0byBkbyB0aGUgbG9vcCBvbmx5
IGZvciB0aGF0IHJvdy4KLSAgICAgIC8vIEluIHRoYXQgY2FzZSwgd2FzIHN0YXJ0IGF0IChzZXQg
dGhlICJyb3ciIHZhcmlhYmxlIHRvKSB0aGF0IHJvdywgYW5kCi0gICAgICAvLyBzdG9wIGF0IChz
ZXQgdGhlICJlbmQiIHZhcmlhYmxlIHRvIHRoZSBvZmZzZXQgb2YpIHRoZSBuZXh0IHJvdzsgLgot
ICAgICAgdmFyIHJvdyA9IHRoaXMuZ2V0Rmlyc3RWaXNpYmxlUm93KCk7Ci0gICAgICB2YXIgeSA9
IDA7Ci0KLSAgICAgIC8vIEhvdyBtYW55IHJvd3MgZG8gd2UgbmVlZCB0byB1cGRhdGU/Ci0gICAg
ICB2YXIgZW5kID0gcm93Tm9kZXMubGVuZ3RoOwotCi0gICAgICBpZiAob25seVJvdyAhPSBudWxs
KQotICAgICAgewotICAgICAgICAvLyBIb3cgbWFueSByb3dzIGFyZSB3ZSBza2lwcGluZz8KLSAg
ICAgICAgdmFyIG9mZnNldCA9IG9ubHlSb3cgLSByb3c7Ci0gICAgICAgIGlmIChvZmZzZXQgPj0g
MCAmJiBvZmZzZXQgPCBlbmQpCi0gICAgICAgIHsKLSAgICAgICAgICByb3cgPSBvbmx5Um93Owot
ICAgICAgICAgIHkgPSBvZmZzZXQ7Ci0gICAgICAgICAgZW5kID0gb2Zmc2V0ICsgMTsKLSAgICAg
ICAgfQotICAgICAgICBlbHNlCi0gICAgICAgICAgcmV0dXJuOwotICAgICAgfQotCi0gICAgICBm
b3IgKDsgeTxlbmQ7IHkrKywgcm93KyspCi0gICAgICB7Ci0gICAgICAgIGNlbGxJbmZvLnJvdyA9
IHJvdzsKLSAgICAgICAgY2VsbEluZm8uc2VsZWN0ZWQgPSBzZWxlY3Rpb25Nb2RlbC5pc1NlbGVj
dGVkSW5kZXgocm93KTsKLSAgICAgICAgY2VsbEluZm8uZm9jdXNlZFJvdyA9ICh0aGlzLl9mb2N1
c2VkUm93ID09IHJvdyk7Ci0gICAgICAgIGNlbGxJbmZvLnJvd0RhdGEgPSB0YWJsZU1vZGVsLmdl
dFJvd0RhdGEocm93KTsKLQotICAgICAgICByb3dSZW5kZXJlci51cGRhdGVEYXRhUm93RWxlbWVu
dChjZWxsSW5mbywgcm93Tm9kZXNbeV0pOwotICAgICAgfTsKLSAgICB9LAotCi0KLSAgICAvKioK
LSAgICAgKiBHZXQgdGhlIEhUTUwgdGFibGUgZnJhZ21lbnQgZm9yIHRoZSBnaXZlbiByb3cgcmFu
Z2UuCi0gICAgICoKLSAgICAgKiBAcGFyYW0gZmlyc3RSb3cge0ludGVnZXJ9IEluZGV4IG9mIHRo
ZSBmaXJzdCByb3cKLSAgICAgKiBAcGFyYW0gcm93Q291bnQge0ludGVnZXJ9IE51bWJlciBvZiBy
b3dzCi0gICAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgSFRNTCB0YWJsZSBmcmFnbWVudCBmb3Ig
dGhlIGdpdmVuIHJvdyByYW5nZS4KLSAgICAgKi8KLSAgICBfZ2V0Um93c0h0bWwgOiBmdW5jdGlv
bihmaXJzdFJvdywgcm93Q291bnQpCi0gICAgewotICAgICAgdmFyIHRhYmxlID0gdGhpcy5nZXRU
YWJsZSgpOwotCi0gICAgICB2YXIgc2VsZWN0aW9uTW9kZWwgPSB0YWJsZS5nZXRTZWxlY3Rpb25N
b2RlbCgpOwotICAgICAgdmFyIHRhYmxlTW9kZWwgPSB0YWJsZS5nZXRUYWJsZU1vZGVsKCk7Ci0g
ICAgICB2YXIgY29sdW1uTW9kZWwgPSB0YWJsZS5nZXRUYWJsZUNvbHVtbk1vZGVsKCk7Ci0gICAg
ICB2YXIgcGFuZU1vZGVsID0gdGhpcy5nZXRQYW5lU2Nyb2xsZXIoKS5nZXRUYWJsZVBhbmVNb2Rl
bCgpOwotICAgICAgdmFyIHJvd1JlbmRlcmVyID0gdGFibGUuZ2V0RGF0YVJvd1JlbmRlcmVyKCk7
Ci0KLSAgICAgIHRhYmxlTW9kZWwucHJlZmV0Y2hSb3dzKGZpcnN0Um93LCBmaXJzdFJvdyArIHJv
d0NvdW50IC0gMSk7Ci0KLSAgICAgIHZhciByb3dIZWlnaHQgPSB0YWJsZS5nZXRSb3dIZWlnaHQo
KTsKLSAgICAgIHZhciBjb2xDb3VudCA9IHBhbmVNb2RlbC5nZXRDb2x1bW5Db3VudCgpOwotICAg
ICAgdmFyIGxlZnQgPSAwOwotICAgICAgdmFyIGNvbHMgPSBbXTsKLQotICAgICAgLy8gcHJlY29t
cHV0ZSBjb2x1bW4gcHJvcGVydGllcwotICAgICAgZm9yICh2YXIgeD0wOyB4PGNvbENvdW50OyB4
KyspCi0gICAgICB7Ci0gICAgICAgIHZhciBjb2wgPSBwYW5lTW9kZWwuZ2V0Q29sdW1uQXRYKHgp
OwotICAgICAgICB2YXIgY2VsbFdpZHRoID0gY29sdW1uTW9kZWwuZ2V0Q29sdW1uV2lkdGgoY29s
KTsKLSAgICAgICAgY29scy5wdXNoKHsKLSAgICAgICAgICBjb2w6IGNvbCwKLSAgICAgICAgICB4
UG9zOiB4LAotICAgICAgICAgIGVkaXRhYmxlOiB0YWJsZU1vZGVsLmlzQ29sdW1uRWRpdGFibGUo
Y29sKSwKLSAgICAgICAgICBmb2N1c2VkQ29sOiB0aGlzLl9mb2N1c2VkQ29sID09IGNvbCwKLSAg
ICAgICAgICBzdHlsZUxlZnQ6IGxlZnQsCi0gICAgICAgICAgc3R5bGVXaWR0aDogY2VsbFdpZHRo
Ci0gICAgICAgIH0pOwotCi0gICAgICAgIGxlZnQgKz0gY2VsbFdpZHRoOwotICAgICAgfQotCi0g
ICAgICB2YXIgcm93c0FyciA9IFtdOwotICAgICAgZm9yICh2YXIgcm93PWZpcnN0Um93OyByb3cg
PCBmaXJzdFJvdyArIHJvd0NvdW50OyByb3crKykKLSAgICAgIHsKLSAgICAgICAgdmFyIHNlbGVj
dGVkID0gc2VsZWN0aW9uTW9kZWwuaXNTZWxlY3RlZEluZGV4KHJvdyk7Ci0gICAgICAgIHZhciBm
b2N1c2VkUm93ID0gKHRoaXMuX2ZvY3VzZWRSb3cgPT0gcm93KTsKLQotICAgICAgICB2YXIgY2Fj
aGVkUm93ID0gdGhpcy5fX3Jvd0NhY2hlR2V0KHJvdywgc2VsZWN0ZWQsIGZvY3VzZWRSb3cpOwot
ICAgICAgICBpZiAoY2FjaGVkUm93KSB7Ci0gICAgICAgICAgcm93c0Fyci5wdXNoKGNhY2hlZFJv
dyk7Ci0gICAgICAgICAgY29udGludWU7Ci0gICAgICAgIH0KLQotICAgICAgICB2YXIgcm93SHRt
bCA9IFtdOwotCi0gICAgICAgIHZhciBjZWxsSW5mbyA9IHsgdGFibGUgOiB0YWJsZSB9OwotICAg
ICAgICBjZWxsSW5mby5zdHlsZUhlaWdodCA9IHJvd0hlaWdodDsKLQotICAgICAgICBjZWxsSW5m
by5yb3cgPSByb3c7Ci0gICAgICAgIGNlbGxJbmZvLnNlbGVjdGVkID0gc2VsZWN0ZWQ7Ci0gICAg
ICAgIGNlbGxJbmZvLmZvY3VzZWRSb3cgPSBmb2N1c2VkUm93OwotICAgICAgICBjZWxsSW5mby5y
b3dEYXRhID0gdGFibGVNb2RlbC5nZXRSb3dEYXRhKHJvdyk7Ci0KLSAgICAgICAgcm93SHRtbC5w
dXNoKCc8ZGl2ICcpOwotCi0gICAgICAgIHZhciByb3dDbGFzcyA9IHJvd1JlbmRlcmVyLmdldFJv
d0NsYXNzKGNlbGxJbmZvKTsKLSAgICAgICAgaWYgKHJvd0NsYXNzKSB7Ci0gICAgICAgICAgcm93
SHRtbC5wdXNoKCdjbGFzcz0iJywgcm93Q2xhc3MsICciICcpOwotICAgICAgICB9Ci0KLSAgICAg
ICAgdmFyIHJvd1N0eWxlID0gcm93UmVuZGVyZXIuY3JlYXRlUm93U3R5bGUoY2VsbEluZm8pOwot
ICAgICAgICByb3dTdHlsZSArPSAiO3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDoiICsgcm93SGVp
Z2h0ICsgInB4OyB3aWR0aDoiICsgcGFuZU1vZGVsLmdldFRvdGFsV2lkdGgoKSArICJweDsiOwot
ICAgICAgICBpZiAocm93U3R5bGUpIHsKLSAgICAgICAgICByb3dIdG1sLnB1c2goJ3N0eWxlPSIn
LCByb3dTdHlsZSwgJyIgJyk7Ci0gICAgICAgIH0KLSAgICAgICAgcm93SHRtbC5wdXNoKCc+Jyk7
Ci0KLSAgICAgICAgZm9yICh2YXIgeD0wOyB4PGNvbENvdW50OyB4KyspCi0gICAgICAgIHsKLSAg
ICAgICAgICB2YXIgY29sX2RlZiA9IGNvbHNbeF07Ci0gICAgICAgICAgZm9yICh2YXIgYXR0ciBp
biBjb2xfZGVmKSB7Ci0gICAgICAgICAgICBjZWxsSW5mb1thdHRyXSA9IGNvbF9kZWZbYXR0cl07
Ci0gICAgICAgICAgfQotICAgICAgICAgIHZhciBjb2wgPSBjZWxsSW5mby5jb2w7Ci0KLSAgICAg
ICAgICAvLyBBQjogdXNlIHRoZSAiZ2V0VmFsdWUiIG1ldGhvZCBvZiB0aGUgdGFibGVNb2RlbCB0
byBnZXQgdGhlIGNlbGwncyB2YWx1ZQotICAgICAgICAgIC8vIHdvcmtpbmcgZGlyZWN0bHkgb24g
dGhlICJyb3dEYXRhIiBvYmplY3QgKC0+IGNlbGxJbmZvLnJvd0RhdGFbY29sXTspIGlzIG5vdCBh
IHNvbHV0aW9uCi0gICAgICAgICAgLy8gYmVjYXVzZSB5b3UgY2FuJ3Qgd29yayB3aXRoIHRoZSBj
b2x1bW5JbmRleCAtPiB5b3UgaGF2ZSB0byB1c2UgdGhlIGNvbHVtbklkIG9mIHRoZSBjb2x1bW5J
bmRleAotICAgICAgICAgIC8vIFRoaXMgaXMgZXhhY3RseSB3aGF0IHRoZSBtZXRob2QgImdldFZh
bHVlIiBkb2VzCi0gICAgICAgICAgY2VsbEluZm8udmFsdWUgPSB0YWJsZU1vZGVsLmdldFZhbHVl
KGNvbCwgcm93KTsKLSAgICAgICAgICB2YXIgY2VsbFJlbmRlcmVyID0gY29sdW1uTW9kZWwuZ2V0
RGF0YUNlbGxSZW5kZXJlcihjb2wpOwotICAgICAgICAgIGNlbGxSZW5kZXJlci5jcmVhdGVEYXRh
Q2VsbEh0bWwoY2VsbEluZm8sIHJvd0h0bWwpOwotICAgICAgICB9Ci0gICAgICAgIHJvd0h0bWwu
cHVzaCgnPC9kaXY+Jyk7Ci0KLSAgICAgICAgdmFyIHJvd1N0cmluZyA9IHJvd0h0bWwuam9pbigi
Iik7Ci0KLSAgICAgICAgdGhpcy5fX3Jvd0NhY2hlU2V0KHJvdywgcm93U3RyaW5nLCBzZWxlY3Rl
ZCwgZm9jdXNlZFJvdyk7Ci0gICAgICAgIHJvd3NBcnIucHVzaChyb3dTdHJpbmcpOwotICAgICAg
fQotICAgICAgcmV0dXJuIHJvd3NBcnIuam9pbigiIik7Ci0gICAgfSwKLQotCi0gICAgLyoqCi0g
ICAgICogU2Nyb2xscyB0aGUgcGFuZSdzIGNvbnRlbnRzIGJ5IHRoZSBnaXZlbiBvZmZzZXQuCi0g
ICAgICoKLSAgICAgKiBAcGFyYW0gcm93T2Zmc2V0IHtJbnRlZ2VyfSBOdW1iZXIgb2YgbGluZXMg
dG8gc2Nyb2xsLiBTY3JvbGxpbmcgdXAgaXMKLSAgICAgKiAgICAgcmVwcmVzZW50ZWQgYnkgYSBu
ZWdhdGl2ZSBvZmZzZXQuCi0gICAgICovCi0gICAgX3Njcm9sbENvbnRlbnQgOiBmdW5jdGlvbihy
b3dPZmZzZXQpCi0gICAgewotICAgICAgaWYgKCF0aGlzLmdldEVsZW1lbnQoKS5maXJzdENoaWxk
KSB7Ci0gICAgICAgIHRoaXMuX3VwZGF0ZUFsbFJvd3MoKTsKLSAgICAgICAgcmV0dXJuOwotICAg
ICAgfQotCi0gICAgICB2YXIgdGFibGVCb2R5ID0gdGhpcy5nZXRFbGVtZW50KCkuZmlyc3RDaGls
ZDsKLSAgICAgIHZhciB0YWJsZUNoaWxkTm9kZXMgPSB0YWJsZUJvZHkuY2hpbGROb2RlczsKLSAg
ICAgIHZhciByb3dDb3VudCA9IHRoaXMuZ2V0VmlzaWJsZVJvd0NvdW50KCk7Ci0gICAgICB2YXIg
Zmlyc3RSb3cgPSB0aGlzLmdldEZpcnN0VmlzaWJsZVJvdygpOwotCi0KLSAgICAgIHZhciBtb2Rl
bFJvd0NvdW50ID0gdGhpcy5nZXRUYWJsZSgpLmdldFRhYmxlTW9kZWwoKS5nZXRSb3dDb3VudCgp
OwotCi0gICAgICAvLyBkb24ndCBoYW5kbGUgdGhpcyBzcGVjaWFsIGNhc2UgaGVyZQotICAgICAg
aWYgKGZpcnN0Um93ICsgcm93Q291bnQgPiBtb2RlbFJvd0NvdW50KSB7Ci0gICAgICAgIHRoaXMu
X3VwZGF0ZUFsbFJvd3MoKTsKLSAgICAgICAgcmV0dXJuOwotICAgICAgfQotCi0gICAgICAvLyBy
ZW1vdmUgb2xkIGxpbmVzCi0gICAgICB2YXIgcmVtb3ZlUm93QmFzZSA9IHJvd09mZnNldCA8IDAg
PyByb3dDb3VudCArIHJvd09mZnNldCA6IDA7Ci0gICAgICB2YXIgYWRkUm93QmFzZSA9IHJvd09m
ZnNldCA8IDAgPyAwOiByb3dDb3VudCAtIHJvd09mZnNldDsKLQotICAgICAgZm9yIChpPU1hdGgu
YWJzKHJvd09mZnNldCktMTsgaT49MDsgaS0tKQotICAgICAgewotICAgICAgICB2YXIgcm93RWxl
bSA9IHRhYmxlQ2hpbGROb2Rlc1tyZW1vdmVSb3dCYXNlXTsKLSAgICAgICAgdHJ5IHsKLSAgICAg
ICAgICB0YWJsZUJvZHkucmVtb3ZlQ2hpbGQocm93RWxlbSk7Ci0gICAgICAgIH0gY2F0Y2goZSkg
ewotICAgICAgICAgIGJyZWFrOwotICAgICAgICB9Ci0gICAgICB9Ci0KLSAgICAgIC8vIHJlbmRl
ciBuZXcgbGluZXMKLSAgICAgIGlmICghdGhpcy5fdGFibGVDb250YWluZXIpIHsKLSAgICAgICAg
dGhpcy5fdGFibGVDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKLSAg
ICAgIH0KLSAgICAgIHZhciB0YWJsZUR1bW15ID0gJzxkaXY+JzsKLSAgICAgIHRhYmxlRHVtbXkg
Kz0gdGhpcy5fZ2V0Um93c0h0bWwoZmlyc3RSb3cgKyBhZGRSb3dCYXNlLCBNYXRoLmFicyhyb3dP
ZmZzZXQpKTsKLSAgICAgIHRhYmxlRHVtbXkgKz0gJzwvZGl2Pic7Ci0gICAgICB0aGlzLl90YWJs
ZUNvbnRhaW5lci5pbm5lckhUTUwgPSB0YWJsZUR1bW15OwotICAgICAgdmFyIG5ld1RhYmxlUm93
cyA9IHRoaXMuX3RhYmxlQ29udGFpbmVyLmZpcnN0Q2hpbGQuY2hpbGROb2RlczsKLQotICAgICAg
Ly8gYXBwZW5kIG5ldyBsaW5lcwotICAgICAgaWYgKHJvd09mZnNldCA+IDApCi0gICAgICB7Ci0g
ICAgICAgIGZvciAodmFyIGk9bmV3VGFibGVSb3dzLmxlbmd0aC0xOyBpPj0wOyBpLS0pCi0gICAg
ICAgIHsKLSAgICAgICAgICB2YXIgcm93RWxlbSA9IG5ld1RhYmxlUm93c1swXTsKLSAgICAgICAg
ICB0YWJsZUJvZHkuYXBwZW5kQ2hpbGQocm93RWxlbSk7Ci0gICAgICAgIH0KLSAgICAgIH0KLSAg
ICAgIGVsc2UKLSAgICAgIHsKLSAgICAgICAgZm9yICh2YXIgaT1uZXdUYWJsZVJvd3MubGVuZ3Ro
LTE7IGk+PTA7IGktLSkKLSAgICAgICAgewotICAgICAgICAgIHZhciByb3dFbGVtID0gbmV3VGFi
bGVSb3dzW25ld1RhYmxlUm93cy5sZW5ndGgtMV07Ci0gICAgICAgICAgdGFibGVCb2R5Lmluc2Vy
dEJlZm9yZShyb3dFbGVtLCB0YWJsZUJvZHkuZmlyc3RDaGlsZCk7Ci0gICAgICAgIH0KLSAgICAg
IH0KLQotICAgICAgLy8gdXBkYXRlIGZvY3VzIGluZGljYXRvcgotICAgICAgdGhpcy5fdXBkYXRl
Um93U3R5bGVzKHRoaXMuX2ZvY3VzZWRSb3cgLSByb3dPZmZzZXQpOwotICAgICAgdGhpcy5fdXBk
YXRlUm93U3R5bGVzKHRoaXMuX2ZvY3VzZWRSb3cpOwotCi0gICAgICAvLyBmb3JjZSBpbW1lZGlh
dGUgbGF5b3V0aW5nCi0gICAgICAvLyB0aGlzIHByZXZlbnRzIEZpcmVmb3ggZnJvbSBmbGlja2Vy
aW5nCi0gICAgICBpZiAocXguY29yZS5WYXJpYW50LmlzU2V0KCJxeC5jbGllbnQiLCAiZ2Vja28i
KSkgewotICAgICAgICByb3dFbGVtLm9mZnNldEhlaWdodDsKLSAgICAgIH0KLSAgICB9LAotCi0K
LSAgICAvKioKLSAgICAgKiBVcGRhdGVzIHRoZSBjb250ZW50IG9mIHRoZSBwYW5lIChpbXBsZW1l
bnRlZCB1c2luZyBhcnJheSBqb2lucykuCi0gICAgICovCi0gICAgX3VwZGF0ZUFsbFJvd3MgOiBm
dW5jdGlvbigpCi0gICAgewotICAgICAgdmFyIHRhYmxlID0gdGhpcy5nZXRUYWJsZSgpOwotCi0g
ICAgICB2YXIgdGFibGVNb2RlbCA9IHRhYmxlLmdldFRhYmxlTW9kZWwoKTsKLSAgICAgIHZhciBw
YW5lTW9kZWwgPSB0aGlzLmdldFBhbmVTY3JvbGxlcigpLmdldFRhYmxlUGFuZU1vZGVsKCk7Ci0K
LSAgICAgIHZhciBjb2xDb3VudCA9IHBhbmVNb2RlbC5nZXRDb2x1bW5Db3VudCgpOwotICAgICAg
dmFyIHJvd0hlaWdodCA9IHRhYmxlLmdldFJvd0hlaWdodCgpOwotICAgICAgdmFyIGZpcnN0Um93
ID0gdGhpcy5nZXRGaXJzdFZpc2libGVSb3coKTsKLQotICAgICAgdmFyIHJvd0NvdW50ID0gdGhp
cy5nZXRWaXNpYmxlUm93Q291bnQoKTsKLSAgICAgIHZhciBtb2RlbFJvd0NvdW50ID0gdGFibGVN
b2RlbC5nZXRSb3dDb3VudCgpOwotCi0gICAgICBpZiAoZmlyc3RSb3cgKyByb3dDb3VudCA+IG1v
ZGVsUm93Q291bnQpIHsKLSAgICAgICAgcm93Q291bnQgPSBNYXRoLm1heCgwLCBtb2RlbFJvd0Nv
dW50IC0gZmlyc3RSb3cpOwotICAgICAgfQotCi0gICAgICB2YXIgcm93V2lkdGggPSBwYW5lTW9k
ZWwuZ2V0VG90YWxXaWR0aCgpOwotCi0gICAgICB2YXIgaHRtbEFyciA9IFsKLSAgICAgICAgIjxk
aXYgc3R5bGU9JyIsCi0gICAgICAgICJ3aWR0aDogIiwgcm93V2lkdGgsICJweDsiLAotICAgICAg
ICAibGluZS1oZWlnaHQ6ICIsIHJvd0hlaWdodCwgInB4OyIsCi0gICAgICAgICJvdmVyZmxvdzog
aGlkZGVuOyIsCi0gICAgICAgICJmb250LXNpemU6IDExcHg7IiwKLSAgICAgICAgImZvbnQtZmFt
aWx5OiAnU2Vnb2UgVUknLCBDb3JiZWwsIENhbGlicmksIFRhaG9tYSwgJ0x1Y2lkYSBTYW5zIFVu
aWNvZGUnLCBzYW5zLXNlcmlmOyIsCi0gICAgICAgICInPiIsCi0gICAgICAgIHRoaXMuX2dldFJv
d3NIdG1sKGZpcnN0Um93LCByb3dDb3VudCksCi0gICAgICAgICI8L2Rpdj4iCi0gICAgICBdOwot
Ci0gICAgICB2YXIgZWxlbSA9IHRoaXMuZ2V0RWxlbWVudCgpOwotICAgICAgdmFyIGRhdGEgPSBo
dG1sQXJyLmpvaW4oIiIpOwotCi0gICAgICAvL3RoaXMuZGVidWcoIj4+PiIgKyBkYXRhICsgIjw8
PCIpCi0KLSAgICAgIHZhciBzZWxmID0gdGhpczsKLSAgICAgIHRoaXMuX2xheW91dFBlbmRpbmcg
PSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpCi0gICAgICB7Ci0gICAgICAgIGVsZW0uaW5u
ZXJIVE1MID0gZGF0YTsKLQotICAgICAgICAvLyBmb3JjZSBpbW1lZGlhdGUgbGF5b3V0aW5nCi0g
ICAgICAgIC8vIHRoaXMgcHJldmVudHMgRmlyZWZveCBmcm9tIGZsaWNrZXJpbmcKLSAgICAgICAg
aWYgKHF4LmNvcmUuVmFyaWFudC5pc1NldCgicXguY2xpZW50IiwgImdlY2tvIikpIHsKLSAgICAg
ICAgICBlbGVtLmNoaWxkTm9kZXNbMF0ub2Zmc2V0SGVpZ2h0OwotICAgICAgICB9Ci0gICAgICAg
IHNlbGYuX2xheW91dFBlbmRpbmcgPSBudWxsOwotICAgICAgfSwgMTApOwotCi0gICAgICAvKgot
ICAgICAgZWxlbS5pbm5lckhUTUwgPSBkYXRhOwotCi0gICAgICAvLyBmb3JjZSBpbW1lZGlhdGUg
bGF5b3V0aW5nCi0gICAgICAvLyB0aGlzIHByZXZlbnRzIEZpcmVmb3ggZnJvbSBmbGlja2VyaW5n
Ci0gICAgICBpZiAocXguY29yZS5WYXJpYW50LmlzU2V0KCJxeC5jbGllbnQiLCAiZ2Vja28iKSkg
ewotICAgICAgICBlbGVtLmNoaWxkTm9kZXNbMF0ub2Zmc2V0SGVpZ2h0OwotICAgICAgfQotICAg
ICAgKi8KLQotICAgICAgdGhpcy5zZXRIZWlnaHQocm93Q291bnQgKiByb3dIZWlnaHQpOwotCi0g
ICAgICB0aGlzLl9sYXN0Q29sQ291bnQgPSBjb2xDb3VudDsKLSAgICAgIHRoaXMuX2xhc3RSb3dD
b3VudCA9IHJvd0NvdW50OwotICAgIH0KLQotICB9LAotCi0KLQotCi0gIC8qCi0gICoqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqCi0gICAgIERFU1RSVUNUT1IKLSAgKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKLSAg
Ki8KLQotICBkZXN0cnVjdCA6IGZ1bmN0aW9uKCkgewotICAgIHRoaXMuX2Rpc3Bvc2VPYmplY3Rz
KCJfcGFuZVNjcm9sbGVyIik7Ci0gIH0KLX0pOworLyogKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQorDQorICAg
cW9veGRvbyAtIHRoZSBuZXcgZXJhIG9mIHdlYiBkZXZlbG9wbWVudA0KKw0KKyAgIGh0dHA6Ly9x
b294ZG9vLm9yZw0KKw0KKyAgIENvcHlyaWdodDoNCisgICAgIDIwMDYgU1RaLUlEQSwgR2VybWFu
eSwgaHR0cDovL3d3dy5zdHotaWRhLmRlDQorDQorICAgTGljZW5zZToNCisgICAgIExHUEw6IGh0
dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9sZ3BsLmh0bWwNCisgICAgIEVQTDogaHR0cDovL3d3
dy5lY2xpcHNlLm9yZy9vcmcvZG9jdW1lbnRzL2VwbC12MTAucGhwDQorICAgICBTZWUgdGhlIExJ
Q0VOU0UgZmlsZSBpbiB0aGUgcHJvamVjdCdzIHRvcC1sZXZlbCBkaXJlY3RvcnkgZm9yIGRldGFp
bHMuDQorDQorICAgQXV0aG9yczoNCisgICAgICogVGlsIFNjaG5laWRlciAodGlsMTMyKQ0KKyAg
ICAgKiBGYWJpYW4gSmFrb2JzIChmamFrb2JzKQ0KKw0KKyoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KKw0K
Ky8qICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKg0KKw0KKyNtb2R1bGUodWlfdGFibGUpDQorDQorKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqICovDQorDQorLyoqDQorICogVGhlIHRhYmxlIHBhbmUgdGhhdCBzaG93cyBhIGNlcnRh
aW4gc2VjdGlvbiBmcm9tIGEgdGFibGUuIFRoaXMgY2xhc3MgaGFuZGxlcw0KKyAqIHRoZSBkaXNw
bGF5IG9mIHRoZSBkYXRhIHBhcnQgb2YgYSB0YWJsZSBhbmQgaXMgdGhlcmVmb3JlIHRoZSBiYXNl
IGZvciB2aXJ0dWFsDQorICogc2Nyb2xsaW5nLg0KKyAqLw0KK3F4LkNsYXNzLmRlZmluZSgicXgu
dWkudGFibGUucGFuZS5QYW5lIiwNCit7DQorICBleHRlbmQgOiBxeC51aS5iYXNpYy5UZXJtaW5h
dG9yLA0KKw0KKw0KKw0KKw0KKyAgLyoNCisgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQorICAgICBD
T05TVFJVQ1RPUg0KKyAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCisgICovDQorDQorICAvKioNCisg
ICAqIEBwYXJhbSBwYW5lU2Nyb2xsZXIge3F4LnVpLnRhYmxlLnBhbmUuU2Nyb2xsZXJ9IHRoZSBU
YWJsZVBhbmVTY3JvbGxlciB0aGUgaGVhZGVyIGJlbG9uZ3MgdG8uDQorICAgKi8NCisgIGNvbnN0
cnVjdCA6IGZ1bmN0aW9uKHBhbmVTY3JvbGxlcikNCisgIHsNCisgICAgdGhpcy5iYXNlKGFyZ3Vt
ZW50cyk7DQorDQorICAgIHRoaXMuX3BhbmVTY3JvbGxlciA9IHBhbmVTY3JvbGxlcjsNCisNCisg
ICAgdGhpcy5fbGFzdENvbENvdW50ID0gMDsNCisgICAgdGhpcy5fbGFzdFJvd0NvdW50ID0gMDsN
CisgIH0sDQorDQorDQorDQorDQorICAvKg0KKyAgKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCisgICAg
IFBST1BFUlRJRVMNCisgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQorICAqLw0KKw0KKyAgcHJvcGVy
dGllcyA6DQorICB7DQorICAgIGFwcGVhcmFuY2UgOg0KKyAgICB7DQorICAgICAgcmVmaW5lIDog
dHJ1ZSwNCisgICAgICBpbml0IDogInRhYmxlLXBhbmUiDQorICAgIH0sDQorDQorICAgIC8qKiBU
aGUgaW5kZXggb2YgdGhlIGZpcnN0IHJvdyB0byBzaG93LiAqLw0KKyAgICBmaXJzdFZpc2libGVS
b3cgOg0KKyAgICB7DQorICAgICAgY2hlY2sgOiAiTnVtYmVyIiwNCisgICAgICBpbml0IDogMCwN
CisgICAgICBhcHBseSA6ICJfYXBwbHlGaXJzdFZpc2libGVSb3ciDQorICAgIH0sDQorDQorICAg
IC8qKiBUaGUgbnVtYmVyIG9mIHJvd3MgdG8gc2hvdy4gKi8NCisgICAgdmlzaWJsZVJvd0NvdW50
IDoNCisgICAgew0KKyAgICAgIGNoZWNrIDogIk51bWJlciIsDQorICAgICAgaW5pdCA6IDAsDQor
ICAgICAgYXBwbHkgOiAiX2FwcGx5VmlzaWJsZVJvd0NvdW50Ig0KKyAgICB9LA0KKw0KKw0KKyAg
ICAvKioNCisgICAgICogTWF4aW11bSBudW1iZXIgb2YgY2FjaGVkIHJvd3MuIElmIHRoZSB2YWx1
ZSBpcyA8Y29kZT4tMTwvY29kZT4gdGhlIGNhY2hlDQorICAgICAqIHNpemUgaXMgdW5saW1pdGVk
DQorICAgICAqLw0KKyAgICBtYXhDYWNoZUxpbmVzIDoNCisgICAgew0KKyAgICAgIGNoZWNrIDog
Ik51bWJlciIsDQorICAgICAgaW5pdCA6IDEwMDAsDQorICAgICAgYXBwbHkgOiAiX2FwcGx5TWF4
Q2FjaGVMaW5lcyINCisgICAgfQ0KKw0KKyAgfSwNCisNCisNCisNCisNCisgIC8qDQorICAqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKg0KKyAgICAgTUVNQkVSUw0KKyAgKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioN
CisgICovDQorDQorICBtZW1iZXJzIDoNCisgIHsNCisgICAgLy8gcHJvcGVydHkgbW9kaWZpZXIN
CisgICAgX2FwcGx5Rmlyc3RWaXNpYmxlUm93IDogZnVuY3Rpb24odmFsdWUsIG9sZCkgew0KKyAg
ICAgIHRoaXMuX3VwZGF0ZUNvbnRlbnQoZmFsc2UsIHZhbHVlLW9sZCk7DQorICAgIH0sDQorDQor
ICAgIC8vIHByb3BlcnR5IG1vZGlmaWVyDQorICAgIF9hcHBseVZpc2libGVSb3dDb3VudCA6IGZ1
bmN0aW9uKHZhbHVlLCBvbGQpIHsNCisgICAgICB0aGlzLl91cGRhdGVDb250ZW50KCk7DQorICAg
IH0sDQorDQorDQorICAgIC8vIG92ZXJyaWRkZW4NCisgICAgX2FmdGVyQXBwZWFyIDogZnVuY3Rp
b24oKQ0KKyAgICB7DQorICAgICAgdGhpcy5iYXNlKGFyZ3VtZW50cyk7DQorDQorICAgICAgaWYg
KHRoaXMuX3VwZGF0ZVdhbnRlZFdoaWxlSW52aXNpYmxlKQ0KKyAgICAgIHsNCisgICAgICAgIC8v
IFdlIGFyZSB2aXNpYmxlIG5vdyBhbmQgYW4gdXBkYXRlIHdhcyB3YW50ZWQgd2hpbGUgd2Ugd2Vy
ZSBpbnZpc2libGUNCisgICAgICAgIC8vIC0+IERvIHRoZSB1cGRhdGUgbm93DQorICAgICAgICB0
aGlzLl91cGRhdGVDb250ZW50KCk7DQorICAgICAgICB0aGlzLl91cGRhdGVXYW50ZWRXaGlsZUlu
dmlzaWJsZSA9IGZhbHNlOw0KKyAgICAgIH0NCisgICAgfSwNCisNCisNCisgICAgLyoqDQorICAg
ICAqIFJldHVybnMgdGhlIFRhYmxlUGFuZVNjcm9sbGVyIHRoaXMgcGFuZSBiZWxvbmdzIHRvLg0K
KyAgICAgKg0KKyAgICAgKiBAdHlwZSBtZW1iZXINCisgICAgICogQHJldHVybiB7cXgudWkudGFi
bGUucGFuZS5TY3JvbGxlcn0gdGhlIFRhYmxlUGFuZVNjcm9sbGVyLg0KKyAgICAgKi8NCisgICAg
Z2V0UGFuZVNjcm9sbGVyIDogZnVuY3Rpb24oKSB7DQorICAgICAgcmV0dXJuIHRoaXMuX3BhbmVT
Y3JvbGxlcjsNCisgICAgfSwNCisNCisNCisgICAgLyoqDQorICAgICAqIFJldHVybnMgdGhlIHRh
YmxlIHRoaXMgcGFuZSBiZWxvbmdzIHRvLg0KKyAgICAgKg0KKyAgICAgKiBAdHlwZSBtZW1iZXIN
CisgICAgICogQHJldHVybiB7cXgudWkudGFibGUuVGFibGV9IHRoZSB0YWJsZS4NCisgICAgICov
DQorICAgIGdldFRhYmxlIDogZnVuY3Rpb24oKSB7DQorICAgICAgcmV0dXJuIHRoaXMuX3BhbmVT
Y3JvbGxlci5nZXRUYWJsZSgpOw0KKyAgICB9LA0KKw0KKw0KKyAgICAvKioNCisgICAgICogU2V0
cyB0aGUgY3VycmVudGx5IGZvY3VzZWQgY2VsbC4NCisgICAgICoNCisgICAgICogQHR5cGUgbWVt
YmVyDQorICAgICAqIEBwYXJhbSBjb2wge0ludGVnZXJ9IHRoZSBtb2RlbCBpbmRleCBvZiB0aGUg
Zm9jdXNlZCBjZWxsJ3MgY29sdW1uLg0KKyAgICAgKiBAcGFyYW0gcm93IHtJbnRlZ2VyfSB0aGUg
bW9kZWwgaW5kZXggb2YgdGhlIGZvY3VzZWQgY2VsbCdzIHJvdy4NCisgICAgICogQHBhcmFtIG1h
c3NVcGRhdGUge0Jvb2xlYW4gPyBmYWxzZX0gV2hldGhlciBvdGhlciB1cGRhdGVzIGFyZSBwbGFu
bmVkIGFzIHdlbGwuDQorICAgICAqICAgICAgICAgIElmIHRydWUsIG5vIHJlcGFpbnQgd2lsbCBi
ZSBkb25lLg0KKyAgICAgKiBAcmV0dXJuIHt2b2lkfQ0KKyAgICAgKi8NCisgICAgc2V0Rm9jdXNl
ZENlbGwgOiBmdW5jdGlvbihjb2wsIHJvdywgbWFzc1VwZGF0ZSkNCisgICAgew0KKyAgICAgIGlm
IChjb2wgIT0gdGhpcy5fZm9jdXNlZENvbCB8fCByb3cgIT0gdGhpcy5fZm9jdXNlZFJvdykNCisg
ICAgICB7DQorICAgICAgICB2YXIgb2xkUm93ID0gdGhpcy5fZm9jdXNlZFJvdzsNCisgICAgICAg
IHRoaXMuX2ZvY3VzZWRDb2wgPSBjb2w7DQorICAgICAgICB0aGlzLl9mb2N1c2VkUm93ID0gcm93
Ow0KKw0KKyAgICAgICAgLy8gVXBkYXRlIHRoZSBmb2N1c2VkIHJvdyBiYWNrZ3JvdW5kDQorICAg
ICAgICBpZiAocm93ICE9IG9sZFJvdyAmJiAhbWFzc1VwZGF0ZSkNCisgICAgICAgIHsNCisgICAg
ICAgICAgLy8gTk9URTogT25seSB0aGUgb2xkIGFuZCB0aGUgbmV3IHJvdyBuZWVkIHVwZGF0ZQ0K
KyAgICAgICAgICB0aGlzLl91cGRhdGVDb250ZW50KGZhbHNlLCBudWxsLCBvbGRSb3csIHRydWUp
Ow0KKyAgICAgICAgICB0aGlzLl91cGRhdGVDb250ZW50KGZhbHNlLCBudWxsLCByb3csIHRydWUp
Ow0KKyAgICAgICAgfQ0KKyAgICAgIH0NCisgICAgfSwNCisNCisNCisgICAgLyoqDQorICAgICAq
IEV2ZW50IGhhbmRsZXIuIENhbGxlZCB3aGVuIHRoZSBzZWxlY3Rpb24gaGFzIGNoYW5nZWQuDQor
ICAgICAqDQorICAgICAqIEB0eXBlIG1lbWJlcg0KKyAgICAgKiBAcGFyYW0gZXZ0IHtNYXB9IHRo
ZSBldmVudC4NCisgICAgICogQHJldHVybiB7dm9pZH0NCisgICAgICovDQorICAgIF9vblNlbGVj
dGlvbkNoYW5nZWQgOiBmdW5jdGlvbihldnQpIHsNCisgICAgICB0aGlzLl91cGRhdGVDb250ZW50
KGZhbHNlLCBudWxsLCBudWxsLCB0cnVlKTsNCisgICAgfSwNCisNCisNCisgICAgLyoqDQorICAg
ICAqIEV2ZW50IGhhbmRsZXIuIENhbGxlZCB3aGVuIHRoZSB0YWJsZSBnZXRzIG9yIGxvb3NlcyB0
aGUgZm9jdXMuDQorICAgICAqDQorICAgICAqIEB0eXBlIG1lbWJlcg0KKyAgICAgKiBAcGFyYW0g
ZXZ0IHtNYXB9IHRoZSBldmVudC4NCisgICAgICogQHJldHVybiB7dm9pZH0NCisgICAgICovDQor
ICAgIF9vbkZvY3VzQ2hhbmdlZCA6IGZ1bmN0aW9uKGV2dCkgew0KKyAgICAgIHRoaXMuX3VwZGF0
ZUNvbnRlbnQoZmFsc2UsIG51bGwsIG51bGwsIHRydWUpOw0KKyAgICB9LA0KKw0KKw0KKyAgICAv
KioNCisgICAgICogRXZlbnQgaGFuZGxlci4gQ2FsbGVkIHdoZW4gdGhlIHdpZHRoIG9mIGEgY29s
dW1uIGhhcyBjaGFuZ2VkLg0KKyAgICAgKg0KKyAgICAgKiBAdHlwZSBtZW1iZXINCisgICAgICog
QHBhcmFtIGV2dCB7TWFwfSB0aGUgZXZlbnQuDQorICAgICAqIEByZXR1cm4ge3ZvaWR9DQorICAg
ICAqLw0KKyAgICBfb25Db2xXaWR0aENoYW5nZWQgOiBmdW5jdGlvbihldnQpIHsNCisgICAgICB0
aGlzLl91cGRhdGVDb250ZW50KHRydWUpOw0KKyAgICB9LA0KKw0KKw0KKyAgICAvKioNCisgICAg
ICogRXZlbnQgaGFuZGxlci4gQ2FsbGVkIHRoZSBjb2x1bW4gb3JkZXIgaGFzIGNoYW5nZWQuDQor
ICAgICAqDQorICAgICAqIEB0eXBlIG1lbWJlcg0KKyAgICAgKiBAcGFyYW0gZXZ0IHtNYXB9IHRo
ZSBldmVudC4NCisgICAgICogQHJldHVybiB7dm9pZH0NCisgICAgICovDQorICAgIF9vbkNvbE9y
ZGVyQ2hhbmdlZCA6IGZ1bmN0aW9uKGV2dCkgew0KKyAgICAgIHRoaXMuX3VwZGF0ZUNvbnRlbnQo
dHJ1ZSk7DQorICAgIH0sDQorDQorDQorICAgIC8qKg0KKyAgICAgKiBFdmVudCBoYW5kbGVyLiBD
YWxsZWQgd2hlbiB0aGUgcGFuZSBtb2RlbCBoYXMgY2hhbmdlZC4NCisgICAgICoNCisgICAgICog
QHR5cGUgbWVtYmVyDQorICAgICAqIEBwYXJhbSBldnQge01hcH0gdGhlIGV2ZW50Lg0KKyAgICAg
KiBAcmV0dXJuIHt2b2lkfQ0KKyAgICAgKi8NCisgICAgX29uUGFuZU1vZGVsQ2hhbmdlZCA6IGZ1
bmN0aW9uKGV2dCkgew0KKyAgICAgIHRoaXMuX3VwZGF0ZUNvbnRlbnQodHJ1ZSk7DQorICAgIH0s
DQorDQorDQorICAgIC8qKg0KKyAgICAgKiBFdmVudCBoYW5kbGVyLiBDYWxsZWQgd2hlbiB0aGUg
dGFibGUgbW9kZWwgZGF0YSBoYXMgY2hhbmdlZC4NCisgICAgICoNCisgICAgICogQHR5cGUgbWVt
YmVyDQorICAgICAqIEBwYXJhbSBldnQge01hcH0gdGhlIGV2ZW50Lg0KKyAgICAgKiBAcmV0dXJu
IHt2b2lkfQ0KKyAgICAgKi8NCisgICAgX29uVGFibGVNb2RlbERhdGFDaGFuZ2VkIDogZnVuY3Rp
b24oZXZ0KQ0KKyAgICB7DQorICAgICAgdmFyIGRhdGEgPSBldnQuZ2V0RGF0YSA/IGV2dC5nZXRE
YXRhKCkgOiBudWxsOw0KKyAgICAgIHRoaXMuX19yb3dDYWNoZUNsZWFyKCk7DQorDQorICAgICAg
dmFyIGZpcnN0Um93ID0gdGhpcy5nZXRGaXJzdFZpc2libGVSb3coKTsNCisgICAgICB2YXIgcm93
Q291bnQgPSB0aGlzLmdldFZpc2libGVSb3dDb3VudCgpOw0KKw0KKyAgICAgIGlmIChkYXRhID09
IG51bGwgfHwgZGF0YS5sYXN0Um93ID09IC0xIHx8IGRhdGEubGFzdFJvdyA+PSBmaXJzdFJvdyAm
JiBkYXRhLmZpcnN0Um93IDwgZmlyc3RSb3cgKyByb3dDb3VudCkNCisgICAgICB7DQorICAgICAg
ICAvLyBUaGUgY2hhbmdlIGludGVyc2VjdHMgdGhpcyBwYW5lDQorICAgICAgICB0aGlzLl91cGRh
dGVDb250ZW50KCk7DQorICAgICAgfQ0KKyAgICB9LA0KKw0KKw0KKyAgICAvKioNCisgICAgICog
RXZlbnQgaGFuZGxlci4gQ2FsbGVkIHdoZW4gdGhlIHRhYmxlIG1vZGVsIG1ldGEgZGF0YSBoYXMg
Y2hhbmdlZC4NCisgICAgICoNCisgICAgICogQHR5cGUgbWVtYmVyDQorICAgICAqIEBwYXJhbSBl
dnQge01hcH0gdGhlIGV2ZW50Lg0KKyAgICAgKiBAcmV0dXJuIHt2b2lkfQ0KKyAgICAgKi8NCisg
ICAgX29uVGFibGVNb2RlbE1ldGFEYXRhQ2hhbmdlZCA6IGZ1bmN0aW9uKGV2dCkgew0KKyAgICAg
IHRoaXMuX3VwZGF0ZUNvbnRlbnQodHJ1ZSk7DQorICAgIH0sDQorDQorDQorICAgIC8vIHNwYXJz
ZSBhcnJheSB0byBjYWNoZSByZW5kZXJlZCByb3dzDQorICAgIF9fcm93Q2FjaGUgOiBbXSwNCisg
ICAgX19yb3dDYWNoZUNvdW50IDogMCwNCisNCisNCisgICAgLy8gcHJvcGVydHkgYXBwbHkgbWV0
aG9kDQorICAgIF9hcHBseU1heENhY2hlTGluZXMgOiBmdW5jdGlvbih2YWx1ZSwgb2xkKQ0KKyAg
ICB7DQorICAgICAgaWYgKHRoaXMuX19yb3dDYWNoZUNvdW50ID49IHZhbHVlICYmIHZhbHVlICE9
PSAtMSkgew0KKyAgICAgICAgdGhpcy5fX3Jvd0NhY2hlQ2xlYXIoKTsNCisgICAgICB9DQorICAg
IH0sDQorDQorDQorICAgIC8qKg0KKyAgICAgKiBDbGVhciB0aGUgcm93IGNhY2hlDQorICAgICAq
Lw0KKyAgICBfX3Jvd0NhY2hlQ2xlYXIgOiBmdW5jdGlvbigpIHsNCisgICAgICB0aGlzLl9fcm93
Q2FjaGUgPSBbXTsNCisgICAgICB0aGlzLl9fcm93Q2FjaGVDb3VudCA9IDA7DQorICAgIH0sDQor
DQorDQorICAgIC8qKg0KKyAgICAgKiBHZXQgYSBsaW5lIGZyb20gdGhlIHJvdyBjYWNoZS4NCisg
ICAgICoNCisgICAgICogQHBhcmFtIHJvdyB7SW50ZWdlcn0gUm93IGluZGV4IHRvIGdldA0KKyAg
ICAgKiBAcGFyYW0gc2VsZWN0ZWQge0Jvb2xlYW59IFdoZXRoZXIgdGhlIHJvdyBpcyBjdXJyZW50
bHkgc2VsZWN0ZWQNCisgICAgICogQHBhcmFtIGZvY3VzZWQge0Jvb2xlYW59IFdoZXRoZXIgdGhl
IHJvdyBpcyBjdXJyZW50bHkgZm9jdXNlZA0KKyAgICAgKiBAcmV0dXJuIHtTdHJpbmd8bnVsbH0g
VGhlIGNhY2hlZCByb3cgb3IgbnVsbCBpZiBhIHJvdyB3aXRoIHRoZSBnaXZlbg0KKyAgICAgKiAg
ICAgaW5kZXggaXMgbm90IGNhY2hlZC4NCisgICAgICovDQorICAgIF9fcm93Q2FjaGVHZXQgOiBm
dW5jdGlvbihyb3csIHNlbGVjdGVkLCBmb2N1c2VkKQ0KKyAgICB7DQorICAgICAgaWYgKCFzZWxl
Y3RlZCAmJiAhZm9jdXNlZCAmJiB0aGlzLl9fcm93Q2FjaGVbcm93XSkgew0KKyAgICAgICAgcmV0
dXJuIHRoaXMuX19yb3dDYWNoZVtyb3ddOw0KKyAgICAgIH0gZWxzZSB7DQorICAgICAgICByZXR1
cm4gbnVsbDsNCisgICAgICB9DQorICAgIH0sDQorDQorDQorICAgIC8qKg0KKyAgICAgKiBBZGQg
YSBsaW5lIHRvIHRoZSByb3cgY2FjaGUuDQorICAgICAqDQorICAgICAqIEBwYXJhbSByb3cge0lu
dGVnZXJ9IFJvdyBpbmRleCB0byBzZXQNCisgICAgICogQHBhcmFtIHJvd1N0cmluZyB7U3RyaW5n
fSBjb21wdXRlZCByb3cgc3RyaW5nIHRvIGNhY2hlDQorICAgICAqIEBwYXJhbSBzZWxlY3RlZCB7
Qm9vbGVhbn0gV2hldGhlciB0aGUgcm93IGlzIGN1cnJlbnRseSBzZWxlY3RlZA0KKyAgICAgKiBA
cGFyYW0gZm9jdXNlZCB7Qm9vbGVhbn0gV2hldGhlciB0aGUgcm93IGlzIGN1cnJlbnRseSBmb2N1
c2VkDQorICAgICAqLw0KKyAgICBfX3Jvd0NhY2hlU2V0IDogZnVuY3Rpb24ocm93LCByb3dTdHJp
bmcsIHNlbGVjdGVkLCBmb2N1c2VkKQ0KKyAgICB7DQorICAgICAgaWYgKCFzZWxlY3RlZCAmJiAh
Zm9jdXNlZCAmJiAhdGhpcy5fX3Jvd0NhY2hlW3Jvd10pIHsNCisgICAgICAgIHRoaXMuX2FwcGx5
TWF4Q2FjaGVMaW5lcyh0aGlzLmdldE1heENhY2hlTGluZXMoKSk7DQorICAgICAgICB0aGlzLl9f
cm93Q2FjaGVbcm93XSA9IHJvd1N0cmluZzsNCisgICAgICAgIHRoaXMuX19yb3dDYWNoZUNvdW50
ICs9IDE7DQorICAgICAgfQ0KKyAgICB9LA0KKw0KKw0KKyAgICAvKioNCisgICAgICogVXBkYXRl
cyB0aGUgY29udGVudCBvZiB0aGUgcGFuZS4NCisgICAgICoNCisgICAgICogQHR5cGUgbWVtYmVy
DQorICAgICAqIEBwYXJhbSBjb21wbGV0ZVVwZGF0ZSB7Qm9vbGVhbiA/IGZhbHNlfSBpZiB0cnVl
IGEgY29tcGxldGUgdXBkYXRlIGlzIHBlcmZvcm1lZC4NCisgICAgICogICAgICBPbiBhIGNvbXBs
ZXRlIHVwZGF0ZSBhbGwgY2VsbCB3aWRnZXRzIGFyZSByZWNyZWF0ZWQuDQorICAgICAqIEBwYXJh
bSBzY3JvbGxPZmZzZXQge0ludGVnZXIgPyBudWxsfSBJZiBzZXQgc3BlY2lmaWVzIGhvdyBtYW55
IHJvd3MgdG8gc2Nyb2xsLg0KKyAgICAgKiBAcGFyYW0gb25seVJvdyB7SW50ZWdlciA/IG51bGx9
IGlmIHNldCBvbmx5IHRoZSBzcGVjaWZpZWQgcm93IHdpbGwgYmUgdXBkYXRlZC4NCisgICAgICog
QHBhcmFtIG9ubHlTZWxlY3Rpb25PckZvY3VzQ2hhbmdlZCB7Qm9vbGVhbiA/IGZhbHNlfSBpZiB0
cnVlLCBjZWxsIHZhbHVlcyB3b24ndA0KKyAgICAgKiAgICAgICAgICBiZSB1cGRhdGVkLiBPbmx5
IHRoZSByb3cgYmFja2dyb3VuZCB3aWxsLg0KKyAgICAgKiBAcmV0dXJuIHt2b2lkfQ0KKyAgICAg
Ki8NCisgICAgX3VwZGF0ZUNvbnRlbnQgOiBmdW5jdGlvbihjb21wbGV0ZVVwZGF0ZSwgc2Nyb2xs
T2Zmc2V0LCBvbmx5Um93LCBvbmx5U2VsZWN0aW9uT3JGb2N1c0NoYW5nZWQpDQorICAgIHsNCisg
ICAgICBpZiAoY29tcGxldGVVcGRhdGUpIHsNCisgICAgICAgIHRoaXMuX19yb3dDYWNoZUNsZWFy
KCk7DQorICAgICAgfQ0KKw0KKyAgICAgIGlmICghdGhpcy5pc1NlZWFibGUoKSkNCisgICAgICB7
DQorICAgICAgICB0aGlzLl91cGRhdGVXYW50ZWRXaGlsZUludmlzaWJsZSA9IHRydWU7DQorICAg
ICAgICByZXR1cm47DQorICAgICAgfQ0KKw0KKyAgICAgIGlmICh0aGlzLl9sYXlvdXRQZW5kaW5n
KQ0KKyAgICAgIHsNCisgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5fbGF5b3V0UGVu
ZGluZyk7DQorICAgICAgICB0aGlzLl91cGRhdGVBbGxSb3dzKCk7DQorICAgICAgICByZXR1cm47
DQorICAgICAgfQ0KKw0KKyAgICAgIC8vdmFyIHN0YXJ0ID0gbmV3IERhdGUoKTsNCisNCisgICAg
ICBpZiAoc2Nyb2xsT2Zmc2V0ICYmIE1hdGguYWJzKHNjcm9sbE9mZnNldCkgPD0gTWF0aC5taW4o
MTAsIHRoaXMuZ2V0VmlzaWJsZVJvd0NvdW50KCkpKQ0KKyAgICAgIHsNCisgICAgICAgIC8vdGhp
cy5kZWJ1Zygic2Nyb2xsIiwgc2Nyb2xsT2Zmc2V0KTsNCisgICAgICAgIHRoaXMuX3Njcm9sbENv
bnRlbnQoc2Nyb2xsT2Zmc2V0KTsNCisgICAgICB9DQorICAgICAgZWxzZSBpZiAob25seVNlbGVj
dGlvbk9yRm9jdXNDaGFuZ2VkICYmICF0aGlzLmdldFRhYmxlKCkuZ2V0QWx3YXlzVXBkYXRlQ2Vs
bHMoKSkNCisgICAgICB7DQorICAgICAgICAvL3RoaXMuZGVidWcoInVwZGF0ZSByb3cgc3R5bGVz
Iik7DQorICAgICAgICB0aGlzLl91cGRhdGVSb3dTdHlsZXMob25seVJvdyk7DQorICAgICAgfQ0K
KyAgICAgIGVsc2UNCisgICAgICB7DQorICAgICAgICAvL3RoaXMuZGVidWcoImZ1bGwgdXBkYXRl
Iik7DQorICAgICAgICB0aGlzLl91cGRhdGVBbGxSb3dzKCk7DQorICAgICAgfQ0KKw0KKyAgICAg
IC8vdGhpcy5kZWJ1ZygicmVuZGVyIHRpbWU6ICIgKyAobmV3IERhdGUoKSAtIHN0YXJ0KSArICJt
cyIpOw0KKyAgICB9LA0KKw0KKw0KKyAgICAvKioNCisgICAgICogSWYgb25seSBmb2N1cyBvciBz
ZWxlY3Rpb24gY2hhbmdlcyBpdCBpcyBzdWZmaWNpZW50IHRvIG9ubHkgdXBkYXRlIHRoZQ0KKyAg
ICAgKiByb3cgc3R5bGVzLiBUaGlzIG1ldGhvZCB1cGRhdGVzIHRoZSByb3cgc3R5bGVzIG9mIGFs
bCB2aXNpYmxlIHJvd3Mgb3INCisgICAgICogb2YganVzdCBvbmUgcm93Lg0KKyAgICAgKg0KKyAg
ICAgKiBAcGFyYW0gb25seVJvdyB7SW50ZWdlcnxudWxsID8gbnVsbH0gSWYgdGhpcyBwYXJhbWV0
ZXIgaXMgc2V0IG9ubHkgdGhlIHJvdw0KKyAgICAgKiAgICAgd2l0aCB0aGlzIGluZGV4IGlzIHVw
ZGF0ZWQuDQorICAgICAqLw0KKyAgICBfdXBkYXRlUm93U3R5bGVzIDogZnVuY3Rpb24ob25seVJv
dykNCisgICAgew0KKyAgICAgIHZhciBlbGVtID0gdGhpcy5nZXRFbGVtZW50KCk7DQorICAgICAg
aWYgKCFlbGVtLmZpcnN0Q2hpbGQpIHsNCisgICAgICAgIHRoaXMuX3VwZGF0ZUFsbFJvd3MoKTsN
CisgICAgICAgIHJldHVybjsNCisgICAgICB9DQorDQorICAgICAgdmFyIHRhYmxlID0gdGhpcy5n
ZXRUYWJsZSgpOw0KKyAgICAgIHZhciBzZWxlY3Rpb25Nb2RlbCA9IHRhYmxlLmdldFNlbGVjdGlv
bk1vZGVsKCk7DQorICAgICAgdmFyIHRhYmxlTW9kZWwgPSB0YWJsZS5nZXRUYWJsZU1vZGVsKCk7
DQorICAgICAgdmFyIHJvd1JlbmRlcmVyID0gdGFibGUuZ2V0RGF0YVJvd1JlbmRlcmVyKCk7DQor
ICAgICAgdmFyIHJvd05vZGVzID0gZWxlbS5maXJzdENoaWxkLmNoaWxkTm9kZXM7DQorICAgICAg
dmFyIGNlbGxJbmZvID0geyB0YWJsZSA6IHRhYmxlIH07DQorDQorICAgICAgLy8gV2UgZG9uJ3Qg
d2FudCB0byBleGVjdXRlIHRoZSByb3cgbG9vcCBiZWxvdyBtb3JlIHRoYW4gbmVjZXNzYXJ5LiBJ
Zg0KKyAgICAgIC8vIG9ubHlyb3cgaXMgbm90IG51bGwsIHdlIHdhbnQgdG8gZG8gdGhlIGxvb3Ag
b25seSBmb3IgdGhhdCByb3cuDQorICAgICAgLy8gSW4gdGhhdCBjYXNlLCB3YXMgc3RhcnQgYXQg
KHNldCB0aGUgInJvdyIgdmFyaWFibGUgdG8pIHRoYXQgcm93LCBhbmQNCisgICAgICAvLyBzdG9w
IGF0IChzZXQgdGhlICJlbmQiIHZhcmlhYmxlIHRvIHRoZSBvZmZzZXQgb2YpIHRoZSBuZXh0IHJv
dzsgLg0KKyAgICAgIHZhciByb3cgPSB0aGlzLmdldEZpcnN0VmlzaWJsZVJvdygpOw0KKyAgICAg
IHZhciB5ID0gMDsNCisNCisgICAgICAvLyBIb3cgbWFueSByb3dzIGRvIHdlIG5lZWQgdG8gdXBk
YXRlPw0KKyAgICAgIHZhciBlbmQgPSByb3dOb2Rlcy5sZW5ndGg7DQorDQorICAgICAgaWYgKG9u
bHlSb3cgIT0gbnVsbCkNCisgICAgICB7DQorICAgICAgICAvLyBIb3cgbWFueSByb3dzIGFyZSB3
ZSBza2lwcGluZz8NCisgICAgICAgIHZhciBvZmZzZXQgPSBvbmx5Um93IC0gcm93Ow0KKyAgICAg
ICAgaWYgKG9mZnNldCA+PSAwICYmIG9mZnNldCA8IGVuZCkNCisgICAgICAgIHsNCisgICAgICAg
ICAgcm93ID0gb25seVJvdzsNCisgICAgICAgICAgeSA9IG9mZnNldDsNCisgICAgICAgICAgZW5k
ID0gb2Zmc2V0ICsgMTsNCisgICAgICAgIH0NCisgICAgICAgIGVsc2UNCisgICAgICAgICAgcmV0
dXJuOw0KKyAgICAgIH0NCisNCisgICAgICBmb3IgKDsgeTxlbmQ7IHkrKywgcm93KyspDQorICAg
ICAgew0KKyAgICAgICAgY2VsbEluZm8ucm93ID0gcm93Ow0KKyAgICAgICAgY2VsbEluZm8uc2Vs
ZWN0ZWQgPSBzZWxlY3Rpb25Nb2RlbC5pc1NlbGVjdGVkSW5kZXgocm93KTsNCisgICAgICAgIGNl
bGxJbmZvLmZvY3VzZWRSb3cgPSAodGhpcy5fZm9jdXNlZFJvdyA9PSByb3cpOw0KKyAgICAgICAg
Y2VsbEluZm8ucm93RGF0YSA9IHRhYmxlTW9kZWwuZ2V0Um93RGF0YShyb3cpOw0KKw0KKyAgICAg
ICAgcm93UmVuZGVyZXIudXBkYXRlRGF0YVJvd0VsZW1lbnQoY2VsbEluZm8sIHJvd05vZGVzW3ld
KTsNCisgICAgICB9Ow0KKyAgICB9LA0KKw0KKw0KKyAgICAvKioNCisgICAgICogR2V0IHRoZSBI
VE1MIHRhYmxlIGZyYWdtZW50IGZvciB0aGUgZ2l2ZW4gcm93IHJhbmdlLg0KKyAgICAgKg0KKyAg
ICAgKiBAcGFyYW0gZmlyc3RSb3cge0ludGVnZXJ9IEluZGV4IG9mIHRoZSBmaXJzdCByb3cNCisg
ICAgICogQHBhcmFtIHJvd0NvdW50IHtJbnRlZ2VyfSBOdW1iZXIgb2Ygcm93cw0KKyAgICAgKiBA
cmV0dXJuIHtTdHJpbmd9IFRoZSBIVE1MIHRhYmxlIGZyYWdtZW50IGZvciB0aGUgZ2l2ZW4gcm93
IHJhbmdlLg0KKyAgICAgKi8NCisgICAgX2dldFJvd3NIdG1sIDogZnVuY3Rpb24oZmlyc3RSb3cs
IHJvd0NvdW50KQ0KKyAgICB7DQorICAgICAgdmFyIHRhYmxlID0gdGhpcy5nZXRUYWJsZSgpOw0K
Kw0KKyAgICAgIHZhciBzZWxlY3Rpb25Nb2RlbCA9IHRhYmxlLmdldFNlbGVjdGlvbk1vZGVsKCk7
DQorICAgICAgdmFyIHRhYmxlTW9kZWwgPSB0YWJsZS5nZXRUYWJsZU1vZGVsKCk7DQorICAgICAg
dmFyIGNvbHVtbk1vZGVsID0gdGFibGUuZ2V0VGFibGVDb2x1bW5Nb2RlbCgpOw0KKyAgICAgIHZh
ciBwYW5lTW9kZWwgPSB0aGlzLmdldFBhbmVTY3JvbGxlcigpLmdldFRhYmxlUGFuZU1vZGVsKCk7
DQorICAgICAgdmFyIHJvd1JlbmRlcmVyID0gdGFibGUuZ2V0RGF0YVJvd1JlbmRlcmVyKCk7DQor
DQorICAgICAgdGFibGVNb2RlbC5wcmVmZXRjaFJvd3MoZmlyc3RSb3csIGZpcnN0Um93ICsgcm93
Q291bnQgLSAxKTsNCisNCisgICAgICB2YXIgcm93SGVpZ2h0ID0gdGFibGUuZ2V0Um93SGVpZ2h0
KCk7DQorICAgICAgdmFyIGNvbENvdW50ID0gcGFuZU1vZGVsLmdldENvbHVtbkNvdW50KCk7DQor
ICAgICAgdmFyIGxlZnQgPSAwOw0KKyAgICAgIHZhciBjb2xzID0gW107DQorDQorICAgICAgLy8g
cHJlY29tcHV0ZSBjb2x1bW4gcHJvcGVydGllcw0KKyAgICAgIGZvciAodmFyIHg9MDsgeDxjb2xD
b3VudDsgeCsrKQ0KKyAgICAgIHsNCisgICAgICAgIHZhciBjb2wgPSBwYW5lTW9kZWwuZ2V0Q29s
dW1uQXRYKHgpOw0KKyAgICAgICAgdmFyIGNlbGxXaWR0aCA9IGNvbHVtbk1vZGVsLmdldENvbHVt
bldpZHRoKGNvbCk7DQorICAgICAgICBjb2xzLnB1c2goew0KKyAgICAgICAgICBjb2w6IGNvbCwN
CisgICAgICAgICAgeFBvczogeCwNCisgICAgICAgICAgZWRpdGFibGU6IHRhYmxlTW9kZWwuaXND
b2x1bW5FZGl0YWJsZShjb2wpLA0KKyAgICAgICAgICBmb2N1c2VkQ29sOiB0aGlzLl9mb2N1c2Vk
Q29sID09IGNvbCwNCisgICAgICAgICAgc3R5bGVMZWZ0OiBsZWZ0LA0KKyAgICAgICAgICBzdHls
ZVdpZHRoOiBjZWxsV2lkdGgNCisgICAgICAgIH0pOw0KKw0KKyAgICAgICAgbGVmdCArPSBjZWxs
V2lkdGg7DQorICAgICAgfQ0KKw0KKyAgICAgIHZhciByb3dzQXJyID0gW107DQorICAgICAgZm9y
ICh2YXIgcm93PWZpcnN0Um93OyByb3cgPCBmaXJzdFJvdyArIHJvd0NvdW50OyByb3crKykNCisg
ICAgICB7DQorICAgICAgICB2YXIgc2VsZWN0ZWQgPSBzZWxlY3Rpb25Nb2RlbC5pc1NlbGVjdGVk
SW5kZXgocm93KTsNCisgICAgICAgIHZhciBmb2N1c2VkUm93ID0gKHRoaXMuX2ZvY3VzZWRSb3cg
PT0gcm93KTsNCisNCisgICAgICAgIHZhciBjYWNoZWRSb3cgPSB0aGlzLl9fcm93Q2FjaGVHZXQo
cm93LCBzZWxlY3RlZCwgZm9jdXNlZFJvdyk7DQorICAgICAgICBpZiAoY2FjaGVkUm93KSB7DQor
ICAgICAgICAgIHJvd3NBcnIucHVzaChjYWNoZWRSb3cpOw0KKyAgICAgICAgICBjb250aW51ZTsN
CisgICAgICAgIH0NCisNCisgICAgICAgIHZhciByb3dIdG1sID0gW107DQorDQorICAgICAgICB2
YXIgY2VsbEluZm8gPSB7IHRhYmxlIDogdGFibGUgfTsNCisgICAgICAgIGNlbGxJbmZvLnN0eWxl
SGVpZ2h0ID0gcm93SGVpZ2h0Ow0KKw0KKyAgICAgICAgY2VsbEluZm8ucm93ID0gcm93Ow0KKyAg
ICAgICAgY2VsbEluZm8uc2VsZWN0ZWQgPSBzZWxlY3RlZDsNCisgICAgICAgIGNlbGxJbmZvLmZv
Y3VzZWRSb3cgPSBmb2N1c2VkUm93Ow0KKyAgICAgICAgY2VsbEluZm8ucm93RGF0YSA9IHRhYmxl
TW9kZWwuZ2V0Um93RGF0YShyb3cpOw0KKw0KKyAgICAgICAgcm93SHRtbC5wdXNoKCc8ZGl2ICcp
Ow0KKw0KKyAgICAgICAgdmFyIHJvd0NsYXNzID0gcm93UmVuZGVyZXIuZ2V0Um93Q2xhc3MoY2Vs
bEluZm8pOw0KKyAgICAgICAgaWYgKHJvd0NsYXNzKSB7DQorICAgICAgICAgIHJvd0h0bWwucHVz
aCgnY2xhc3M9IicsIHJvd0NsYXNzLCAnIiAnKTsNCisgICAgICAgIH0NCisNCisgICAgICAgIHZh
ciByb3dTdHlsZSA9IHJvd1JlbmRlcmVyLmNyZWF0ZVJvd1N0eWxlKGNlbGxJbmZvKTsNCisgICAg
ICAgIHJvd1N0eWxlICs9ICI7cG9zaXRpb246cmVsYXRpdmU7aGVpZ2h0OiIgKyByb3dIZWlnaHQg
KyAicHg7IHdpZHRoOiIgKyBwYW5lTW9kZWwuZ2V0VG90YWxXaWR0aCgpICsgInB4OyI7DQorICAg
ICAgICBpZiAocm93U3R5bGUpIHsNCisgICAgICAgICAgcm93SHRtbC5wdXNoKCdzdHlsZT0iJywg
cm93U3R5bGUsICciICcpOw0KKyAgICAgICAgfQ0KKyAgICAgICAgcm93SHRtbC5wdXNoKCc+Jyk7
DQorDQorICAgICAgICBmb3IgKHZhciB4PTA7IHg8Y29sQ291bnQ7IHgrKykNCisgICAgICAgIHsN
CisgICAgICAgICAgdmFyIGNvbF9kZWYgPSBjb2xzW3hdOw0KKyAgICAgICAgICBmb3IgKHZhciBh
dHRyIGluIGNvbF9kZWYpIHsNCisgICAgICAgICAgICBjZWxsSW5mb1thdHRyXSA9IGNvbF9kZWZb
YXR0cl07DQorICAgICAgICAgIH0NCisgICAgICAgICAgdmFyIGNvbCA9IGNlbGxJbmZvLmNvbDsN
CisNCisgICAgICAgICAgLy8gQUI6IHVzZSB0aGUgImdldFZhbHVlIiBtZXRob2Qgb2YgdGhlIHRh
YmxlTW9kZWwgdG8gZ2V0IHRoZSBjZWxsJ3MgdmFsdWUNCisgICAgICAgICAgLy8gd29ya2luZyBk
aXJlY3RseSBvbiB0aGUgInJvd0RhdGEiIG9iamVjdCAoLT4gY2VsbEluZm8ucm93RGF0YVtjb2xd
OykgaXMgbm90IGEgc29sdXRpb24NCisgICAgICAgICAgLy8gYmVjYXVzZSB5b3UgY2FuJ3Qgd29y
ayB3aXRoIHRoZSBjb2x1bW5JbmRleCAtPiB5b3UgaGF2ZSB0byB1c2UgdGhlIGNvbHVtbklkIG9m
IHRoZSBjb2x1bW5JbmRleA0KKyAgICAgICAgICAvLyBUaGlzIGlzIGV4YWN0bHkgd2hhdCB0aGUg
bWV0aG9kICJnZXRWYWx1ZSIgZG9lcw0KKyAgICAgICAgICBjZWxsSW5mby52YWx1ZSA9IHRhYmxl
TW9kZWwuZ2V0VmFsdWUoY29sLCByb3cpOw0KKyAgICAgICAgICB2YXIgY2VsbFJlbmRlcmVyID0g
Y29sdW1uTW9kZWwuZ2V0RGF0YUNlbGxSZW5kZXJlcihjb2wpOw0KKyAgICAgICAgICBjZWxsUmVu
ZGVyZXIuY3JlYXRlRGF0YUNlbGxIdG1sKGNlbGxJbmZvLCByb3dIdG1sKTsNCisgICAgICAgIH0N
CisgICAgICAgIHJvd0h0bWwucHVzaCgnPC9kaXY+Jyk7DQorDQorICAgICAgICB2YXIgcm93U3Ry
aW5nID0gcm93SHRtbC5qb2luKCIiKTsNCisNCisgICAgICAgIHRoaXMuX19yb3dDYWNoZVNldChy
b3csIHJvd1N0cmluZywgc2VsZWN0ZWQsIGZvY3VzZWRSb3cpOw0KKyAgICAgICAgcm93c0Fyci5w
dXNoKHJvd1N0cmluZyk7DQorICAgICAgfQ0KKyAgICAgIHJldHVybiByb3dzQXJyLmpvaW4oIiIp
Ow0KKyAgICB9LA0KKw0KKw0KKyAgICAvKioNCisgICAgICogU2Nyb2xscyB0aGUgcGFuZSdzIGNv
bnRlbnRzIGJ5IHRoZSBnaXZlbiBvZmZzZXQuDQorICAgICAqDQorICAgICAqIEBwYXJhbSByb3dP
ZmZzZXQge0ludGVnZXJ9IE51bWJlciBvZiBsaW5lcyB0byBzY3JvbGwuIFNjcm9sbGluZyB1cCBp
cw0KKyAgICAgKiAgICAgcmVwcmVzZW50ZWQgYnkgYSBuZWdhdGl2ZSBvZmZzZXQuDQorICAgICAq
Lw0KKyAgICBfc2Nyb2xsQ29udGVudCA6IGZ1bmN0aW9uKHJvd09mZnNldCkNCisgICAgew0KKyAg
ICAgIGlmICghdGhpcy5nZXRFbGVtZW50KCkuZmlyc3RDaGlsZCkgew0KKyAgICAgICAgdGhpcy5f
dXBkYXRlQWxsUm93cygpOw0KKyAgICAgICAgcmV0dXJuOw0KKyAgICAgIH0NCisNCisgICAgICB2
YXIgdGFibGVCb2R5ID0gdGhpcy5nZXRFbGVtZW50KCkuZmlyc3RDaGlsZDsNCisgICAgICB2YXIg
dGFibGVDaGlsZE5vZGVzID0gdGFibGVCb2R5LmNoaWxkTm9kZXM7DQorICAgICAgdmFyIHJvd0Nv
dW50ID0gdGhpcy5nZXRWaXNpYmxlUm93Q291bnQoKTsNCisgICAgICB2YXIgZmlyc3RSb3cgPSB0
aGlzLmdldEZpcnN0VmlzaWJsZVJvdygpOw0KKw0KKw0KKyAgICAgIHZhciBtb2RlbFJvd0NvdW50
ID0gdGhpcy5nZXRUYWJsZSgpLmdldFRhYmxlTW9kZWwoKS5nZXRSb3dDb3VudCgpOw0KKw0KKyAg
ICAgIC8vIGRvbid0IGhhbmRsZSB0aGlzIHNwZWNpYWwgY2FzZSBoZXJlDQorICAgICAgaWYgKGZp
cnN0Um93ICsgcm93Q291bnQgPiBtb2RlbFJvd0NvdW50KSB7DQorICAgICAgICB0aGlzLl91cGRh
dGVBbGxSb3dzKCk7DQorICAgICAgICByZXR1cm47DQorICAgICAgfQ0KKw0KKyAgICAgIC8vIHJl
bW92ZSBvbGQgbGluZXMNCisgICAgICB2YXIgcmVtb3ZlUm93QmFzZSA9IHJvd09mZnNldCA8IDAg
PyByb3dDb3VudCArIHJvd09mZnNldCA6IDA7DQorICAgICAgdmFyIGFkZFJvd0Jhc2UgPSByb3dP
ZmZzZXQgPCAwID8gMDogcm93Q291bnQgLSByb3dPZmZzZXQ7DQorDQorICAgICAgZm9yIChpPU1h
dGguYWJzKHJvd09mZnNldCktMTsgaT49MDsgaS0tKQ0KKyAgICAgIHsNCisgICAgICAgIHZhciBy
b3dFbGVtID0gdGFibGVDaGlsZE5vZGVzW3JlbW92ZVJvd0Jhc2VdOw0KKyAgICAgICAgdHJ5IHsN
CisgICAgICAgICAgdGFibGVCb2R5LnJlbW92ZUNoaWxkKHJvd0VsZW0pOw0KKyAgICAgICAgfSBj
YXRjaChlKSB7DQorICAgICAgICAgIGJyZWFrOw0KKyAgICAgICAgfQ0KKyAgICAgIH0NCisNCisg
ICAgICAvLyByZW5kZXIgbmV3IGxpbmVzDQorICAgICAgaWYgKCF0aGlzLl90YWJsZUNvbnRhaW5l
cikgew0KKyAgICAgICAgdGhpcy5fdGFibGVDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVt
ZW50KCJkaXYiKTsNCisgICAgICB9DQorICAgICAgdmFyIHRhYmxlRHVtbXkgPSAnPGRpdj4nOw0K
KyAgICAgIHRhYmxlRHVtbXkgKz0gdGhpcy5fZ2V0Um93c0h0bWwoZmlyc3RSb3cgKyBhZGRSb3dC
YXNlLCBNYXRoLmFicyhyb3dPZmZzZXQpKTsNCisgICAgICB0YWJsZUR1bW15ICs9ICc8L2Rpdj4n
Ow0KKyAgICAgIHRoaXMuX3RhYmxlQ29udGFpbmVyLmlubmVySFRNTCA9IHRhYmxlRHVtbXk7DQor
ICAgICAgdmFyIG5ld1RhYmxlUm93cyA9IHRoaXMuX3RhYmxlQ29udGFpbmVyLmZpcnN0Q2hpbGQu
Y2hpbGROb2RlczsNCisNCisgICAgICAvLyBhcHBlbmQgbmV3IGxpbmVzDQorICAgICAgaWYgKHJv
d09mZnNldCA+IDApDQorICAgICAgew0KKyAgICAgICAgZm9yICh2YXIgaT1uZXdUYWJsZVJvd3Mu
bGVuZ3RoLTE7IGk+PTA7IGktLSkNCisgICAgICAgIHsNCisgICAgICAgICAgdmFyIHJvd0VsZW0g
PSBuZXdUYWJsZVJvd3NbMF07DQorICAgICAgICAgIHRhYmxlQm9keS5hcHBlbmRDaGlsZChyb3dF
bGVtKTsNCisgICAgICAgIH0NCisgICAgICB9DQorICAgICAgZWxzZQ0KKyAgICAgIHsNCisgICAg
ICAgIGZvciAodmFyIGk9bmV3VGFibGVSb3dzLmxlbmd0aC0xOyBpPj0wOyBpLS0pDQorICAgICAg
ICB7DQorICAgICAgICAgIHZhciByb3dFbGVtID0gbmV3VGFibGVSb3dzW25ld1RhYmxlUm93cy5s
ZW5ndGgtMV07DQorICAgICAgICAgIHRhYmxlQm9keS5pbnNlcnRCZWZvcmUocm93RWxlbSwgdGFi
bGVCb2R5LmZpcnN0Q2hpbGQpOw0KKyAgICAgICAgfQ0KKyAgICAgIH0NCisNCisgICAgICAvLyB1
cGRhdGUgZm9jdXMgaW5kaWNhdG9yDQorICAgICAgdGhpcy5fdXBkYXRlUm93U3R5bGVzKHRoaXMu
X2ZvY3VzZWRSb3cgLSByb3dPZmZzZXQpOw0KKyAgICAgIHRoaXMuX3VwZGF0ZVJvd1N0eWxlcyh0
aGlzLl9mb2N1c2VkUm93KTsNCisNCisgICAgICAvLyBmb3JjZSBpbW1lZGlhdGUgbGF5b3V0aW5n
DQorICAgICAgLy8gdGhpcyBwcmV2ZW50cyBGaXJlZm94IGZyb20gZmxpY2tlcmluZw0KKyAgICAg
IGlmIChxeC5jb3JlLlZhcmlhbnQuaXNTZXQoInF4LmNsaWVudCIsICJnZWNrbyIpKSB7DQorICAg
ICAgICByb3dFbGVtLm9mZnNldEhlaWdodDsNCisgICAgICB9DQorICAgIH0sDQorDQorDQorICAg
IC8qKg0KKyAgICAgKiBVcGRhdGVzIHRoZSBjb250ZW50IG9mIHRoZSBwYW5lIChpbXBsZW1lbnRl
ZCB1c2luZyBhcnJheSBqb2lucykuDQorICAgICAqLw0KKyAgICBfdXBkYXRlQWxsUm93cyA6IGZ1
bmN0aW9uKCkNCisgICAgew0KKyAgICAgIHZhciB0YWJsZSA9IHRoaXMuZ2V0VGFibGUoKTsNCisN
CisgICAgICB2YXIgdGFibGVNb2RlbCA9IHRhYmxlLmdldFRhYmxlTW9kZWwoKTsNCisgICAgICB2
YXIgcGFuZU1vZGVsID0gdGhpcy5nZXRQYW5lU2Nyb2xsZXIoKS5nZXRUYWJsZVBhbmVNb2RlbCgp
Ow0KKw0KKyAgICAgIHZhciBjb2xDb3VudCA9IHBhbmVNb2RlbC5nZXRDb2x1bW5Db3VudCgpOw0K
KyAgICAgIHZhciByb3dIZWlnaHQgPSB0YWJsZS5nZXRSb3dIZWlnaHQoKTsNCisgICAgICB2YXIg
Zmlyc3RSb3cgPSB0aGlzLmdldEZpcnN0VmlzaWJsZVJvdygpOw0KKw0KKyAgICAgIHZhciByb3dD
b3VudCA9IHRoaXMuZ2V0VmlzaWJsZVJvd0NvdW50KCk7DQorICAgICAgdmFyIG1vZGVsUm93Q291
bnQgPSB0YWJsZU1vZGVsLmdldFJvd0NvdW50KCk7DQorDQorICAgICAgaWYgKGZpcnN0Um93ICsg
cm93Q291bnQgPiBtb2RlbFJvd0NvdW50KSB7DQorICAgICAgICByb3dDb3VudCA9IE1hdGgubWF4
KDAsIG1vZGVsUm93Q291bnQgLSBmaXJzdFJvdyk7DQorICAgICAgfQ0KKw0KKyAgICAgIHZhciBy
b3dXaWR0aCA9IHBhbmVNb2RlbC5nZXRUb3RhbFdpZHRoKCk7DQorDQorICAgICAgdmFyIGh0bWxB
cnIgPSBbDQorICAgICAgICAiPGRpdiBzdHlsZT0nIiwNCisgICAgICAgICJ3aWR0aDogIiwgcm93
V2lkdGgsICJweDsiLA0KKyAgICAgICAgImxpbmUtaGVpZ2h0OiAiLCByb3dIZWlnaHQsICJweDsi
LA0KKyAgICAgICAgIm92ZXJmbG93OiBoaWRkZW47IiwNCisgICAgICAgICJmb250LXNpemU6IDEx
cHg7IiwNCisgICAgICAgICJmb250LWZhbWlseTogXCJTZWdvZSBVSVwiLCBDb3JiZWwsIENhbGli
cmksIFRhaG9tYSwgXCJMdWNpZGEgU2FucyBVbmljb2RlXCIsIHNhbnMtc2VyaWY7IiwNCisgICAg
ICAgICInPiIsDQorICAgICAgICB0aGlzLl9nZXRSb3dzSHRtbChmaXJzdFJvdywgcm93Q291bnQp
LA0KKyAgICAgICAgIjwvZGl2PiINCisgICAgICBdOw0KKw0KKyAgICAgIHZhciBlbGVtID0gdGhp
cy5nZXRFbGVtZW50KCk7DQorICAgICAgdmFyIGRhdGEgPSBodG1sQXJyLmpvaW4oIiIpOw0KKw0K
KyAgICAgIC8vdGhpcy5kZWJ1ZygiPj4+IiArIGRhdGEgKyAiPDw8IikNCisNCisgICAgICB2YXIg
c2VsZiA9IHRoaXM7DQorICAgICAgdGhpcy5fbGF5b3V0UGVuZGluZyA9IHdpbmRvdy5zZXRUaW1l
b3V0KGZ1bmN0aW9uKCkNCisgICAgICB7DQorICAgICAgICBlbGVtLmlubmVySFRNTCA9IGRhdGE7
DQorDQorICAgICAgICAvLyBmb3JjZSBpbW1lZGlhdGUgbGF5b3V0aW5nDQorICAgICAgICAvLyB0
aGlzIHByZXZlbnRzIEZpcmVmb3ggZnJvbSBmbGlja2VyaW5nDQorICAgICAgICBpZiAocXguY29y
ZS5WYXJpYW50LmlzU2V0KCJxeC5jbGllbnQiLCAiZ2Vja28iKSkgew0KKyAgICAgICAgICBlbGVt
LmNoaWxkTm9kZXNbMF0ub2Zmc2V0SGVpZ2h0Ow0KKyAgICAgICAgfQ0KKyAgICAgICAgc2VsZi5f
bGF5b3V0UGVuZGluZyA9IG51bGw7DQorICAgICAgfSwgMTApOw0KKw0KKyAgICAgIC8qDQorICAg
ICAgZWxlbS5pbm5lckhUTUwgPSBkYXRhOw0KKw0KKyAgICAgIC8vIGZvcmNlIGltbWVkaWF0ZSBs
YXlvdXRpbmcNCisgICAgICAvLyB0aGlzIHByZXZlbnRzIEZpcmVmb3ggZnJvbSBmbGlja2VyaW5n
DQorICAgICAgaWYgKHF4LmNvcmUuVmFyaWFudC5pc1NldCgicXguY2xpZW50IiwgImdlY2tvIikp
IHsNCisgICAgICAgIGVsZW0uY2hpbGROb2Rlc1swXS5vZmZzZXRIZWlnaHQ7DQorICAgICAgfQ0K
KyAgICAgICovDQorDQorICAgICAgdGhpcy5zZXRIZWlnaHQocm93Q291bnQgKiByb3dIZWlnaHQp
Ow0KKw0KKyAgICAgIHRoaXMuX2xhc3RDb2xDb3VudCA9IGNvbENvdW50Ow0KKyAgICAgIHRoaXMu
X2xhc3RSb3dDb3VudCA9IHJvd0NvdW50Ow0KKyAgICB9DQorDQorICB9LA0KKw0KKw0KKw0KKw0K
KyAgLyoNCisgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQorICAgICBERVNUUlVDVE9SDQorICAqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKg0KKyAgKi8NCisNCisgIGRlc3RydWN0IDogZnVuY3Rpb24oKSB7DQor
ICAgIHRoaXMuX2Rpc3Bvc2VPYmplY3RzKCJfcGFuZVNjcm9sbGVyIik7DQorICB9DQorfSk7DQo=
</data>

          </attachment>
      

    </bug>