<bug>
          <bug_id>4743</bug_id>
          
          <creation_ts>2011-03-05 20:33:00 +0100</creation_ts>
          <short_desc>enabled editing/rename of node labels</short_desc>
          <delta_ts>2014-02-17 18:53:15 +0100</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>framework</product>
          <component>desktop.treevirtual</component>
          <version>master</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          
          
          
          <priority>P4</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>unspecified</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>cheef-daniel</reporter>
          <assigned_to name="Derrell Lipman">derrell.lipman</assigned_to>
          
          <qa_contact name="Derrell Lipman">derrell.lipman</qa_contact>
          <cf_browser>---</cf_browser>
          

      

      

      

          <long_desc isprivate="0">
            <commentid>23092</commentid>
              <attachid>906</attachid>
            <who name="">cheef-daniel</who>
            <bug_when>2011-03-05 20:33:52 +0100</bug_when>
            <thetext>Created attachment 906
enabled editing of virtual tree node labels patchfile

This patch should enable the renaming of virtual tree node labels.

It is using the same way the table does:
-first set on treevirtual&#39;s datamodel setColumnEditable(0, true) or setEditable(true)
-By double clicking or pressing F2 you can rename a label by using the celleditor
-It raises event dataChanged when finished
-Cancel process by ESC...
-Or clicking somewhere

Last thing is not working properly, but this bug is in tables editing too: it doesn&#39;t cancel editing when you click outside of table or tree, should be fixed.

To get the correct starting position of the celleditor I had to insert new variable labelPos into qx.ui.treevirtual.MTreePrimitive, this pos is calculated and stored by qx.ui.treevirtual.SimpleTreeDataCellRenderer._addLabel(), maybe you find better way of determining the pos in qx.ui.table.pane.Scroller.startEditing() like I did.

Hope I didn&#39;t break anything else. You should do some more tests before applying this patch.

To apply this patch you need my previous patch first from
http://bugzilla.qooxdoo.org/show_bug.cgi?id=4739</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>23100</commentid>
            <who name="Martin Wittemann">martin.wittemann</who>
            <bug_when>2011-03-07 09:08:05 +0100</bug_when>
            <thetext>Derrell, could you review this patch?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>23118</commentid>
            <who name="Derrell Lipman">derrell.lipman</who>
            <bug_when>2011-03-07 22:14:28 +0100</bug_when>
            <thetext>Yes, I&#39;ll be glad to review it, but it&#39;s going to have to wait a while until I have some free bandwidth.

Derrell</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>23126</commentid>
            <who name="Martin Wittemann">martin.wittemann</who>
            <bug_when>2011-03-08 08:17:52 +0100</bug_when>
            <thetext>(In reply to comment #2)
&gt; Yes, I&#39;ll be glad to review it, but it&#39;s going to have to wait a while until I
&gt; have some free bandwidth.
&gt; 
&gt; Derrell

Thank you very much.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <commentid>35101</commentid>
            <who name="Andreas Ecker">qooxdoo</who>
            <bug_when>2014-02-17 18:53:15 +0100</bug_when>
            <thetext>Closed outdated issue as wontfix, as bug became stale without feedback from assignee.</thetext>
          </long_desc>
      
          <attachment isobsolete="0" ispatch="1" isprivate="0" isurl="0">
            <attachid>906</attachid>
            <date>2011-03-05 20:33:00 +0100</date>
            <delta_ts>2011-03-05 20:33:52 +0100</delta_ts>
            <desc>enabled editing of virtual tree node labels patchfile</desc>
            <filename>0002-enabled-editing-of-virtual-tree-node-labels.patch</filename>
            <type>text/plain</type>
            <size>12203</size>
            <attacher>cheef-daniel</attacher>
            
              <data encoding="base64">RnJvbSBhOGNjNmJhYmVmN2U4MGRiNDM4MmNlOGFjMzU4OGZhMzE2OGMyY2ZmIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBYLUNvZGVyIDxjaGVlZi1kYW5pZWxAZnJlZW5ldC5kZT4KRGF0
ZTogU2F0LCA1IE1hciAyMDExIDE4OjI5OjUzICswMTAwClN1YmplY3Q6IFtQQVRDSCAyLzJdIGVu
YWJsZWQgZWRpdGluZyBvZiB2aXJ0dWFsIHRyZWUgbm9kZSBsYWJlbHMKCi0tLQogLi4uL3NvdXJj
ZS9jbGFzcy9xeC91aS90YWJsZS9wYW5lL1Njcm9sbGVyLmpzICAgICAgfCAgIDM1ICsrKystCiAu
Li4vY2xhc3MvcXgvdWkvdHJlZXZpcnR1YWwvTVRyZWVQcmltaXRpdmUuanMgICAgICB8ICAgIDYg
Ky0KIC4uLi91aS90cmVldmlydHVhbC9TaW1wbGVUcmVlRGF0YUNlbGxSZW5kZXJlci5qcyAgIHwg
ICAgMyArCiAuLi4vY2xhc3MvcXgvdWkvdHJlZXZpcnR1YWwvU2ltcGxlVHJlZURhdGFNb2RlbC5q
cyB8ICAgIDYgLQogLi4uL3NvdXJjZS9jbGFzcy9xeC91aS90cmVldmlydHVhbC9UcmVlVmlydHVh
bC5qcyAgfCAgMTczICsrKysrKysrKysrLS0tLS0tLS0KIDUgZmlsZXMgY2hhbmdlZCwgMTQwIGlu
c2VydGlvbnMoKyksIDgzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3Fvb3hkb28vZnJhbWV3
b3JrL3NvdXJjZS9jbGFzcy9xeC91aS90YWJsZS9wYW5lL1Njcm9sbGVyLmpzIGIvcW9veGRvby9m
cmFtZXdvcmsvc291cmNlL2NsYXNzL3F4L3VpL3RhYmxlL3BhbmUvU2Nyb2xsZXIuanMKaW5kZXgg
MWU4NjkyMC4uZmRhMDgyYSAxMDA2NDQKLS0tIGEvcW9veGRvby9mcmFtZXdvcmsvc291cmNlL2Ns
YXNzL3F4L3VpL3RhYmxlL3BhbmUvU2Nyb2xsZXIuanMKKysrIGIvcW9veGRvby9mcmFtZXdvcmsv
c291cmNlL2NsYXNzL3F4L3VpL3RhYmxlL3BhbmUvU2Nyb2xsZXIuanMKQEAgLTE3ODMsNyArMTc4
MywxNSBAQCBxeC5DbGFzcy5kZWZpbmUoInF4LnVpLnRhYmxlLnBhbmUuU2Nyb2xsZXIiLAogICAg
ICAgKSB7CiAgICAgICAgIHZhciByb3cgPSB0aGlzLl9fZm9jdXNlZFJvdzsKICAgICAgICAgdmFy
IHhQb3MgPSB0aGlzLmdldFRhYmxlUGFuZU1vZGVsKCkuZ2V0WChjb2wpOwotICAgICAgICB2YXIg
dmFsdWUgPSB0YWJsZU1vZGVsLmdldFZhbHVlKGNvbCwgcm93KTsKKyAgICAgICAgLy8gaXMgdGhp
cyBhIHRyZWUgY29sdW1uPworICAgICAgICBpZih0YWJsZU1vZGVsLmdldFRyZWVDb2x1bW4oKSA9
PSBjb2wpCisgICAgICAgIHsKKyAgICAgICAgICB2YXIgdmFsdWUgPSB0YWJsZU1vZGVsLmdldFZh
bHVlKGNvbCwgcm93KS5sYWJlbDsKKyAgICAgICAgfQorICAgICAgICBlbHNlCisgICAgICAgIHsK
KyAgICAgICAgICB2YXIgdmFsdWUgPSB0YWJsZU1vZGVsLmdldFZhbHVlKGNvbCwgcm93KTsKKyAg
ICAgICAgfQogCiAgICAgICAgIC8vIHNjcm9sbCBjZWxsIGludG8gdmlldwogICAgICAgICB0aGlz
LnNjcm9sbENlbGxWaXNpYmxlKHhQb3MsIHJvdyk7CkBAIC0xODQ0LDcgKzE4NTIsMTcgQEAgcXgu
Q2xhc3MuZGVmaW5lKCJxeC51aS50YWJsZS5wYW5lLlNjcm9sbGVyIiwKICAgICAgICAgewogICAg
ICAgICAgIC8vIFRoZSBjZWxsIGVkaXRvciBpcyBhIHRyYWRpdGlvbmFsIGluLXBsYWNlIGVkaXRv
ci4KICAgICAgICAgICB2YXIgc2l6ZSA9IHRoaXMuX19mb2N1c0luZGljYXRvci5nZXRJbm5lclNp
emUoKTsKLSAgICAgICAgICB0aGlzLl9fY2VsbEVkaXRvci5zZXRVc2VyQm91bmRzKDAsIDAsIHNp
emUud2lkdGgsIHNpemUuaGVpZ2h0KTsKKyAgICAgICAgICAKKyAgICAgICAgICAvLyBpcyB0aGlz
IGEgdHJlZSBjb2x1bW4/CisgICAgICAgICAgaWYodGFibGVNb2RlbC5nZXRUcmVlQ29sdW1uKCkg
PT0gY29sKQorICAgICAgICAgIHsKKyAgICAgICAgICAgIC8vIGxhYmVsIHBvcyBpcyA+IDAsIHNv
IHNldCBYIHVzaW5nIGxhYmVsUG9zCisgICAgICAgICAgICB0aGlzLl9fY2VsbEVkaXRvci5zZXRV
c2VyQm91bmRzKHRhYmxlTW9kZWwuZ2V0VmFsdWUoY29sLCByb3cpLmxhYmVsUG9zLCAwLCBzaXpl
LndpZHRoLCBzaXplLmhlaWdodCk7CisgICAgICAgICAgfQorICAgICAgICAgIGVsc2UKKyAgICAg
ICAgICB7CisgICAgICAgICAgICB0aGlzLl9fY2VsbEVkaXRvci5zZXRVc2VyQm91bmRzKDAsIDAs
IHNpemUud2lkdGgsIHNpemUuaGVpZ2h0KTsKKyAgICAgICAgICB9CiAKICAgICAgICAgICAvLyBw
cmV2ZW50IGNsaWNrIGV2ZW50IGZyb20gYnViYmxpbmcgdXAgdG8gdGhlIHRhYmxlCiAgICAgICAg
ICAgdGhpcy5fX2ZvY3VzSW5kaWNhdG9yLmFkZExpc3RlbmVyKCJtb3VzZWRvd24iLCBmdW5jdGlv
bihlKQpAQCAtMTkwMCw3ICsxOTE4LDE4IEBAIHF4LkNsYXNzLmRlZmluZSgicXgudWkudGFibGUu
cGFuZS5TY3JvbGxlciIsCiAgICAgICB7CiAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX19jZWxs
RWRpdG9yRmFjdG9yeS5nZXRDZWxsRWRpdG9yVmFsdWUodGhpcy5fX2NlbGxFZGl0b3IpOwogICAg
ICAgICB2YXIgb2xkVmFsdWUgPSB0aGlzLmdldFRhYmxlKCkuZ2V0VGFibGVNb2RlbCgpLmdldFZh
bHVlKHRoaXMuX19mb2N1c2VkQ29sLCB0aGlzLl9fZm9jdXNlZFJvdyk7Ci0gICAgICAgIHRoaXMu
Z2V0VGFibGUoKS5nZXRUYWJsZU1vZGVsKCkuc2V0VmFsdWUodGhpcy5fX2ZvY3VzZWRDb2wsIHRo
aXMuX19mb2N1c2VkUm93LCB2YWx1ZSk7CisgICAgICAgIAorICAgICAgICBpZih0aGlzLmdldFRh
YmxlKCkuZ2V0VGFibGVNb2RlbCgpLmdldFRyZWVDb2x1bW4oKSA9PSB0aGlzLl9fZm9jdXNlZENv
bCkKKyAgICAgICAgeworICAgICAgICAgIHZhciBub2RlID0gdGhpcy5nZXRUYWJsZSgpLmdldFRh
YmxlTW9kZWwoKS5nZXRWYWx1ZSh0aGlzLl9fZm9jdXNlZENvbCwgdGhpcy5fX2ZvY3VzZWRSb3cp
OworICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IG5vZGUubGFiZWw7CisgICAgICAgICAgbm9kZS5s
YWJlbCA9IHZhbHVlOworICAgICAgICB9CisgICAgICAgIGVsc2UKKyAgICAgICAgeworICAgICAg
ICAgIHZhciBvbGRWYWx1ZSA9IHRoaXMuZ2V0VGFibGUoKS5nZXRUYWJsZU1vZGVsKCkuZ2V0VmFs
dWUodGhpcy5fX2ZvY3VzZWRDb2wsIHRoaXMuX19mb2N1c2VkUm93KTsKKyAgICAgICAgICB0aGlz
LmdldFRhYmxlKCkuZ2V0VGFibGVNb2RlbCgpLnNldFZhbHVlKHRoaXMuX19mb2N1c2VkQ29sLCB0
aGlzLl9fZm9jdXNlZFJvdywgdmFsdWUpOworICAgICAgICB9CiAKICAgICAgICAgdGhpcy5fX3Rh
YmxlLmZvY3VzKCk7CiAKZGlmZiAtLWdpdCBhL3Fvb3hkb28vZnJhbWV3b3JrL3NvdXJjZS9jbGFz
cy9xeC91aS90cmVldmlydHVhbC9NVHJlZVByaW1pdGl2ZS5qcyBiL3Fvb3hkb28vZnJhbWV3b3Jr
L3NvdXJjZS9jbGFzcy9xeC91aS90cmVldmlydHVhbC9NVHJlZVByaW1pdGl2ZS5qcwppbmRleCA5
ZGRiZGE3Li4yOWE2ZTExIDEwMDY0NAotLS0gYS9xb294ZG9vL2ZyYW1ld29yay9zb3VyY2UvY2xh
c3MvcXgvdWkvdHJlZXZpcnR1YWwvTVRyZWVQcmltaXRpdmUuanMKKysrIGIvcW9veGRvby9mcmFt
ZXdvcmsvc291cmNlL2NsYXNzL3F4L3VpL3RyZWV2aXJ0dWFsL01UcmVlUHJpbWl0aXZlLmpzCkBA
IC0xNzIsNyArMTcyLDExIEBAIHF4Lk1peGluLmRlZmluZSgicXgudWkudHJlZXZpcnR1YWwuTVRy
ZWVQcmltaXRpdmUiLAogICAgICAgICBpY29uICAgICAgICAgICA6IGljb24sCiAgICAgICAgIGlj
b25TZWxlY3RlZCAgIDogaWNvblNlbGVjdGVkLAogICAgICAgICBjaGlsZHJlbiAgICAgICA6IFsg
XSwKLSAgICAgICAgY29sdW1uRGF0YSAgICAgOiBbIF0KKyAgICAgICAgY29sdW1uRGF0YSAgICAg
OiBbIF0sCisKKyAgICAgICAgLy8gaW50ZXJuYWwgZGF0YQorICAgICAgICAvLyBwb3NpdGlvbiBv
ZiBsYWJlbCwgaXMgdXNlZCBmb3IgcG9zaXRpb25pbmcgdGhlIGNlbGxlZGl0b3IsIHNldCBieSBj
ZWxscmVuZGVyZXIKKyAgICAgICAgbGFiZWxQb3MgICAgICA6IDAKICAgICAgIH07CiAKICAgICAg
IC8vIEFkZCB0aGlzIG5vZGUgdG8gdGhlIGFycmF5CmRpZmYgLS1naXQgYS9xb294ZG9vL2ZyYW1l
d29yay9zb3VyY2UvY2xhc3MvcXgvdWkvdHJlZXZpcnR1YWwvU2ltcGxlVHJlZURhdGFDZWxsUmVu
ZGVyZXIuanMgYi9xb294ZG9vL2ZyYW1ld29yay9zb3VyY2UvY2xhc3MvcXgvdWkvdHJlZXZpcnR1
YWwvU2ltcGxlVHJlZURhdGFDZWxsUmVuZGVyZXIuanMKaW5kZXggZmViZmE5ZC4uZWEyYTI2OCAx
MDA2NDQKLS0tIGEvcW9veGRvby9mcmFtZXdvcmsvc291cmNlL2NsYXNzL3F4L3VpL3RyZWV2aXJ0
dWFsL1NpbXBsZVRyZWVEYXRhQ2VsbFJlbmRlcmVyLmpzCisrKyBiL3Fvb3hkb28vZnJhbWV3b3Jr
L3NvdXJjZS9jbGFzcy9xeC91aS90cmVldmlydHVhbC9TaW1wbGVUcmVlRGF0YUNlbGxSZW5kZXJl
ci5qcwpAQCAtNDk4LDYgKzQ5OCw5IEBAIHF4LkNsYXNzLmRlZmluZSgicXgudWkudHJlZXZpcnR1
YWwuU2ltcGxlVHJlZURhdGFDZWxsUmVuZGVyZXIiLAogICAgIHsKICAgICAgIHZhciBub2RlID0g
Y2VsbEluZm8udmFsdWU7CiAgICAgICB2YXIgbGFiZWwgPSBub2RlLmxhYmVsOworICAgICAgCisg
ICAgICAvLyBzYXZlIGxhYmVsIHBvcyAoZm9yIHBvc2l0aW9uIHRoZSBjZWxsZWRpdG9yKQorICAg
ICAgbm9kZS5sYWJlbFBvcyA9IHBvczsKIAogICAgICAgaWYgKHF4LmNvcmUuVmFyaWFudC5pc1Nl
dCgicXguZHlubG9jYWxlIiwgIm9uIikpIHsKICAgICAgICAgaWYgKGxhYmVsICYmIGxhYmVsLnRy
YW5zbGF0ZSkgewpkaWZmIC0tZ2l0IGEvcW9veGRvby9mcmFtZXdvcmsvc291cmNlL2NsYXNzL3F4
L3VpL3RyZWV2aXJ0dWFsL1NpbXBsZVRyZWVEYXRhTW9kZWwuanMgYi9xb294ZG9vL2ZyYW1ld29y
ay9zb3VyY2UvY2xhc3MvcXgvdWkvdHJlZXZpcnR1YWwvU2ltcGxlVHJlZURhdGFNb2RlbC5qcwpp
bmRleCBlODAwMzI4Li40M2ZjMTllIDEwMDY0NAotLS0gYS9xb294ZG9vL2ZyYW1ld29yay9zb3Vy
Y2UvY2xhc3MvcXgvdWkvdHJlZXZpcnR1YWwvU2ltcGxlVHJlZURhdGFNb2RlbC5qcworKysgYi9x
b294ZG9vL2ZyYW1ld29yay9zb3VyY2UvY2xhc3MvcXgvdWkvdHJlZXZpcnR1YWwvU2ltcGxlVHJl
ZURhdGFNb2RlbC5qcwpAQCAtMjUxLDEyICsyNTEsNiBAQCBxeC5DbGFzcy5kZWZpbmUoInF4LnVp
LnRyZWV2aXJ0dWFsLlNpbXBsZVRyZWVEYXRhTW9kZWwiLAogICAgIC8vIG92ZXJyaWRkZW4KICAg
ICBpc0NvbHVtbkVkaXRhYmxlIDogZnVuY3Rpb24oY29sdW1uSW5kZXgpCiAgICAgewotICAgICAg
Ly8gVGhlIHRyZWUgY29sdW1uIGlzIG5vdCBlZGl0YWJsZQotICAgICAgaWYgKGNvbHVtbkluZGV4
ID09IHRoaXMuX3RyZWVDb2x1bW4pCi0gICAgICB7Ci0gICAgICAgIHJldHVybiBmYWxzZTsKLSAg
ICAgIH0KLQogICAgICAgcmV0dXJuKHRoaXMuX19lZGl0YWJsZUNvbEFycgogICAgICAgICAgICAg
ID8gdGhpcy5fX2VkaXRhYmxlQ29sQXJyW2NvbHVtbkluZGV4XSA9PSB0cnVlCiAgICAgICAgICAg
ICAgOiBmYWxzZSk7CmRpZmYgLS1naXQgYS9xb294ZG9vL2ZyYW1ld29yay9zb3VyY2UvY2xhc3Mv
cXgvdWkvdHJlZXZpcnR1YWwvVHJlZVZpcnR1YWwuanMgYi9xb294ZG9vL2ZyYW1ld29yay9zb3Vy
Y2UvY2xhc3MvcXgvdWkvdHJlZXZpcnR1YWwvVHJlZVZpcnR1YWwuanMKaW5kZXggYjVkODk3Mi4u
N2QwM2ZkZCAxMDA2NDQKLS0tIGEvcW9veGRvby9mcmFtZXdvcmsvc291cmNlL2NsYXNzL3F4L3Vp
L3RyZWV2aXJ0dWFsL1RyZWVWaXJ0dWFsLmpzCisrKyBiL3Fvb3hkb28vZnJhbWV3b3JrL3NvdXJj
ZS9jbGFzcy9xeC91aS90cmVldmlydHVhbC9UcmVlVmlydHVhbC5qcwpAQCAtNjUwLDk3ICs2NTAs
MTI0IEBAIHF4LkNsYXNzLmRlZmluZSgicXgudWkudHJlZXZpcnR1YWwuVHJlZVZpcnR1YWwiLAog
ICAgICAgdmFyIGNvbnN1bWVkID0gZmFsc2U7CiAgICAgICB2YXIgbW9kaWZpZXJzID0gZXZ0Lmdl
dE1vZGlmaWVycygpOwogCi0gICAgICBpZiAobW9kaWZpZXJzID09IDApCisgICAgICBpZiAodGhp
cy5pc0VkaXRpbmcoKSkKICAgICAgIHsKLSAgICAgICAgc3dpdGNoKGlkZW50aWZpZXIpCisgICAg
ICAgIC8vIEVkaXRpbmcgbW9kZQorICAgICAgICBpZiAoZXZ0LmdldE1vZGlmaWVycygpID09IDAp
CiAgICAgICAgIHsKLSAgICAgICAgICBjYXNlICJFbnRlciI6Ci0gICAgICAgICAgICAvLyBHZXQg
dGhlIGRhdGEgbW9kZWwKLSAgICAgICAgICAgIHZhciBkbSA9IHRoaXMuZ2V0RGF0YU1vZGVsKCk7
CisgICAgICAgICAgc3dpdGNoKGlkZW50aWZpZXIpCisgICAgICAgICAgeworICAgICAgICAgICAg
Y2FzZSAiRW50ZXIiOgorICAgICAgICAgICAgICB0aGlzLnN0b3BFZGl0aW5nKCk7CisgICAgICAg
ICAgICAgIHRoaXMuZm9jdXMoKTsKKyAgICAgICAgICAgICAgY29uc3VtZWQgPSB0cnVlOworICAg
ICAgICAgICAgICBicmVhazsKKworICAgICAgICAgICAgY2FzZSAiRXNjYXBlIjoKKyAgICAgICAg
ICAgICAgdGhpcy5jYW5jZWxFZGl0aW5nKCk7CisgICAgICAgICAgICAgIHRoaXMuZm9jdXMoKTsK
KyAgICAgICAgICAgICAgYnJlYWs7CisKKyAgICAgICAgICAgIGRlZmF1bHQ6CisgICAgICAgICAg
ICAgIGNvbnN1bWVkID0gZmFsc2U7CisgICAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgIH0K
KyAgICAgICAgfQorCisgICAgICB9CisgICAgICBlbHNlCisgICAgICB7CisgICAgICAgIGlmICht
b2RpZmllcnMgPT0gMCkKKyAgICAgICAgeworICAgICAgICAgIHN3aXRjaChpZGVudGlmaWVyKQor
ICAgICAgICAgIHsKKyAgICAgICAgICAgIGNhc2UgIkVudGVyIjoKKyAgICAgICAgICAgICAgLy8g
R2V0IHRoZSBkYXRhIG1vZGVsCisgICAgICAgICAgICAgIHZhciBkbSA9IHRoaXMuZ2V0RGF0YU1v
ZGVsKCk7CisKKyAgICAgICAgICAgICAgdmFyIGZvY3VzZWRDb2wgPSB0aGlzLmdldEZvY3VzZWRD
b2x1bW4oKTsKKyAgICAgICAgICAgICAgdmFyIHRyZWVDb2wgPSBkbS5nZXRUcmVlQ29sdW1uKCk7
CisKKyAgICAgICAgICAgICAgaWYgKGZvY3VzZWRDb2wgPT0gdHJlZUNvbCkKKyAgICAgICAgICAg
ICAgeworICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgZm9jdXNlZCBub2RlCisgICAgICAgICAg
ICAgICAgdmFyIGZvY3VzZWRSb3cgPSB0aGlzLmdldEZvY3VzZWRSb3coKTsKKyAgICAgICAgICAg
ICAgICB2YXIgbm9kZSA9IGRtLmdldE5vZGUoZm9jdXNlZFJvdyk7CisKKyAgICAgICAgICAgICAg
ICBpZiAoISBub2RlLmJIaWRlT3BlbkNsb3NlICYmCisgICAgICAgICAgICAgICAgICAgIG5vZGUu
dHlwZSAhPSBxeC51aS50cmVldmlydHVhbC5TaW1wbGVUcmVlRGF0YU1vZGVsLlR5cGUuTEVBRikK
KyAgICAgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgICBkbS5zZXRTdGF0ZShub2RlLCB7
IGJPcGVuZWQgOiAhIG5vZGUuYk9wZW5lZCB9KTsKKyAgICAgICAgICAgICAgICB9CisKKyAgICAg
ICAgICAgICAgICBjb25zdW1lZCA9IHRydWU7CisgICAgICAgICAgICAgIH0KKyAgICAgICAgICAg
ICAgYnJlYWs7CiAKLSAgICAgICAgICAgIHZhciBmb2N1c2VkQ29sID0gdGhpcy5nZXRGb2N1c2Vk
Q29sdW1uKCk7Ci0gICAgICAgICAgICB2YXIgdHJlZUNvbCA9IGRtLmdldFRyZWVDb2x1bW4oKTsK
KyAgICAgICAgICAgIGNhc2UgIkxlZnQiOgorICAgICAgICAgICAgICAvLyBHZXQgdGhlIGRhdGEg
bW9kZWwKKyAgICAgICAgICAgICAgdmFyIGRtID0gdGhpcy5nZXREYXRhTW9kZWwoKTsKIAotICAg
ICAgICAgICAgaWYgKGZvY3VzZWRDb2wgPT0gdHJlZUNvbCkKLSAgICAgICAgICAgIHsKICAgICAg
ICAgICAgICAgLy8gR2V0IHRoZSBmb2N1c2VkIG5vZGUKICAgICAgICAgICAgICAgdmFyIGZvY3Vz
ZWRSb3cgPSB0aGlzLmdldEZvY3VzZWRSb3coKTsKKyAgICAgICAgICAgICAgdmFyIHRyZWVDb2wg
PSBkbS5nZXRUcmVlQ29sdW1uKCk7CiAgICAgICAgICAgICAgIHZhciBub2RlID0gZG0uZ2V0Tm9k
ZShmb2N1c2VkUm93KTsKIAotICAgICAgICAgICAgICBpZiAoISBub2RlLmJIaWRlT3BlbkNsb3Nl
ICYmCi0gICAgICAgICAgICAgICAgICBub2RlLnR5cGUgIT0gcXgudWkudHJlZXZpcnR1YWwuU2lt
cGxlVHJlZURhdGFNb2RlbC5UeXBlLkxFQUYpCisgICAgICAgICAgICAgIC8vIElmIGl0J3MgYW4g
b3BlbmVkIGJyYW5jaCBhbmQgb3Blbi9jbG9zZSBpcyBhbGxvd2VkLi4uCisgICAgICAgICAgICAg
IGlmICgobm9kZS50eXBlID09CisgICAgICAgICAgICAgICAgICAgcXgudWkudHJlZXZpcnR1YWwu
U2ltcGxlVHJlZURhdGFNb2RlbC5UeXBlLkJSQU5DSCkgJiYKKyAgICAgICAgICAgICAgICAgICEg
bm9kZS5iSGlkZU9wZW5DbG9zZSAmJgorICAgICAgICAgICAgICAgICAgbm9kZS5iT3BlbmVkKQog
ICAgICAgICAgICAgICB7CisgICAgICAgICAgICAgICAgLy8gLi4uIHRoZW4gY2xvc2UgaXQKICAg
ICAgICAgICAgICAgICBkbS5zZXRTdGF0ZShub2RlLCB7IGJPcGVuZWQgOiAhIG5vZGUuYk9wZW5l
ZCB9KTsKICAgICAgICAgICAgICAgfQotCisgICAgICAgICAgICAgIGVsc2V7CisgICAgICAgICAg
ICAgICAgLy8gSWYgd2UncmUgbm90IGF0IHRoZSB0b3AtbGV2ZWwgYWxyZWFkeS4uLgorICAgICAg
ICAgICAgICAgIGlmIChub2RlLnBhcmVudE5vZGVJZCkKKyAgICAgICAgICAgICAgICB7CisgICAg
ICAgICAgICAgICAgICAvLyBGaW5kIG91dCB3aGF0IHJlbmRlcmVkIHJvdyBvdXIgcGFyZW50IG5v
ZGUgaXMgYXQKKyAgICAgICAgICAgICAgICAgIHZhciByb3dJbmRleCA9IGRtLmdldFJvd0Zyb21O
b2RlSWQobm9kZS5wYXJlbnROb2RlSWQpOworCisgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhl
IGZvY3VzIHRvIG91ciBwYXJlbnQKKyAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXNlZENl
bGwodHJlZUNvbCwgcm93SW5kZXgsIHRydWUpOworICAgICAgICAgICAgICAgIH0KKyAgICAgICAg
ICAgICAgfQogICAgICAgICAgICAgICBjb25zdW1lZCA9IHRydWU7Ci0gICAgICAgICAgICB9Ci0g
ICAgICAgICAgICBicmVhazsKLQotICAgICAgICAgIGNhc2UgIkxlZnQiOgotICAgICAgICAgICAg
Ly8gR2V0IHRoZSBkYXRhIG1vZGVsCi0gICAgICAgICAgICB2YXIgZG0gPSB0aGlzLmdldERhdGFN
b2RlbCgpOwotCi0gICAgICAgICAgICAvLyBHZXQgdGhlIGZvY3VzZWQgbm9kZQotICAgICAgICAg
ICAgdmFyIGZvY3VzZWRSb3cgPSB0aGlzLmdldEZvY3VzZWRSb3coKTsKLSAgICAgICAgICAgIHZh
ciB0cmVlQ29sID0gZG0uZ2V0VHJlZUNvbHVtbigpOwotICAgICAgICAgICAgdmFyIG5vZGUgPSBk
bS5nZXROb2RlKGZvY3VzZWRSb3cpOwotCi0gICAgICAgICAgICAvLyBJZiBpdCdzIGFuIG9wZW5l
ZCBicmFuY2ggYW5kIG9wZW4vY2xvc2UgaXMgYWxsb3dlZC4uLgotICAgICAgICAgICAgaWYgKChu
b2RlLnR5cGUgPT0KLSAgICAgICAgICAgICAgICAgcXgudWkudHJlZXZpcnR1YWwuU2ltcGxlVHJl
ZURhdGFNb2RlbC5UeXBlLkJSQU5DSCkgJiYKLSAgICAgICAgICAgICAgICAhIG5vZGUuYkhpZGVP
cGVuQ2xvc2UgJiYKLSAgICAgICAgICAgICAgICBub2RlLmJPcGVuZWQpCi0gICAgICAgICAgICB7
Ci0gICAgICAgICAgICAgIC8vIC4uLiB0aGVuIGNsb3NlIGl0Ci0gICAgICAgICAgICAgIGRtLnNl
dFN0YXRlKG5vZGUsIHsgYk9wZW5lZCA6ICEgbm9kZS5iT3BlbmVkIH0pOwotICAgICAgICAgICAg
fQotICAgICAgICAgICAgZWxzZXsKLSAgICAgICAgICAgICAgLy8gSWYgd2UncmUgbm90IGF0IHRo
ZSB0b3AtbGV2ZWwgYWxyZWFkeS4uLgotICAgICAgICAgICAgICBpZiAobm9kZS5wYXJlbnROb2Rl
SWQpCi0gICAgICAgICAgICAgIHsKLSAgICAgICAgICAgICAgICAvLyBGaW5kIG91dCB3aGF0IHJl
bmRlcmVkIHJvdyBvdXIgcGFyZW50IG5vZGUgaXMgYXQKLSAgICAgICAgICAgICAgICB2YXIgcm93
SW5kZXggPSBkbS5nZXRSb3dGcm9tTm9kZUlkKG5vZGUucGFyZW50Tm9kZUlkKTsKKyAgICAgICAg
ICAgICAgYnJlYWs7CiAKLSAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIGZvY3VzIHRvIG91ciBw
YXJlbnQKLSAgICAgICAgICAgICAgICB0aGlzLnNldEZvY3VzZWRDZWxsKHRyZWVDb2wsIHJvd0lu
ZGV4LCB0cnVlKTsKLSAgICAgICAgICAgICAgfQotICAgICAgICAgICAgfQotICAgICAgICAgICAg
Y29uc3VtZWQgPSB0cnVlOwotICAgICAgICAgICAgYnJlYWs7Ci0KLSAgICAgICAgICBjYXNlICJS
aWdodCI6Ci0gICAgICAgICAgICAvLyBHZXQgdGhlIGRhdGEgbW9kZWwKLSAgICAgICAgICAgIHZh
ciBkbSA9IHRoaXMuZ2V0RGF0YU1vZGVsKCk7Ci0KLSAgICAgICAgICAgIC8vIEdldCB0aGUgZm9j
dXNlZCBub2RlCi0gICAgICAgICAgICB2YXIgZm9jdXNlZFJvdyA9IHRoaXMuZ2V0Rm9jdXNlZFJv
dygpOwotICAgICAgICAgICAgdmFyIHRyZWVDb2wgPSBkbS5nZXRUcmVlQ29sdW1uKCk7Ci0gICAg
ICAgICAgICB2YXIgbm9kZSA9IGRtLmdldE5vZGUoZm9jdXNlZFJvdyk7Ci0KLSAgICAgICAgICAg
IC8vIElmIGl0J3MgYSBjbG9zZWQgYnJhbmNoIGFuZCBvcGVuL2Nsb3NlIGlzIGFsbG93ZWQuLi4K
LSAgICAgICAgICAgIGlmICgobm9kZS50eXBlID09Ci0gICAgICAgICAgICAgICAgIHF4LnVpLnRy
ZWV2aXJ0dWFsLlNpbXBsZVRyZWVEYXRhTW9kZWwuVHlwZS5CUkFOQ0gpICYmCi0gICAgICAgICAg
ICAgICAgISBub2RlLmJIaWRlT3BlbkNsb3NlICYmCi0gICAgICAgICAgICAgICAgISBub2RlLmJP
cGVuZWQpCi0gICAgICAgICAgICB7Ci0gICAgICAgICAgICAgIC8vIC4uLiB0aGVuIG9wZW4gaXQK
LSAgICAgICAgICAgICAgZG0uc2V0U3RhdGUobm9kZSwgeyBiT3BlbmVkIDogISBub2RlLmJPcGVu
ZWQgfSk7Ci0gICAgICAgICAgICB9Ci0gICAgICAgICAgICBlbHNlewotICAgICAgICAgICAgICAv
LyBJZiB0aGlzIG5vZGUgaGFzIGNoaWxkcmVuLi4uCi0gICAgICAgICAgICAgIGlmIChub2RlLmNo
aWxkcmVuLmxlbmd0aCA+IDApCisgICAgICAgICAgICBjYXNlICJSaWdodCI6CisgICAgICAgICAg
ICAgIC8vIEdldCB0aGUgZGF0YSBtb2RlbAorICAgICAgICAgICAgICB2YXIgZG0gPSB0aGlzLmdl
dERhdGFNb2RlbCgpOworCisgICAgICAgICAgICAgIC8vIEdldCB0aGUgZm9jdXNlZCBub2RlCisg
ICAgICAgICAgICAgIHZhciBmb2N1c2VkUm93ID0gdGhpcy5nZXRGb2N1c2VkUm93KCk7CisgICAg
ICAgICAgICAgIHZhciB0cmVlQ29sID0gZG0uZ2V0VHJlZUNvbHVtbigpOworICAgICAgICAgICAg
ICB2YXIgbm9kZSA9IGRtLmdldE5vZGUoZm9jdXNlZFJvdyk7CisKKyAgICAgICAgICAgICAgLy8g
SWYgaXQncyBhIGNsb3NlZCBicmFuY2ggYW5kIG9wZW4vY2xvc2UgaXMgYWxsb3dlZC4uLgorICAg
ICAgICAgICAgICBpZiAoKG5vZGUudHlwZSA9PQorICAgICAgICAgICAgICAgICAgIHF4LnVpLnRy
ZWV2aXJ0dWFsLlNpbXBsZVRyZWVEYXRhTW9kZWwuVHlwZS5CUkFOQ0gpICYmCisgICAgICAgICAg
ICAgICAgICAhIG5vZGUuYkhpZGVPcGVuQ2xvc2UgJiYKKyAgICAgICAgICAgICAgICAgICEgbm9k
ZS5iT3BlbmVkKQogICAgICAgICAgICAgICB7Ci0gICAgICAgICAgICAgICAgLy8gLi4uIHRoZW4g
bW92ZSB0aGUgZm9jdXMgdG8gdGhlIGZpcnN0IGNoaWxkCi0gICAgICAgICAgICAgICAgdGhpcy5t
b3ZlRm9jdXNlZENlbGwoMCwgMSk7CisgICAgICAgICAgICAgICAgLy8gLi4uIHRoZW4gb3BlbiBp
dAorICAgICAgICAgICAgICAgIGRtLnNldFN0YXRlKG5vZGUsIHsgYk9wZW5lZCA6ICEgbm9kZS5i
T3BlbmVkIH0pOworICAgICAgICAgICAgICB9CisgICAgICAgICAgICAgIGVsc2V7CisgICAgICAg
ICAgICAgICAgLy8gSWYgdGhpcyBub2RlIGhhcyBjaGlsZHJlbi4uLgorICAgICAgICAgICAgICAg
IGlmIChub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDApCisgICAgICAgICAgICAgICAgeworICAgICAg
ICAgICAgICAgICAgLy8gLi4uIHRoZW4gbW92ZSB0aGUgZm9jdXMgdG8gdGhlIGZpcnN0IGNoaWxk
CisgICAgICAgICAgICAgICAgICB0aGlzLm1vdmVGb2N1c2VkQ2VsbCgwLCAxKTsKKyAgICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgIH0KIAotICAgICAgICAgICAg
Y29uc3VtZWQgPSB0cnVlOwotICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgICAgIGNvbnN1
bWVkID0gdHJ1ZTsKKyAgICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgfQogICAgICAgICB9
CiAgICAgICB9Ci0KICAgICAgIC8vIFdhcyB0aGlzIG9uZSBvZiBvdXIgZXZlbnRzIHRoYXQgd2Ug
aGFuZGxlZD8KICAgICAgIGlmIChjb25zdW1lZCkKICAgICAgIHsKLS0gCjEuNy4zLjEubXN5c2dp
dC4wCgo=
</data>

          </attachment>
      

    </bug>